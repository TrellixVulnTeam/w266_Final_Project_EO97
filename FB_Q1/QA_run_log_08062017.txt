**************************************

qa1_single-supporting-fact
vocab = [u'.', u'?', u'Daniel', u'John', u'Mary', u'Sandra', u'Where', u'back', u'bathroom', u'bedroom', u'garden', u'hallway', u'is', u'journeyed', u'kitchen', u'moved', u'office', u'the', u'to', u'travelled', u'went']
word_idx = {u'hallway': 12, u'bathroom': 9, u'garden': 11, u'journeyed': 14, u'office': 17, u'is': 13, u'bedroom': 10, u'moved': 16, u'back': 8, u'went': 21, u'.': 1, u'to': 19, u'travelled': 20, u'Daniel': 3, u'Sandra': 6, u'the': 18, u'John': 4, u'Where': 7, u'Mary': 5, u'?': 2, u'kitchen': 15}
X.shape = (1000, 10, 7)
Xq.shape = (1000, 4)
Y.shape = (1000, 22)
story_maxlen, sentence_maxlen, query_maxlen = 10, 7, 4
max_epochs = 100
Epoch 0
Training loss: 18.658601760939
Training acc: 0.1328125
Validation acc: 0.166666666667
Testing acc: 0.157258064516
Epoch 1
Training loss: 6.8208985328787
Training acc: 0.145089285714
Validation acc: 0.15625
Epoch 2
Training loss: 5.7708292007422
Training acc: 0.161830357143
Validation acc: 0.145833333333
Epoch 3
20 / 28 : loss = 4.51203298569Training loss: 4.47556018829
Training acc: 0.170758928571
Validation acc: 0.21875
Epoch 4
20 / 28 : loss = 4.20792150497Training loss: 4.16593694687
Training acc: 0.168526785714
Validation acc: 0.166666666667
Epoch 5
Training loss: 3.9440121650733
Training acc: 0.167410714286
Validation acc: 0.125
Epoch 6
20 / 28 : loss = 3.57189822197Training loss: 3.54388451576
Training acc: 0.181919642857
Validation acc: 0.197916666667
Epoch 7
20 / 28 : loss = 3.36502623558Training loss: 3.58903622627
Training acc: 0.139508928571
Validation acc: 0.15625
Epoch 8
20 / 28 : loss = 3.35027503967Training loss: 3.37075352669
Training acc: 0.142857142857
Validation acc: 0.125
Epoch 9
Training loss: 3.2928550243475
Training acc: 0.159598214286
Validation acc: 0.208333333333
Epoch 10
Training loss: 3.1291100978919
Training acc: 0.141741071429
Validation acc: 0.145833333333
Epoch 11
20 / 28 : loss = 2.96732902527Training loss: 2.97199511528
Training acc: 0.150669642857
Validation acc: 0.145833333333
Epoch 12
20 / 28 : loss = 2.89590501785Training loss: 2.88835716248
Training acc: 0.178571428571
Validation acc: 0.09375
Epoch 13
Training loss: 2.6716563701668
Training acc: 0.169642857143
Validation acc: 0.177083333333
Epoch 14
Training loss: 2.8388602733614
Training acc: 0.158482142857
Validation acc: 0.197916666667
Epoch 15
Training loss: 2.6337261213228
Training acc: 0.177455357143
Validation acc: 0.197916666667
Epoch 16
20 / 28 : loss = 2.46316528324Training loss: 2.51386523247
Training acc: 0.199776785714
Validation acc: 0.177083333333
Epoch 17
Training loss: 2.5216524601903
Training acc: 0.175223214286
Validation acc: 0.15625
Epoch 18
20 / 28 : loss = 2.58921957016Training loss: 2.55601143837
Training acc: 0.176339285714
Validation acc: 0.1875
Epoch 19
20 / 28 : loss = 2.49535942078Training loss: 2.48775529861
Training acc: 0.167410714286
Validation acc: 0.135416666667
Epoch 20
20 / 28 : loss = 2.45165252686Training loss: 2.48377156258
Training acc: 0.160714285714
Validation acc: 0.135416666667
Testing acc: 0.154233870968
Epoch 21
Training loss: 2.4413249492633
Training acc: 0.169642857143
Validation acc: 0.197916666667
Epoch 22
20 / 28 : loss = 2.45991563797Training loss: 2.42672610283
Training acc: 0.169642857143
Validation acc: 0.1875
Epoch 23
20 / 28 : loss = 2.36188578606Training loss: 2.32960438728
Training acc: 0.181919642857
Validation acc: 0.229166666667
Epoch 24
Training loss: 2.4129524231329
Training acc: 0.150669642857
Validation acc: 0.145833333333
Epoch 25
20 / 28 : loss = 2.27314448357Training loss: 2.30872583389
Training acc: 0.176339285714
Validation acc: 0.135416666667
Epoch 26
20 / 28 : loss = 2.26695966721Training loss: 2.28459477425
Training acc: 0.193080357143
Validation acc: 0.15625
Epoch 27
Training loss: 2.3378338813858
Training acc: 0.161830357143
Validation acc: 0.125
Epoch 28
20 / 28 : loss = 2.30653762817Training loss: 2.28788805008
Training acc: 0.185267857143
Validation acc: 0.21875
Epoch 29
20 / 28 : loss = 2.27146768578Training loss: 2.27652406693
Training acc: 0.180803571429
Validation acc: 0.145833333333
Epoch 30
Training loss: 2.4398643970572
Training acc: 0.1640625
Validation acc: 0.1875
Epoch 31
20 / 28 : loss = 2.27276992798Training loss: 2.29725718498
Training acc: 0.152901785714
Validation acc: 0.3125
Epoch 32
Training loss: 2.3127968311344
Training acc: 0.204241071429
Validation acc: 0.270833333333
Epoch 33
Training loss: 2.2313470840538
Training acc: 0.186383928571
Validation acc: 0.104166666667
Epoch 34
20 / 28 : loss = 2.43346977234Training loss: 2.44135093689
Training acc: 0.174107142857
Validation acc: 0.135416666667
Epoch 35
20 / 28 : loss = 2.1771235466Training loss: 2.17111897469
Training acc: 0.229910714286
Validation acc: 0.270833333333
Epoch 36
20 / 28 : loss = 2.16168403625Training loss: 2.17916703224
Training acc: 0.235491071429
Validation acc: 0.291666666667
Epoch 37
Training loss: 2.2292368412124
Training acc: 0.21875
Validation acc: 0.208333333333
Epoch 38
20 / 28 : loss = 2.19060635567Training loss: 2.13942575455
Training acc: 0.263392857143
Validation acc: 0.208333333333
Epoch 39
Training loss: 2.1287651062468
Training acc: 0.248883928571
Validation acc: 0.28125
Epoch 40
Training loss: 2.0425066947937
Training acc: 0.275669642857
Validation acc: 0.270833333333
Testing acc: 0.258064516129
Epoch 41
Training loss: 2.0766546726209
Training acc: 0.286830357143
Validation acc: 0.15625
Epoch 42
Training loss: 2.0590670108891
Training acc: 0.268973214286
Validation acc: 0.322916666667
Epoch 43
Training loss: 2.0420043468525
Training acc: 0.282366071429
Validation acc: 0.25
Epoch 44
20 / 28 : loss = 1.92971456051Training loss: 1.96138000488
Training acc: 0.319196428571
Validation acc: 0.364583333333
Epoch 45
20 / 28 : loss = 1.98699128628Training loss: 1.93146824837
Training acc: 0.377232142857
Validation acc: 0.354166666667
Epoch 46
20 / 28 : loss = 2.01192831993Training loss: 1.97449576855
Training acc: 0.371651785714
Validation acc: 0.479166666667
Epoch 47
Training loss: 1.7925549745665
Training acc: 0.434151785714
Validation acc: 0.458333333333
Epoch 48
Training loss: 1.8003556728485
Training acc: 0.456473214286
Validation acc: 0.395833333333
Epoch 49
Training loss: 1.7733383178723
Training acc: 0.459821428571
Validation acc: 0.552083333333
Epoch 50
20 / 28 : loss = 1.73400020599Training loss: 1.72547519207
Training acc: 0.4765625
Validation acc: 0.59375
Epoch 51
20 / 28 : loss = 1.67287302017Training loss: 1.64883458614
Training acc: 0.501116071429
Validation acc: 0.489583333333
Epoch 52
20 / 28 : loss = 1.67224371433Training loss: 1.65985691547
Training acc: 0.494419642857
Validation acc: 0.510416666667
Epoch 53
Training loss: 1.6399859190467
Training acc: 0.502232142857
Validation acc: 0.5625
Epoch 54
20 / 28 : loss = 1.57924199104Training loss: 1.57758581638
Training acc: 0.514508928571
Validation acc: 0.53125
Epoch 55
Training loss: 1.5439924001746
Training acc: 0.505580357143
Validation acc: 0.53125
Epoch 56
Training loss: 1.4577977657369
Training acc: 0.545758928571
Validation acc: 0.479166666667
Epoch 57
20 / 28 : loss = 1.42119526863Training loss: 1.42853188515
Training acc: 0.541294642857
Validation acc: 0.5
Epoch 58
20 / 28 : loss = 1.53302133083Training loss: 1.52530372143
Training acc: 0.5234375
Validation acc: 0.541666666667
Epoch 59
20 / 28 : loss = 1.44560933113Training loss: 1.41366791725
Training acc: 0.533482142857
Validation acc: 0.5625
Epoch 60
20 / 28 : loss = 1.39741647243Training loss: 1.41564619541
Training acc: 0.552455357143
Validation acc: 0.479166666667
Testing acc: 0.472782258065
Epoch 61
Training loss: 1.3918906450314
Training acc: 0.535714285714
Validation acc: 0.46875
Epoch 62
20 / 28 : loss = 1.42907500267Training loss: 1.43243205547
Training acc: 0.544642857143
Validation acc: 0.520833333333
Epoch 63
20 / 28 : loss = 1.37573623657Training loss: 1.39734017849
Training acc: 0.551339285714
Validation acc: 0.520833333333
Epoch 64
Training loss: 1.3331176042641
Training acc: 0.542410714286
Validation acc: 0.5
Epoch 65
Training loss: 1.3647687435225
Training acc: 0.559151785714
Validation acc: 0.583333333333
Epoch 66
20 / 28 : loss = 1.37550425529Training loss: 1.34241604805
Training acc: 0.589285714286
Validation acc: 0.53125
Epoch 67
20 / 28 : loss = 1.29437279701Training loss: 1.28589689732
Training acc: 0.608258928571
Validation acc: 0.5625
Epoch 68
20 / 28 : loss = 1.35865867138Training loss: 1.34236681461
Training acc: 0.581473214286
Validation acc: 0.5625
Epoch 69
20 / 28 : loss = 1.28585684299Training loss: 1.31256043911
Training acc: 0.574776785714
Validation acc: 0.53125
Epoch 70
20 / 28 : loss = 1.35575330257Training loss: 1.34353351593
Training acc: 0.564732142857
Validation acc: 0.572916666667
Epoch 71
20 / 28 : loss = 1.26283431053Training loss: 1.28925061226
Training acc: 0.575892857143
Validation acc: 0.520833333333
Epoch 72
20 / 28 : loss = 1.26617205143Training loss: 1.31491672993
Training acc: 0.590401785714
Validation acc: 0.572916666667
Epoch 73
20 / 28 : loss = 1.28435194492Training loss: 1.31159043312
Training acc: 0.574776785714
Validation acc: 0.53125
Epoch 74
20 / 28 : loss = 1.26188492775Training loss: 1.28143179417
Training acc: 0.5859375
Validation acc: 0.635416666667
Epoch 75
20 / 28 : loss = 1.27804315095Training loss: 1.27798199654
Training acc: 0.584821428571
Validation acc: 0.614583333333
Epoch 76
20 / 28 : loss = 1.25476169586Training loss: 1.28300368786
Training acc: 0.577008928571
Validation acc: 0.552083333333
Epoch 77
Training loss: 1.2609161138528
Training acc: 0.611607142857
Validation acc: 0.572916666667
Epoch 78
20 / 28 : loss = 1.24121415615Training loss: 1.28074169159
Training acc: 0.582589285714
Validation acc: 0.614583333333
Epoch 79
20 / 28 : loss = 1.30163884163Training loss: 1.30718827248
Training acc: 0.588169642857
Validation acc: 0.645833333333
Epoch 80
20 / 28 : loss = 1.20712184906Training loss: 1.23405301571
Training acc: 0.614955357143
Validation acc: 0.635416666667
Testing acc: 0.469758064516
Epoch 81
Training loss: 1.2551651001572
Training acc: 0.588169642857
Validation acc: 0.520833333333
Epoch 82
20 / 28 : loss = 1.18106985092Training loss: 1.2101752758
Training acc: 0.616071428571
Validation acc: 0.635416666667
Epoch 83
20 / 28 : loss = 1.26778817177Training loss: 1.25311112404
Training acc: 0.589285714286
Validation acc: 0.552083333333
Epoch 84
20 / 28 : loss = 1.25030183792Training loss: 1.28270745277
Training acc: 0.595982142857
Validation acc: 0.604166666667
Epoch 85
Training loss: 1.2277492284847
Training acc: 0.606026785714
Validation acc: 0.614583333333
Epoch 86
20 / 28 : loss = 1.22705245018Training loss: 1.209664464
Training acc: 0.629464285714
Validation acc: 0.510416666667
Epoch 87
20 / 28 : loss = 1.29481077194Training loss: 1.26750576496
Training acc: 0.600446428571
Validation acc: 0.65625
Epoch 88
20 / 28 : loss = 1.24737453461Training loss: 1.23331713676
Training acc: 0.604910714286
Validation acc: 0.572916666667
Epoch 89
20 / 28 : loss = 1.21437954903Training loss: 1.22793960571
Training acc: 0.606026785714
Validation acc: 0.65625
Epoch 90
20 / 28 : loss = 1.20424628258Training loss: 1.18022501469
Training acc: 0.643973214286
Validation acc: 0.614583333333
Epoch 91
20 / 28 : loss = 1.24409615993Training loss: 1.22785389423
Training acc: 0.635044642857
Validation acc: 0.5625
Epoch 92
20 / 28 : loss = 1.18333339691Training loss: 1.21556890011
Training acc: 0.609375
Validation acc: 0.6875
Epoch 93
20 / 28 : loss = 1.15015661716Training loss: 1.21521472931
Training acc: 0.636160714286
Validation acc: 0.65625
Epoch 94
20 / 28 : loss = 1.17570972443Training loss: 1.17680716515
Training acc: 0.622767857143
Validation acc: 0.635416666667
Epoch 95
20 / 28 : loss = 1.21188235283Training loss: 1.22687995434
Training acc: 0.642857142857
Validation acc: 0.583333333333
Epoch 96
Training loss: 1.1681488752499
Training acc: 0.640625
Validation acc: 0.677083333333
Epoch 97
20 / 28 : loss = 1.19234514236Training loss: 1.19626235962
Training acc: 0.6171875
Validation acc: 0.677083333333
Epoch 98
20 / 28 : loss = 1.22670686245Training loss: 1.21767926216
Training acc: 0.620535714286
Validation acc: 0.677083333333
Epoch 99
20 / 28 : loss = 1.14140260221Training loss: 1.13421106339
Training acc: 0.654017857143
Validation acc: 0.53125

**************************************

qa2_two-supporting-facts
vocab = [u'.', u'?', u'Daniel', u'John', u'Mary', u'Sandra', u'Where', u'apple', u'back', u'bathroom', u'bedroom', u'discarded', u'down', u'dropped', u'football', u'garden', u'got', u'grabbed', u'hallway', u'is', u'journeyed', u'kitchen', u'left', u'milk', u'moved', u'office', u'picked', u'put', u'the', u'there', u'to', u'took', u'travelled', u'up', u'went']
word_idx = {u'apple': 8, u'office': 26, u'is': 20, u'moved': 25, u'back': 9, u'down': 13, u'Daniel': 3, u'dropped': 14, u'picked': 27, u'bedroom': 11, u'John': 4, u'Mary': 5, u'bathroom': 10, u'grabbed': 18, u'there': 30, u'milk': 24, u'.': 1, u'to': 31, u'Sandra': 6, u'got': 17, u'travelled': 33, u'?': 2, u'hallway': 19, u'garden': 16, u'football': 15, u'took': 32, u'put': 28, u'Where': 7, u'went': 35, u'kitchen': 22, u'journeyed': 21, u'up': 34, u'discarded': 12, u'the': 29, u'left': 23}
X.shape = (1000, 88, 7)
Xq.shape = (1000, 5)
Y.shape = (1000, 36)
story_maxlen, sentence_maxlen, query_maxlen = 88, 7, 5
max_epochs = 100
Epoch 0
20 / 28 : loss = 34.5079765326Training loss: 26.9593410492
Training acc: 0.15625
Validation acc: 0.208333333333
Testing acc: 0.145161290323
Epoch 1
20 / 28 : loss = 4.15254020691Training loss: 4.11586475372
Training acc: 0.162946428571
Validation acc: 0.229166666667
Epoch 2
20 / 28 : loss = 3.91461467743Training loss: 3.87537455559
Training acc: 0.186383928571
Validation acc: 0.15625
Epoch 3
20 / 28 : loss = 3.74364590645Training loss: 3.70315384865
Training acc: 0.184151785714
Validation acc: 0.104166666667
Epoch 4
20 / 28 : loss = 3.60536837578Training loss: 3.60287427902
Training acc: 0.174107142857
Validation acc: 0.15625
Epoch 5
20 / 28 : loss = 3.47677111626Training loss: 3.47457957268
Training acc: 0.193080357143
Validation acc: 0.166666666667
Epoch 6
20 / 28 : loss = 3.41664600372Training loss: 3.40070319176
Training acc: 0.158482142857
Validation acc: 0.21875
Epoch 7
20 / 28 : loss = 3.32055783272Training loss: 3.30813336372
Training acc: 0.186383928571
Validation acc: 0.260416666667
Epoch 8
20 / 28 : loss = 3.20667266846Training loss: 3.18235397339
Training acc: 0.1953125
Validation acc: 0.114583333333
Epoch 9
20 / 28 : loss = 3.14798378944Training loss: 3.13586449623
Training acc: 0.186383928571
Validation acc: 0.0833333333333
Epoch 10
20 / 28 : loss = 3.07226777077Training loss: 3.0604660511
Training acc: 0.162946428571
Validation acc: 0.1875
Epoch 11
20 / 28 : loss = 2.99341702461Training loss: 2.99302339554
Training acc: 0.188616071429
Validation acc: 0.197916666667
Epoch 12
20 / 28 : loss = 2.93267321587Training loss: 2.9286980629
Training acc: 0.212053571429
Validation acc: 0.114583333333
Epoch 13
20 / 28 : loss = 2.90401721001Training loss: 2.89119505882
Training acc: 0.203125
Validation acc: 0.208333333333
Epoch 14
20 / 28 : loss = 2.81184864044Training loss: 2.80756211281
Training acc: 0.202008928571
Validation acc: 0.260416666667
Epoch 15
20 / 28 : loss = 2.78662800789Training loss: 2.77785563469
Training acc: 0.190848214286
Validation acc: 0.239583333333
Epoch 16
20 / 28 : loss = 2.73234844208Training loss: 2.73568344116
Training acc: 0.202008928571
Validation acc: 0.291666666667
Epoch 17
20 / 28 : loss = 2.68011808395Training loss: 2.67925310135
Training acc: 0.186383928571
Validation acc: 0.09375
Epoch 18
20 / 28 : loss = 2.65526080132Training loss: 2.65626716614
Training acc: 0.194196428571
Validation acc: 0.09375
Epoch 19
20 / 28 : loss = 2.62051892281Training loss: 2.61151099205
Training acc: 0.209821428571
Validation acc: 0.34375
Epoch 20
20 / 28 : loss = 2.59392809868Training loss: 2.58708405495
Training acc: 0.215401785714
Validation acc: 0.125
Testing acc: 0.158266129032
Epoch 21
20 / 28 : loss = 2.56429409981Training loss: 2.56104922295
Training acc: 0.188616071429
Validation acc: 0.239583333333
Epoch 22
20 / 28 : loss = 2.54316544533Training loss: 2.53563189507
Training acc: 0.178571428571
Validation acc: 0.1875
Epoch 23
20 / 28 : loss = 2.51857948303Training loss: 2.5013692379
Training acc: 0.197544642857
Validation acc: 0.166666666667
Epoch 24
20 / 28 : loss = 2.48263430595Training loss: 2.4851872921
Training acc: 0.184151785714
Validation acc: 0.1875
Epoch 25
20 / 28 : loss = 2.45873641968Training loss: 2.45243477821
Training acc: 0.197544642857
Validation acc: 0.145833333333
Epoch 26
20 / 28 : loss = 2.43386125565Training loss: 2.4267821312
Training acc: 0.188616071429
Validation acc: 0.125
Epoch 27
20 / 28 : loss = 2.42372775078Training loss: 2.42284274101
Training acc: 0.1875
Validation acc: 0.229166666667
Epoch 28
20 / 28 : loss = 2.37162566185Training loss: 2.38448166847
Training acc: 0.197544642857
Validation acc: 0.145833333333
Epoch 29
20 / 28 : loss = 2.36928939819Training loss: 2.37049913406
Training acc: 0.190848214286
Validation acc: 0.21875
Epoch 30
20 / 28 : loss = 2.35969471931Training loss: 2.35191297531
Training acc: 0.175223214286
Validation acc: 0.229166666667
Epoch 31
20 / 28 : loss = 2.32722854614Training loss: 2.33296227455
Training acc: 0.193080357143
Validation acc: 0.166666666667
Epoch 32
20 / 28 : loss = 2.32745361328Training loss: 2.32449269295
Training acc: 0.188616071429
Validation acc: 0.21875
Epoch 33
20 / 28 : loss = 2.31355881691Training loss: 2.31141853333
Training acc: 0.1875
Validation acc: 0.21875
Epoch 34
20 / 28 : loss = 2.27849960327Training loss: 2.26848244667
Training acc: 0.209821428571
Validation acc: 0.197916666667
Epoch 35
20 / 28 : loss = 2.28240394592Training loss: 2.27261757851
Training acc: 0.223214285714
Validation acc: 0.333333333333
Epoch 36
20 / 28 : loss = 2.28004980087Training loss: 2.27187252045
Training acc: 0.194196428571
Validation acc: 0.1875
Epoch 37
20 / 28 : loss = 2.26273703575Training loss: 2.25589346886
Training acc: 0.199776785714
Validation acc: 0.1875
Epoch 38
20 / 28 : loss = 2.21921205521Training loss: 2.22294807434
Training acc: 0.225446428571
Validation acc: 0.21875
Epoch 39
20 / 28 : loss = 2.23168683052Training loss: 2.23340654373
Training acc: 0.217633928571
Validation acc: 0.125
Epoch 40
20 / 28 : loss = 2.21904301643Training loss: 2.21427440643
Training acc: 0.189732142857
Validation acc: 0.177083333333
Testing acc: 0.197580645161
Epoch 41
20 / 28 : loss = 2.2067322731Training loss: 2.18846940994
Training acc: 0.191964285714
Validation acc: 0.28125
Epoch 42
20 / 28 : loss = 2.21056199074Training loss: 2.19685411453
Training acc: 0.228794642857
Validation acc: 0.197916666667
Epoch 43
20 / 28 : loss = 2.18865656853Training loss: 2.18897604942
Training acc: 0.217633928571
Validation acc: 0.447916666667
Epoch 44
20 / 28 : loss = 2.16782736778Training loss: 2.16921782494
Training acc: 0.199776785714
Validation acc: 0.270833333333
Epoch 45
20 / 28 : loss = 2.15031409264Training loss: 2.15823769569
Training acc: 0.1875
Validation acc: 0.260416666667
Epoch 46
20 / 28 : loss = 2.15459227562Training loss: 2.15862584114
Training acc: 0.206473214286
Validation acc: 0.270833333333
Epoch 47
20 / 28 : loss = 2.12962293625Training loss: 2.13373446465
Training acc: 0.228794642857
Validation acc: 0.208333333333
Epoch 48
20 / 28 : loss = 2.13509106636Training loss: 2.13246846199
Training acc: 0.206473214286
Validation acc: 0.114583333333
Epoch 49
20 / 28 : loss = 2.11633181572Training loss: 2.12598657608
Training acc: 0.248883928571
Validation acc: 0.239583333333
Epoch 50
20 / 28 : loss = 2.13396787643Training loss: 2.12951159477
Training acc: 0.200892857143
Validation acc: 0.239583333333
Epoch 51
20 / 28 : loss = 2.13186168671Training loss: 2.13143229485
Training acc: 0.207589285714
Validation acc: 0.21875
Epoch 52
20 / 28 : loss = 2.09688591957Training loss: 2.11318850517
Training acc: 0.217633928571
Validation acc: 0.15625
Epoch 53
20 / 28 : loss = 2.09619188309Training loss: 2.10279965401
Training acc: 0.224330357143
Validation acc: 0.25
Epoch 54
20 / 28 : loss = 2.07383728027Training loss: 2.0843963623
Training acc: 0.25
Validation acc: 0.197916666667
Epoch 55
20 / 28 : loss = 2.09553027153Training loss: 2.08273243904
Training acc: 0.246651785714
Validation acc: 0.166666666667
Epoch 56
20 / 28 : loss = 2.11383247375Training loss: 2.09763503075
Training acc: 0.233258928571
Validation acc: 0.291666666667
Epoch 57
20 / 28 : loss = 2.06996488571Training loss: 2.08756828308
Training acc: 0.213169642857
Validation acc: 0.208333333333
Epoch 58
20 / 28 : loss = 2.04935860634Training loss: 2.06605291367
Training acc: 0.235491071429
Validation acc: 0.208333333333
Epoch 59
20 / 28 : loss = 2.06562995911Training loss: 2.06295442581
Training acc: 0.214285714286
Validation acc: 0.34375
Epoch 60
20 / 28 : loss = 2.05322003365Training loss: 2.05627346039
Training acc: 0.220982142857
Validation acc: 0.25
Testing acc: 0.21875
Epoch 61
20 / 28 : loss = 2.02561068535Training loss: 2.0342810154
Training acc: 0.241071428571
Validation acc: 0.239583333333
Epoch 62
20 / 28 : loss = 2.06925296783Training loss: 2.07127928734
Training acc: 0.191964285714
Validation acc: 0.260416666667
Epoch 63
20 / 28 : loss = 2.04140448579Training loss: 2.04565119743
Training acc: 0.2265625
Validation acc: 0.25
Epoch 64
20 / 28 : loss = 2.03953051567Training loss: 2.04618787766
Training acc: 0.245535714286
Validation acc: 0.25
Epoch 65
20 / 28 : loss = 2.03520321846Training loss: 2.04851865768
Training acc: 0.21875
Validation acc: 0.25
Epoch 66
20 / 28 : loss = 2.02316284185Training loss: 2.0165309906
Training acc: 0.253348214286
Validation acc: 0.208333333333
Epoch 67
20 / 28 : loss = 2.04369592667Training loss: 2.04184150696
Training acc: 0.231026785714
Validation acc: 0.229166666667
Epoch 68
20 / 28 : loss = 2.04422712326Training loss: 2.03482365608
Training acc: 0.212053571429
Validation acc: 0.197916666667
Epoch 69
20 / 28 : loss = 2.04935193062Training loss: 2.03411531448
Training acc: 0.222098214286
Validation acc: 0.291666666667
Epoch 70
20 / 28 : loss = 1.99115753174Training loss: 2.00993084908
Training acc: 0.248883928571
Validation acc: 0.28125
Epoch 71
20 / 28 : loss = 1.99793481827Training loss: 2.01370453835
Training acc: 0.229910714286
Validation acc: 0.333333333333
Epoch 72
20 / 28 : loss = 1.99807631969Training loss: 2.00445699692
Training acc: 0.2265625
Validation acc: 0.208333333333
Epoch 73
20 / 28 : loss = 2.02156805992Training loss: 2.00338244438
Training acc: 0.234375
Validation acc: 0.25
Epoch 74
20 / 28 : loss = 1.99961113937Training loss: 1.99448573589
Training acc: 0.234375
Validation acc: 0.25
Epoch 75
20 / 28 : loss = 2.01923203468Training loss: 1.99746978283
Training acc: 0.233258928571
Validation acc: 0.270833333333
Epoch 76
20 / 28 : loss = 2.01980161667Training loss: 2.0203306675
Training acc: 0.217633928571
Validation acc: 0.302083333333
Epoch 77
20 / 28 : loss = 1.99135756493Training loss: 1.99601435661
Training acc: 0.219866071429
Validation acc: 0.208333333333
Epoch 78
20 / 28 : loss = 1.94768393044Training loss: 1.9569965601
Training acc: 0.276785714286
Validation acc: 0.166666666667
Epoch 79
20 / 28 : loss = 1.98381447792Training loss: 1.97563481331
Training acc: 0.245535714286
Validation acc: 0.270833333333
Epoch 80
20 / 28 : loss = 1.99264872074Training loss: 1.98151493073
Training acc: 0.224330357143
Validation acc: 0.260416666667
Testing acc: 0.204637096774
Epoch 81
20 / 28 : loss = 1.98481023312Training loss: 1.97280490398
Training acc: 0.244419642857
Validation acc: 0.291666666667
Epoch 82
20 / 28 : loss = 1.95996582508Training loss: 1.96444606781
Training acc: 0.244419642857
Validation acc: 0.260416666667
Epoch 83
20 / 28 : loss = 1.97438323498Training loss: 1.97526359558
Training acc: 0.234375
Validation acc: 0.197916666667
Epoch 84
20 / 28 : loss = 1.94562637806Training loss: 1.95711505413
Training acc: 0.233258928571
Validation acc: 0.208333333333
Epoch 85
20 / 28 : loss = 1.93865644932Training loss: 1.95569169521
Training acc: 0.235491071429
Validation acc: 0.145833333333
Epoch 86
20 / 28 : loss = 1.98025727272Training loss: 1.9825950861
Training acc: 0.214285714286
Validation acc: 0.3125
Epoch 87
20 / 28 : loss = 1.94104421139Training loss: 1.9474260807
Training acc: 0.248883928571
Validation acc: 0.270833333333
Epoch 88
20 / 28 : loss = 1.96320021152Training loss: 1.96150958538
Training acc: 0.252232142857
Validation acc: 0.270833333333
Epoch 89
20 / 28 : loss = 1.95621347427Training loss: 1.9544583559
Training acc: 0.241071428571
Validation acc: 0.395833333333
Epoch 90
20 / 28 : loss = 1.95570778847Training loss: 1.94960439205
Training acc: 0.238839285714
Validation acc: 0.229166666667
Epoch 91
20 / 28 : loss = 1.93273222446Training loss: 1.94817519188
Training acc: 0.251116071429
Validation acc: 0.09375
Epoch 92
20 / 28 : loss = 1.94199204445Training loss: 1.92461121082
Training acc: 0.2734375
Validation acc: 0.260416666667
Epoch 93
20 / 28 : loss = 1.96644794941Training loss: 1.94997441769
Training acc: 0.260044642857
Validation acc: 0.375
Epoch 94
20 / 28 : loss = 1.94290030003Training loss: 1.9277369976
Training acc: 0.25
Validation acc: 0.260416666667
Epoch 95
20 / 28 : loss = 1.91338765621Training loss: 1.91369187832
Training acc: 0.2421875
Validation acc: 0.197916666667
Epoch 96
20 / 28 : loss = 1.92079961338Training loss: 1.91051089764
Training acc: 0.282366071429
Validation acc: 0.15625
Epoch 97
20 / 28 : loss = 1.93980121613Training loss: 1.94219279289
Training acc: 0.254464285714
Validation acc: 0.322916666667
Epoch 98
20 / 28 : loss = 1.90231871605Training loss: 1.92006480694
Training acc: 0.258928571429
Validation acc: 0.229166666667
Epoch 99
20 / 28 : loss = 1.87384891514Training loss: 1.91251623631
Training acc: 0.293526785714
Validation acc: 0.208333333333

**************************************

qa3_three-supporting-facts
vocab = [u'.', u'?', u'Daniel', u'John', u'Mary', u'Sandra', u'Where', u'apple', u'back', u'bathroom', u'bedroom', u'before', u'discarded', u'down', u'dropped', u'football', u'garden', u'got', u'grabbed', u'hallway', u'journeyed', u'kitchen', u'left', u'milk', u'moved', u'office', u'picked', u'put', u'the', u'there', u'to', u'took', u'travelled', u'up', u'was', u'went']
word_idx = {u'apple': 8, u'office': 26, u'moved': 25, u'back': 9, u'down': 14, u'Daniel': 3, u'dropped': 15, u'picked': 27, u'bedroom': 11, u'John': 4, u'Mary': 5, u'before': 12, u'bathroom': 10, u'grabbed': 19, u'there': 30, u'milk': 24, u'.': 1, u'to': 31, u'Sandra': 6, u'got': 18, u'travelled': 33, u'was': 35, u'?': 2, u'hallway': 20, u'garden': 17, u'football': 16, u'took': 32, u'put': 28, u'Where': 7, u'went': 36, u'kitchen': 22, u'journeyed': 21, u'up': 34, u'discarded': 13, u'the': 29, u'left': 23}
X.shape = (1000, 228, 7)
Xq.shape = (1000, 8)
Y.shape = (1000, 37)
story_maxlen, sentence_maxlen, query_maxlen = 228, 7, 8
max_epochs = 100
Epoch 0
20 / 28 : loss = 161.568099976Training loss: 144.265014648
Training acc: 0.15625
Validation acc: 0.25
Testing acc: 0.184475806452
Epoch 1
20 / 28 : loss = 69.6634368896Training loss: 65.8006439209
Training acc: 0.140625
Validation acc: 0.15625
Epoch 2
20 / 28 : loss = 40.3857002258Training loss: 41.262096405
Training acc: 0.188616071429
Validation acc: 0.1875
Epoch 3
20 / 28 : loss = 43.0955047607Training loss: 40.5176582336
Training acc: 0.167410714286
Validation acc: 0.166666666667
Epoch 4
20 / 28 : loss = 37.7197341919Training loss: 37.0206298828
Training acc: 0.139508928571
Validation acc: 0.125
Epoch 5
20 / 28 : loss = 28.9580783844Training loss: 28.6910991669
Training acc: 0.159598214286
Validation acc: 0.21875
Epoch 6
20 / 28 : loss = 29.5825538635Training loss: 27.9297790527
Training acc: 0.160714285714
Validation acc: 0.125
Epoch 7
20 / 28 : loss = 25.0563697815Training loss: 25.4401950836
Training acc: 0.1640625
Validation acc: 0.1875
Epoch 8
20 / 28 : loss = 25.2168846131Training loss: 23.9700069427
Training acc: 0.151785714286
Validation acc: 0.260416666667
Epoch 9
20 / 28 : loss = 22.7672367096Training loss: 22.6717071533
Training acc: 0.172991071429
Validation acc: 0.25
Epoch 10
20 / 28 : loss = 21.3342666626Training loss: 22.3313159943
Training acc: 0.204241071429
Validation acc: 0.15625
Epoch 11
20 / 28 : loss = 18.5228328705Training loss: 19.786813736
Training acc: 0.169642857143
Validation acc: 0.104166666667
Epoch 12
20 / 28 : loss = 17.6715297699Training loss: 17.84790802
Training acc: 0.184151785714
Validation acc: 0.229166666667
Epoch 13
20 / 28 : loss = 16.9896926886Training loss: 19.1473407745
Training acc: 0.161830357143
Validation acc: 0.15625
Epoch 14
20 / 28 : loss = 18.6388168335Training loss: 18.208070755
Training acc: 0.170758928571
Validation acc: 0.1875
Epoch 15
20 / 28 : loss = 18.0320968628Training loss: 19.0451030731
Training acc: 0.167410714286
Validation acc: 0.177083333333
Epoch 16
20 / 28 : loss = 16.5655670166Training loss: 15.7548246384
Training acc: 0.183035714286
Validation acc: 0.177083333333
Epoch 17
20 / 28 : loss = 14.1768779755Training loss: 15.309586525
Training acc: 0.157366071429
Validation acc: 0.125
Epoch 18
20 / 28 : loss = 14.9941987991Training loss: 14.9378528595
Training acc: 0.203125
Validation acc: 0.0520833333333
Epoch 19
20 / 28 : loss = 15.2456159592Training loss: 14.8912906647
Training acc: 0.207589285714
Validation acc: 0.25
Epoch 20
20 / 28 : loss = 17.4307155609Training loss: 16.7098903656
Training acc: 0.152901785714
Validation acc: 0.09375
Testing acc: 0.160282258065
Epoch 21
20 / 28 : loss = 14.3242416382Training loss: 15.043431282
Training acc: 0.170758928571
Validation acc: 0.229166666667
Epoch 22
20 / 28 : loss = 14.1245985031Training loss: 13.8844461441
Training acc: 0.217633928571
Validation acc: 0.1875
Epoch 23
20 / 28 : loss = 13.3127031326Training loss: 13.5070495605
Training acc: 0.166294642857
Validation acc: 0.166666666667
Epoch 24
20 / 28 : loss = 13.6729316711Training loss: 13.5167627335
Training acc: 0.157366071429
Validation acc: 0.166666666667
Epoch 25
20 / 28 : loss = 13.8267650604Training loss: 14.6545972824
Training acc: 0.172991071429
Validation acc: 0.21875
Epoch 26
20 / 28 : loss = 13.7069702148Training loss: 13.7916669846
Training acc: 0.171875
Validation acc: 0.145833333333
Epoch 27
20 / 28 : loss = 11.3616743088Training loss: 12.2557086945
Training acc: 0.183035714286
Validation acc: 0.15625
Epoch 28
20 / 28 : loss = 12.8968391418Training loss: 12.6323728561
Training acc: 0.168526785714
Validation acc: 0.166666666667
Epoch 29
20 / 28 : loss = 13.4107580185Training loss: 13.3542547226
Training acc: 0.15625
Validation acc: 0.114583333333
Epoch 30
20 / 28 : loss = 10.8888521194Training loss: 10.6978969574
Training acc: 0.167410714286
Validation acc: 0.229166666667
Epoch 31
20 / 28 : loss = 10.9097242355Training loss: 11.132932663
Training acc: 0.189732142857
Validation acc: 0.197916666667
Epoch 32
20 / 28 : loss = 11.3116073608Training loss: 11.1735076904
Training acc: 0.181919642857
Validation acc: 0.166666666667
Epoch 33
20 / 28 : loss = 12.6540470123Training loss: 12.3342466354
Training acc: 0.140625
Validation acc: 0.1875
Epoch 34
20 / 28 : loss = 11.3262414932Training loss: 11.961848259
Training acc: 0.154017857143
Validation acc: 0.09375
Epoch 35
20 / 28 : loss = 10.3173303604Training loss: 11.6761217117
Training acc: 0.154017857143
Validation acc: 0.177083333333
Epoch 36
20 / 28 : loss = 10.6141891479Training loss: 10.1754598618
Training acc: 0.185267857143
Validation acc: 0.21875
Epoch 37
20 / 28 : loss = 9.51489543915Training loss: 11.0621271133
Training acc: 0.176339285714
Validation acc: 0.145833333333
Epoch 38
20 / 28 : loss = 9.99441051483Training loss: 10.1444730759
Training acc: 0.171875
Validation acc: 0.135416666667
Epoch 39
20 / 28 : loss = 9.29711818695Training loss: 9.66412830353
Training acc: 0.185267857143
Validation acc: 0.197916666667
Epoch 40
20 / 28 : loss = 10.8326082236Training loss: 10.6301040649
Training acc: 0.165178571429
Validation acc: 0.09375
Testing acc: 0.161290322581
Epoch 41
20 / 28 : loss = 10.0237264633Training loss: 10.5796890259
Training acc: 0.188616071429
Validation acc: 0.15625
Epoch 42
20 / 28 : loss = 10.4022855759Training loss: 10.7691059113
Training acc: 0.165178571429
Validation acc: 0.177083333333
Epoch 43
20 / 28 : loss = 10.8935775757Training loss: 11.1955080032
Training acc: 0.15625
Validation acc: 0.291666666667
Epoch 44
20 / 28 : loss = 9.29723834991Training loss: 9.30948066711
Training acc: 0.161830357143
Validation acc: 0.166666666667
Epoch 45
20 / 28 : loss = 9.96458530426Training loss: 8.80862617493
Training acc: 0.165178571429
Validation acc: 0.1875
Epoch 46
20 / 28 : loss = 10.1364583969Training loss: 10.6619958878
Training acc: 0.140625
Validation acc: 0.114583333333
Epoch 47
20 / 28 : loss = 9.41516876221Training loss: 8.71870613098
Training acc: 0.196428571429
Validation acc: 0.21875
Epoch 48
20 / 28 : loss = 8.31880378723Training loss: 9.03027248383
Training acc: 0.185267857143
Validation acc: 0.145833333333
Epoch 49
20 / 28 : loss = 8.82107067108Training loss: 9.48087882996
Training acc: 0.180803571429
Validation acc: 0.208333333333
Epoch 50
20 / 28 : loss = 10.0009021759Training loss: 10.0051527023
Training acc: 0.159598214286
Validation acc: 0.1875
Epoch 51
20 / 28 : loss = 9.54438304901Training loss: 9.09631538391
Training acc: 0.189732142857
Validation acc: 0.270833333333
Epoch 52
20 / 28 : loss = 8.56032466888Training loss: 8.53931617737
Training acc: 0.177455357143
Validation acc: 0.197916666667
Epoch 53
20 / 28 : loss = 9.09006786346Training loss: 8.31800556183
Training acc: 0.181919642857
Validation acc: 0.229166666667
Epoch 54
20 / 28 : loss = 9.74802398682Training loss: 9.52048683167
Training acc: 0.172991071429
Validation acc: 0.135416666667
Epoch 55
20 / 28 : loss = 7.29181766517Training loss: 7.80609178543
Training acc: 0.181919642857
Validation acc: 0.15625
Epoch 56
20 / 28 : loss = 8.77319335938Training loss: 8.73828315735
Training acc: 0.161830357143
Validation acc: 0.135416666667
Epoch 57
20 / 28 : loss = 8.2513961792Training loss: 8.28934383392
Training acc: 0.180803571429
Validation acc: 0.1875
Epoch 58
20 / 28 : loss = 7.23521995544Training loss: 7.06332015991
Training acc: 0.174107142857
Validation acc: 0.145833333333
Epoch 59
20 / 28 : loss = 8.17005538944Training loss: 8.91650104523
Training acc: 0.172991071429
Validation acc: 0.145833333333
Epoch 60
20 / 28 : loss = 7.89083576202Training loss: 8.04525947571
Training acc: 0.151785714286
Validation acc: 0.0833333333333
Testing acc: 0.164314516129
Epoch 61
20 / 28 : loss = 7.32046079636Training loss: 7.68439245224
Training acc: 0.167410714286
Validation acc: 0.114583333333
Epoch 62
20 / 28 : loss = 7.95667219162Training loss: 7.17504882812
Training acc: 0.205357142857
Validation acc: 0.15625
Epoch 63
20 / 28 : loss = 8.01681900024Training loss: 8.09084701538
Training acc: 0.171875
Validation acc: 0.145833333333
Epoch 64
20 / 28 : loss = 8.53559207916Training loss: 7.88703203201
Training acc: 0.171875
Validation acc: 0.15625
Epoch 65
20 / 28 : loss = 7.57819986343Training loss: 7.88773202896
Training acc: 0.152901785714
Validation acc: 0.145833333333
Epoch 66
20 / 28 : loss = 7.61167383194Training loss: 7.38211774826
Training acc: 0.176339285714
Validation acc: 0.15625
Epoch 67
20 / 28 : loss = 7.72405576706Training loss: 8.12696743011
Training acc: 0.166294642857
Validation acc: 0.135416666667
Epoch 68
20 / 28 : loss = 7.08136081696Training loss: 7.1853518486
Training acc: 0.177455357143
Validation acc: 0.208333333333
Epoch 69
20 / 28 : loss = 7.04484319687Training loss: 7.55248785019
Training acc: 0.181919642857
Validation acc: 0.15625
Epoch 70
20 / 28 : loss = 7.37038898468Training loss: 7.47271776199
Training acc: 0.166294642857
Validation acc: 0.197916666667
Epoch 71
20 / 28 : loss = 7.49147605896Training loss: 7.26504850388
Training acc: 0.160714285714
Validation acc: 0.166666666667
Epoch 72
20 / 28 : loss = 7.58868646622Training loss: 7.45147037506
Training acc: 0.185267857143
Validation acc: 0.21875
Epoch 73
20 / 28 : loss = 7.07863664627Training loss: 6.86393880844
Training acc: 0.183035714286
Validation acc: 0.239583333333
Epoch 74
20 / 28 : loss = 7.23728656769Training loss: 7.57930994034
Training acc: 0.177455357143
Validation acc: 0.177083333333
Epoch 75
20 / 28 : loss = 7.70226478577Training loss: 7.37837076187
Training acc: 0.150669642857
Validation acc: 0.0729166666667
Epoch 76
20 / 28 : loss = 8.48911190033Training loss: 7.95633792877
Training acc: 0.1484375
Validation acc: 0.208333333333
Epoch 77
20 / 28 : loss = 7.01201677322Training loss: 6.24365329742
Training acc: 0.1953125
Validation acc: 0.09375
Epoch 78
20 / 28 : loss = 6.79968118668Training loss: 7.18845510483
Training acc: 0.177455357143
Validation acc: 0.1875
Epoch 79
20 / 28 : loss = 6.96407079697Training loss: 6.94128465652
Training acc: 0.1796875
Validation acc: 0.260416666667
Epoch 80
20 / 28 : loss = 6.62237930298Training loss: 6.71247196198
Training acc: 0.209821428571
Validation acc: 0.125
Testing acc: 0.176411290323
Epoch 81
20 / 28 : loss = 8.14553546906Training loss: 7.5237326622
Training acc: 0.160714285714
Validation acc: 0.208333333333
Epoch 82
20 / 28 : loss = 6.05569553375Training loss: 5.98362064362
Training acc: 0.188616071429
Validation acc: 0.197916666667
Epoch 83
20 / 28 : loss = 6.17184162146Training loss: 6.10131788254
Training acc: 0.198660714286
Validation acc: 0.197916666667
Epoch 84
20 / 28 : loss = 5.9182062149Training loss: 6.39048671722
Training acc: 0.174107142857
Validation acc: 0.145833333333
Epoch 85
20 / 28 : loss = 7.04059839249Training loss: 6.60533475876
Training acc: 0.1484375
Validation acc: 0.125
Epoch 86
20 / 28 : loss = 6.68956232071Training loss: 6.28007459641
Training acc: 0.1953125
Validation acc: 0.15625
Epoch 87
20 / 28 : loss = 7.3663315773Training loss: 6.9474272728
Training acc: 0.170758928571
Validation acc: 0.135416666667
Epoch 88
20 / 28 : loss = 6.33744144442Training loss: 7.14786863327
Training acc: 0.154017857143
Validation acc: 0.322916666667
Epoch 89
20 / 28 : loss = 5.90618324287Training loss: 6.4541478157
Training acc: 0.184151785714
Validation acc: 0.09375
Epoch 90
20 / 28 : loss = 6.33698511124Training loss: 6.32900714874
Training acc: 0.1484375
Validation acc: 0.114583333333
Epoch 91
20 / 28 : loss = 7.20653057098Training loss: 7.0960187912
Training acc: 0.152901785714
Validation acc: 0.15625
Epoch 92
20 / 28 : loss = 6.10948705673Training loss: 6.41548299789
Training acc: 0.171875
Validation acc: 0.21875
Epoch 93
20 / 28 : loss = 5.58699417114Training loss: 5.46778726578
Training acc: 0.1875
Validation acc: 0.21875
Epoch 94
20 / 28 : loss = 5.40015029907Training loss: 5.76583433151
Training acc: 0.184151785714
Validation acc: 0.114583333333
Epoch 95
20 / 28 : loss = 5.81599712372Training loss: 6.08095121384
Training acc: 0.171875
Validation acc: 0.104166666667
Epoch 96
20 / 28 : loss = 5.05745649338Training loss: 5.98243761063
Training acc: 0.166294642857
Validation acc: 0.15625
Epoch 97
20 / 28 : loss = 5.66212892532Training loss: 6.1371011734
Training acc: 0.171875
Validation acc: 0.229166666667
Epoch 98
20 / 28 : loss = 6.21783542633Training loss: 6.40650272369
Training acc: 0.15625
Validation acc: 0.239583333333
Epoch 99
20 / 28 : loss = 6.84039449692Training loss: 6.46970319748
Training acc: 0.155133928571
Validation acc: 0.239583333333

**************************************

qa4_two-arg-relations
vocab = [u'.', u'?', u'The', u'What', u'bathroom', u'bedroom', u'east', u'garden', u'hallway', u'is', u'kitchen', u'north', u'of', u'office', u'south', u'the', u'west']
word_idx = {u'hallway': 9, u'bathroom': 5, u'north': 12, u'garden': 8, u'office': 14, u'of': 13, u'is': 10, u'What': 4, u'.': 1, u'west': 17, u'south': 15, u'bedroom': 6, u'The': 3, u'east': 7, u'the': 16, u'?': 2, u'kitchen': 11}
X.shape = (1000, 2, 8)
Xq.shape = (1000, 7)
Y.shape = (1000, 18)
story_maxlen, sentence_maxlen, query_maxlen = 2, 8, 7
max_epochs = 100
Epoch 0
20 / 28 : loss = 7.09712219238Training loss: 6.03700590134
Training acc: 0.169642857143
Validation acc: 0.166666666667
Testing acc: 0.178427419355
Epoch 1
Training loss: 3.0683026313804
Training acc: 0.150669642857
Validation acc: 0.177083333333
Epoch 2
Training loss: 2.5757391452832
Training acc: 0.181919642857
Validation acc: 0.125
Epoch 3
Training loss: 2.4721717834599
Training acc: 0.160714285714
Validation acc: 0.208333333333
Epoch 4
20 / 28 : loss = 2.38380193718Training loss: 2.3696513176
Training acc: 0.174107142857
Validation acc: 0.15625
Epoch 5
Training loss: 2.3136429786705
Training acc: 0.159598214286
Validation acc: 0.145833333333
Epoch 6
20 / 28 : loss = 2.23636317253Training loss: 2.24419999123
Training acc: 0.172991071429
Validation acc: 0.208333333333
Epoch 7
20 / 28 : loss = 2.28319001198Training loss: 2.27374434471
Training acc: 0.143973214286
Validation acc: 0.135416666667
Epoch 8
Training loss: 2.1579573154421
Training acc: 0.167410714286
Validation acc: 0.114583333333
Epoch 9
Training loss: 2.1615505218574
Training acc: 0.158482142857
Validation acc: 0.177083333333
Epoch 10
20 / 28 : loss = 2.11729764938Training loss: 2.11747574806
Training acc: 0.165178571429
Validation acc: 0.15625
Epoch 11
20 / 28 : loss = 2.07115888596Training loss: 2.09050965309
Training acc: 0.167410714286
Validation acc: 0.145833333333
Epoch 12
20 / 28 : loss = 2.07916784286Training loss: 2.08921957016
Training acc: 0.174107142857
Validation acc: 0.135416666667
Epoch 13
20 / 28 : loss = 2.07233691216Training loss: 2.05947732925
Training acc: 0.152901785714
Validation acc: 0.114583333333
Epoch 14
20 / 28 : loss = 1.97791886336Training loss: 1.99303793907
Training acc: 0.209821428571
Validation acc: 0.239583333333
Epoch 15
Training loss: 2.0135705471395
Training acc: 0.193080357143
Validation acc: 0.145833333333
Epoch 16
20 / 28 : loss = 1.98814046383Training loss: 1.97561705112
Training acc: 0.223214285714
Validation acc: 0.145833333333
Epoch 17
20 / 28 : loss = 1.89684331417Training loss: 1.93497812748
Training acc: 0.267857142857
Validation acc: 0.260416666667
Epoch 18
Training loss: 1.8149337768622
Training acc: 0.334821428571
Validation acc: 0.46875
Epoch 19
20 / 28 : loss = 1.61704635625Training loss: 1.59579098225
Training acc: 0.4140625
Validation acc: 0.479166666667
Epoch 20
20 / 28 : loss = 1.4761865139Training loss: 1.47061979771
Training acc: 0.477678571429
Validation acc: 0.5625
Testing acc: 0.5625
Epoch 21
Training loss: 1.2674386501362
Training acc: 0.537946428571
Validation acc: 0.677083333333
Epoch 22
Training loss: 1.1405409574563
Training acc: 0.565848214286
Validation acc: 0.59375
Epoch 23
20 / 28 : loss = 1.08701300621Training loss: 1.10111320019
Training acc: 0.555803571429
Validation acc: 0.489583333333
Epoch 24
Training loss: 1.0577512979557
Training acc: 0.573660714286
Validation acc: 0.520833333333
Epoch 25
Training loss: 1.0233448743842
Training acc: 0.566964285714
Validation acc: 0.604166666667
Epoch 26
20 / 28 : loss = 1.04080331326Training loss: 1.02807819843
Training acc: 0.577008928571
Validation acc: 0.5625
Epoch 27
20 / 28 : loss = 0.961137473583Training loss: 0.974995791912
Training acc: 0.575892857143
Validation acc: 0.53125
Epoch 28
20 / 28 : loss = 0.906962990761Training loss: 0.931451261044
Training acc: 0.613839285714
Validation acc: 0.5
Epoch 29
20 / 28 : loss = 0.965806245804Training loss: 0.957840740681
Training acc: 0.594866071429
Validation acc: 0.583333333333
Epoch 30
20 / 28 : loss = 0.940128207207Training loss: 0.932860016823
Training acc: 0.606026785714
Validation acc: 0.604166666667
Epoch 31
20 / 28 : loss = 0.948570132256Training loss: 0.946901381016
Training acc: 0.577008928571
Validation acc: 0.59375
Epoch 32
20 / 28 : loss = 0.911292493343Training loss: 0.907399833202
Training acc: 0.630580357143
Validation acc: 0.614583333333
Epoch 33
20 / 28 : loss = 0.955497860909Training loss: 0.960204422474
Training acc: 0.592633928571
Validation acc: 0.71875
Epoch 34
Training loss: 0.93259394168956
Training acc: 0.59375
Validation acc: 0.583333333333
Epoch 35
Training loss: 0.91040623188919
Training acc: 0.597098214286
Validation acc: 0.635416666667
Epoch 36
Training loss: 0.90591251850179
Training acc: 0.610491071429
Validation acc: 0.635416666667
Epoch 37
Training loss: 0.87023639679528
Training acc: 0.638392857143
Validation acc: 0.614583333333
Epoch 38
20 / 28 : loss = 0.933215379715Training loss: 0.913724482059
Training acc: 0.606026785714
Validation acc: 0.635416666667
Epoch 39
Training loss: 0.89601284265527
Training acc: 0.618303571429
Validation acc: 0.635416666667
Epoch 40
Training loss: 0.86277008056641
Training acc: 0.616071428571
Validation acc: 0.625
Testing acc: 0.564516129032
Epoch 41
Training loss: 0.87965720892022
Training acc: 0.612723214286
Validation acc: 0.59375
Epoch 42
Training loss: 0.88594949245507
Training acc: 0.613839285714
Validation acc: 0.65625
Epoch 43
Training loss: 0.84556877613159
Training acc: 0.6484375
Validation acc: 0.604166666667
Epoch 44
20 / 28 : loss = 0.813971221447Training loss: 0.8400811553
Training acc: 0.657366071429
Validation acc: 0.614583333333
Epoch 45
20 / 28 : loss = 0.865990161896Training loss: 0.872877597809
Training acc: 0.633928571429
Validation acc: 0.59375
Epoch 46
20 / 28 : loss = 0.818718791008Training loss: 0.833006203175
Training acc: 0.647321428571
Validation acc: 0.583333333333
Epoch 47
20 / 28 : loss = 0.870508074761Training loss: 0.866905629635
Training acc: 0.626116071429
Validation acc: 0.677083333333
Epoch 48
20 / 28 : loss = 0.819560348988Training loss: 0.835576713085
Training acc: 0.655133928571
Validation acc: 0.666666666667
Epoch 49
Training loss: 0.83580553531642
Training acc: 0.639508928571
Validation acc: 0.677083333333
Epoch 50
20 / 28 : loss = 0.883561372757Training loss: 0.883323132992
Training acc: 0.610491071429
Validation acc: 0.635416666667
Epoch 51
20 / 28 : loss = 0.826774239541Training loss: 0.837446570396
Training acc: 0.633928571429
Validation acc: 0.65625
Epoch 52
Training loss: 0.81002634763745
Training acc: 0.645089285714
Validation acc: 0.666666666667
Epoch 53
20 / 28 : loss = 0.793970942497Training loss: 0.838409423828
Training acc: 0.640625
Validation acc: 0.645833333333
Epoch 54
20 / 28 : loss = 0.79662078619Training loss: 0.818367183208
Training acc: 0.666294642857
Validation acc: 0.708333333333
Epoch 55
20 / 28 : loss = 0.835394561291Training loss: 0.836322963238
Training acc: 0.630580357143
Validation acc: 0.645833333333
Epoch 56
20 / 28 : loss = 0.797531664371Training loss: 0.816715300083
Training acc: 0.666294642857
Validation acc: 0.59375
Epoch 57
Training loss: 0.82843494415386
Training acc: 0.618303571429
Validation acc: 0.59375
Epoch 58
Training loss: 0.83163726329846
Training acc: 0.633928571429
Validation acc: 0.708333333333
Epoch 59
Training loss: 0.79599249362943
Training acc: 0.662946428571
Validation acc: 0.697916666667
Epoch 60
Training loss: 0.80679184198445
Training acc: 0.676339285714
Validation acc: 0.572916666667
Testing acc: 0.535282258065
Epoch 61
Training loss: 0.81254494190202
Training acc: 0.633928571429
Validation acc: 0.625
Epoch 62
Training loss: 0.81738728284875
Training acc: 0.635044642857
Validation acc: 0.677083333333
Epoch 63
Training loss: 0.79754525423729
Training acc: 0.6484375
Validation acc: 0.583333333333
Epoch 64
Training loss: 0.82400804758134
Training acc: 0.645089285714
Validation acc: 0.677083333333
Epoch 65
20 / 28 : loss = 0.811627984047Training loss: 0.818649709225
Training acc: 0.641741071429
Validation acc: 0.75
Epoch 66
20 / 28 : loss = 0.812544167042Training loss: 0.798098266125
Training acc: 0.642857142857
Validation acc: 0.697916666667
Epoch 67
Training loss: 0.78195285797175
Training acc: 0.672991071429
Validation acc: 0.75
Epoch 68
Training loss: 0.81663560867324
Training acc: 0.649553571429
Validation acc: 0.666666666667
Epoch 69
Training loss: 0.80524629354525
Training acc: 0.649553571429
Validation acc: 0.625
Epoch 70
20 / 28 : loss = 0.783004105091Training loss: 0.816798210144
Training acc: 0.65625
Validation acc: 0.666666666667
Epoch 71
Training loss: 0.81541234254832
Training acc: 0.647321428571
Validation acc: 0.614583333333
Epoch 72
20 / 28 : loss = 0.790923774242Training loss: 0.782762885094
Training acc: 0.665178571429
Validation acc: 0.677083333333
Epoch 73
Training loss: 0.78694391250695
Training acc: 0.647321428571
Validation acc: 0.645833333333
Epoch 74
20 / 28 : loss = 0.813117086887Training loss: 0.811757087708
Training acc: 0.655133928571
Validation acc: 0.6875
Epoch 75
Training loss: 0.82044774293916
Training acc: 0.661830357143
Validation acc: 0.71875
Epoch 76
Training loss: 0.80004364252132
Training acc: 0.649553571429
Validation acc: 0.65625
Epoch 77
Training loss: 0.78593671321918
Training acc: 0.678571428571
Validation acc: 0.645833333333
Epoch 78
Training loss: 0.78466796875325
Training acc: 0.658482142857
Validation acc: 0.625
Epoch 79
20 / 28 : loss = 0.78447496891Training loss: 0.79514414072
Training acc: 0.652901785714
Validation acc: 0.666666666667
Epoch 80
Training loss: 0.76109302043964
Training acc: 0.680803571429
Validation acc: 0.677083333333
Testing acc: 0.554435483871
Epoch 81
Training loss: 0.79123395681403
Training acc: 0.677455357143
Validation acc: 0.677083333333
Epoch 82
Training loss: 0.77811235189413
Training acc: 0.676339285714
Validation acc: 0.59375
Epoch 83
Training loss: 0.77834784984685
Training acc: 0.670758928571
Validation acc: 0.635416666667
Epoch 84
Training loss: 0.79004472494176
Training acc: 0.643973214286
Validation acc: 0.65625
Epoch 85
20 / 28 : loss = 0.728888213634Training loss: 0.751167654991
Training acc: 0.691964285714
Validation acc: 0.635416666667
Epoch 86
Training loss: 0.80396366119488
Training acc: 0.675223214286
Validation acc: 0.677083333333
Epoch 87
20 / 28 : loss = 0.776572644711Training loss: 0.777421832085
Training acc: 0.662946428571
Validation acc: 0.677083333333
Epoch 88
20 / 28 : loss = 0.793272495277Training loss: 0.797803223133
Training acc: 0.668526785714
Validation acc: 0.6875
Epoch 89
Training loss: 0.79004794359212
Training acc: 0.662946428571
Validation acc: 0.739583333333
Epoch 90
Training loss: 0.78459280729347
Training acc: 0.672991071429
Validation acc: 0.666666666667
Epoch 91
Training loss: 0.77018588781474
Training acc: 0.671875
Validation acc: 0.572916666667
Epoch 92
Training loss: 0.76067626476309
Training acc: 0.684151785714
Validation acc: 0.583333333333
Epoch 93
20 / 28 : loss = 0.746273875237Training loss: 0.76765024662
Training acc: 0.678571428571
Validation acc: 0.6875
Epoch 94
Training loss: 0.77591067552671
Training acc: 0.674107142857
Validation acc: 0.697916666667
Epoch 95
Training loss: 0.76375812292103
Training acc: 0.686383928571
Validation acc: 0.677083333333
Epoch 96
20 / 28 : loss = 0.765074074268Training loss: 0.78250926733
Training acc: 0.676339285714
Validation acc: 0.75
Epoch 97
20 / 28 : loss = 0.763577580452Training loss: 0.770698964596
Training acc: 0.681919642857
Validation acc: 0.635416666667
Epoch 98
20 / 28 : loss = 0.779392242432Training loss: 0.792751431465
Training acc: 0.677455357143
Validation acc: 0.645833333333
Epoch 99
Training loss: 0.73347955942213
Training acc: 0.717633928571
Validation acc: 0.645833333333

**************************************

qa5_three-arg-relations
vocab = [u'.', u'?', u'Bill', u'Fred', u'Jeff', u'Mary', u'What', u'Who', u'apple', u'back', u'bathroom', u'bedroom', u'did', u'discarded', u'down', u'dropped', u'football', u'garden', u'gave', u'give', u'got', u'grabbed', u'hallway', u'handed', u'journeyed', u'kitchen', u'left', u'milk', u'moved', u'office', u'passed', u'picked', u'put', u'received', u'the', u'there', u'to', u'took', u'travelled', u'up', u'went']
word_idx = {u'What': 7, u'there': 36, u'apple': 9, u'office': 30, u'give': 20, u'moved': 29, u'back': 10, u'down': 15, u'dropped': 16, u'picked': 32, u'bedroom': 12, u'.': 1, u'Mary': 6, u'bathroom': 11, u'grabbed': 22, u'Who': 8, u'milk': 28, u'handed': 24, u'Fred': 4, u'to': 37, u'passed': 31, u'got': 21, u'travelled': 39, u'?': 2, u'gave': 19, u'hallway': 23, u'football': 17, u'garden': 18, u'Bill': 3, u'took': 38, u'put': 33, u'went': 41, u'kitchen': 26, u'received': 34, u'journeyed': 25, u'Jeff': 5, u'did': 13, u'up': 40, u'discarded': 14, u'the': 35, u'left': 27}
X.shape = (1000, 102, 7)
Xq.shape = (1000, 8)
Y.shape = (1000, 42)
story_maxlen, sentence_maxlen, query_maxlen = 102, 7, 8
max_epochs = 100
Epoch 0
20 / 28 : loss = 46.7219924927Training loss: 36.3116531372
Training acc: 0.1484375
Validation acc: 0.208333333333
Testing acc: 0.160282258065
Epoch 1
20 / 28 : loss = 4.75335597992Training loss: 4.70640516281
Training acc: 0.1484375
Validation acc: 0.114583333333
Epoch 2
20 / 28 : loss = 4.38353157043Training loss: 4.36650657654
Training acc: 0.137276785714
Validation acc: 0.15625
Epoch 3
20 / 28 : loss = 4.2345623979Training loss: 4.17713260651
Training acc: 0.131696428571
Validation acc: 0.09375
Epoch 4
20 / 28 : loss = 4.02789831161Training loss: 4.00698041916
Training acc: 0.1328125
Validation acc: 0.125
Epoch 5
20 / 28 : loss = 3.91017079353Training loss: 3.86538529396
Training acc: 0.151785714286
Validation acc: 0.0625
Epoch 6
20 / 28 : loss = 3.74746990204Training loss: 3.71829175949
Training acc: 0.147321428571
Validation acc: 0.208333333333
Epoch 7
20 / 28 : loss = 3.64722156525Training loss: 3.60853433609
Training acc: 0.1484375
Validation acc: 0.1875
Epoch 8
20 / 28 : loss = 3.48015785217Training loss: 3.48356890678
Training acc: 0.151785714286
Validation acc: 0.125
Epoch 9
20 / 28 : loss = 3.42778635025Training loss: 3.41073942184
Training acc: 0.171875
Validation acc: 0.208333333333
Epoch 10
20 / 28 : loss = 3.30356478691Training loss: 3.29868650436
Training acc: 0.150669642857
Validation acc: 0.125
Epoch 11
20 / 28 : loss = 3.23617410664Training loss: 3.22950553894
Training acc: 0.1484375
Validation acc: 0.0625
Epoch 12
20 / 28 : loss = 3.14318037033Training loss: 3.1380674839
Training acc: 0.1640625
Validation acc: 0.166666666667
Epoch 13
20 / 28 : loss = 3.11267662048Training loss: 3.10313272476
Training acc: 0.151785714286
Validation acc: 0.1875
Epoch 14
20 / 28 : loss = 3.03786873817Training loss: 3.04373955727
Training acc: 0.145089285714
Validation acc: 0.145833333333
Epoch 15
20 / 28 : loss = 2.97702932358Training loss: 2.96886634827
Training acc: 0.142857142857
Validation acc: 0.1875
Epoch 16
20 / 28 : loss = 2.93377447128Training loss: 2.91635394096
Training acc: 0.137276785714
Validation acc: 0.125
Epoch 17
20 / 28 : loss = 2.88766527176Training loss: 2.87750506401
Training acc: 0.143973214286
Validation acc: 0.197916666667
Epoch 18
20 / 28 : loss = 2.84262084961Training loss: 2.8441593647
Training acc: 0.128348214286
Validation acc: 0.104166666667
Epoch 19
20 / 28 : loss = 2.80204486847Training loss: 2.7863805294
Training acc: 0.15625
Validation acc: 0.197916666667
Epoch 20
20 / 28 : loss = 2.7709312439Training loss: 2.75796461105
Training acc: 0.141741071429
Validation acc: 0.15625
Testing acc: 0.184475806452
Epoch 21
20 / 28 : loss = 2.72802996635Training loss: 2.7175962925
Training acc: 0.155133928571
Validation acc: 0.260416666667
Epoch 22
20 / 28 : loss = 2.69248914719Training loss: 2.67913627625
Training acc: 0.159598214286
Validation acc: 0.125
Epoch 23
20 / 28 : loss = 2.65621972084Training loss: 2.66005587578
Training acc: 0.154017857143
Validation acc: 0.177083333333
Epoch 24
20 / 28 : loss = 2.62270069122Training loss: 2.61979556084
Training acc: 0.146205357143
Validation acc: 0.125
Epoch 25
20 / 28 : loss = 2.60147166252Training loss: 2.60169029236
Training acc: 0.131696428571
Validation acc: 0.125
Epoch 26
20 / 28 : loss = 2.58644008636Training loss: 2.58588337898
Training acc: 0.130580357143
Validation acc: 0.09375
Epoch 27
20 / 28 : loss = 2.57436990738Training loss: 2.55646014214
Training acc: 0.147321428571
Validation acc: 0.104166666667
Epoch 28
20 / 28 : loss = 2.53617072105Training loss: 2.53149986267
Training acc: 0.162946428571
Validation acc: 0.166666666667
Epoch 29
20 / 28 : loss = 2.47360968592Training loss: 2.48811268806
Training acc: 0.177455357143
Validation acc: 0.177083333333
Epoch 30
20 / 28 : loss = 2.49818706512Training loss: 2.49398350716
Training acc: 0.155133928571
Validation acc: 0.177083333333
Epoch 31
20 / 28 : loss = 2.47733402252Training loss: 2.47463464737
Training acc: 0.166294642857
Validation acc: 0.114583333333
Epoch 32
20 / 28 : loss = 2.44939947128Training loss: 2.4410033226
Training acc: 0.1640625
Validation acc: 0.177083333333
Epoch 33
20 / 28 : loss = 2.43646597862Training loss: 2.43533492088
Training acc: 0.1484375
Validation acc: 0.21875
Epoch 34
20 / 28 : loss = 2.38743877411Training loss: 2.3962533474
Training acc: 0.168526785714
Validation acc: 0.09375
Epoch 35
20 / 28 : loss = 2.36064910889Training loss: 2.37318444252
Training acc: 0.175223214286
Validation acc: 0.125
Epoch 36
20 / 28 : loss = 2.39126706123Training loss: 2.3712542057
Training acc: 0.1640625
Validation acc: 0.125
Epoch 37
20 / 28 : loss = 2.35625362396Training loss: 2.36923027039
Training acc: 0.142857142857
Validation acc: 0.177083333333
Epoch 38
20 / 28 : loss = 2.32600402832Training loss: 2.32581090927
Training acc: 0.189732142857
Validation acc: 0.104166666667
Epoch 39
20 / 28 : loss = 2.41232633591Training loss: 2.40411949158
Training acc: 0.169642857143
Validation acc: 0.135416666667
Epoch 40
20 / 28 : loss = 2.32680773735Training loss: 2.3258125782
Training acc: 0.189732142857
Validation acc: 0.125
Testing acc: 0.160282258065
Epoch 41
20 / 28 : loss = 2.30320668221Training loss: 2.29558992386
Training acc: 0.174107142857
Validation acc: 0.15625
Epoch 42
20 / 28 : loss = 2.28062629738Training loss: 2.26482176781
Training acc: 0.205357142857
Validation acc: 0.177083333333
Epoch 43
20 / 28 : loss = 2.38844633102Training loss: 2.37403154373
Training acc: 0.177455357143
Validation acc: 0.260416666667
Epoch 44
20 / 28 : loss = 2.28977298737Training loss: 2.28235650063
Training acc: 0.185267857143
Validation acc: 0.239583333333
Epoch 45
20 / 28 : loss = 2.23470520973Training loss: 2.29144358635
Training acc: 0.213169642857
Validation acc: 0.208333333333
Epoch 46
20 / 28 : loss = 2.41543197632Training loss: 2.38071107864
Training acc: 0.1953125
Validation acc: 0.28125
Epoch 47
20 / 28 : loss = 2.44389200211Training loss: 2.41062188148
Training acc: 0.222098214286
Validation acc: 0.145833333333
Epoch 48
20 / 28 : loss = 2.27846193314Training loss: 2.28133893013
Training acc: 0.225446428571
Validation acc: 0.21875
Epoch 49
20 / 28 : loss = 2.28380799294Training loss: 2.27280783653
Training acc: 0.197544642857
Validation acc: 0.302083333333
Epoch 50
20 / 28 : loss = 2.27012681961Training loss: 2.27013397217
Training acc: 0.223214285714
Validation acc: 0.21875
Epoch 51
20 / 28 : loss = 2.22879719734Training loss: 2.22189569473
Training acc: 0.229910714286
Validation acc: 0.177083333333
Epoch 52
20 / 28 : loss = 2.20235538483Training loss: 2.21557402611
Training acc: 0.241071428571
Validation acc: 0.25
Epoch 53
20 / 28 : loss = 2.17690706253Training loss: 2.16990280151
Training acc: 0.248883928571
Validation acc: 0.28125
Epoch 54
20 / 28 : loss = 2.16115927696Training loss: 2.15751719475
Training acc: 0.251116071429
Validation acc: 0.28125
Epoch 55
20 / 28 : loss = 2.12156105042Training loss: 2.11079621315
Training acc: 0.251116071429
Validation acc: 0.322916666667
Epoch 56
20 / 28 : loss = 2.10698819164Training loss: 2.08816981316
Training acc: 0.282366071429
Validation acc: 0.447916666667
Epoch 57
20 / 28 : loss = 1.95327973366Training loss: 1.93083226681
Training acc: 0.313616071429
Validation acc: 0.364583333333
Epoch 58
20 / 28 : loss = 1.90234732628Training loss: 1.92107617855
Training acc: 0.345982142857
Validation acc: 0.333333333333
Epoch 59
20 / 28 : loss = 1.82763636112Training loss: 1.85072505474
Training acc: 0.356026785714
Validation acc: 0.364583333333
Epoch 60
20 / 28 : loss = 1.76728343964Training loss: 1.79382920265
Training acc: 0.375
Validation acc: 0.34375
Testing acc: 0.304435483871
Epoch 61
20 / 28 : loss = 1.79818725586Training loss: 1.80453503132
Training acc: 0.3515625
Validation acc: 0.447916666667
Epoch 62
20 / 28 : loss = 1.76008009911Training loss: 1.74772953987
Training acc: 0.376116071429
Validation acc: 0.34375
Epoch 63
20 / 28 : loss = 1.71003830433Training loss: 1.71987557411
Training acc: 0.380580357143
Validation acc: 0.4375
Epoch 64
20 / 28 : loss = 1.69471430779Training loss: 1.6804176569
Training acc: 0.395089285714
Validation acc: 0.46875
Epoch 65
20 / 28 : loss = 1.65474772453Training loss: 1.66621494293
Training acc: 0.385044642857
Validation acc: 0.416666666667
Epoch 66
20 / 28 : loss = 1.65102660656Training loss: 1.65328061581
Training acc: 0.399553571429
Validation acc: 0.3125
Epoch 67
20 / 28 : loss = 1.62994670868Training loss: 1.64481317997
Training acc: 0.399553571429
Validation acc: 0.427083333333
Epoch 68
20 / 28 : loss = 1.57764089108Training loss: 1.59163117409
Training acc: 0.415178571429
Validation acc: 0.5
Epoch 69
20 / 28 : loss = 1.64638876915Training loss: 1.63548970222
Training acc: 0.404017857143
Validation acc: 0.375
Epoch 70
20 / 28 : loss = 1.64561975002Training loss: 1.6245046854
Training acc: 0.410714285714
Validation acc: 0.489583333333
Epoch 71
20 / 28 : loss = 1.58865427971Training loss: 1.57598102093
Training acc: 0.421875
Validation acc: 0.479166666667
Epoch 72
20 / 28 : loss = 1.54406011105Training loss: 1.55455958843
Training acc: 0.425223214286
Validation acc: 0.40625
Epoch 73
20 / 28 : loss = 1.52326202393Training loss: 1.53732144833
Training acc: 0.438616071429
Validation acc: 0.479166666667
Epoch 74
20 / 28 : loss = 1.50302481651Training loss: 1.54481101036
Training acc: 0.399553571429
Validation acc: 0.447916666667
Epoch 75
20 / 28 : loss = 1.52062416077Training loss: 1.52268540859
Training acc: 0.422991071429
Validation acc: 0.40625
Epoch 76
20 / 28 : loss = 1.48874270916Training loss: 1.49549210072
Training acc: 0.436383928571
Validation acc: 0.40625
Epoch 77
20 / 28 : loss = 1.50838088989Training loss: 1.51446890831
Training acc: 0.453125
Validation acc: 0.541666666667
Epoch 78
20 / 28 : loss = 1.49745702744Training loss: 1.50574326515
Training acc: 0.436383928571
Validation acc: 0.427083333333
Epoch 79
20 / 28 : loss = 1.47691261768Training loss: 1.50008130074
Training acc: 0.448660714286
Validation acc: 0.541666666667
Epoch 80
20 / 28 : loss = 1.48528170586Training loss: 1.49804568291
Training acc: 0.438616071429
Validation acc: 0.614583333333
Testing acc: 0.333669354839
Epoch 81
20 / 28 : loss = 1.44599783421Training loss: 1.46956884861
Training acc: 0.456473214286
Validation acc: 0.5
Epoch 82
20 / 28 : loss = 1.45916724205Training loss: 1.4571634531
Training acc: 0.4453125
Validation acc: 0.479166666667
Epoch 83
20 / 28 : loss = 1.44217908382Training loss: 1.45642769337
Training acc: 0.467633928571
Validation acc: 0.375
Epoch 84
20 / 28 : loss = 1.42050135136Training loss: 1.4207918644
Training acc: 0.498883928571
Validation acc: 0.5
Epoch 85
20 / 28 : loss = 1.45049655437Training loss: 1.45226705074
Training acc: 0.491071428571
Validation acc: 0.375
Epoch 86
20 / 28 : loss = 1.41419541836Training loss: 1.43153643608
Training acc: 0.482142857143
Validation acc: 0.447916666667
Epoch 87
20 / 28 : loss = 1.44821083546Training loss: 1.4371317625
Training acc: 0.491071428571
Validation acc: 0.510416666667
Epoch 88
20 / 28 : loss = 1.41337883472Training loss: 1.43449091911
Training acc: 0.487723214286
Validation acc: 0.541666666667
Epoch 89
20 / 28 : loss = 1.43015348911Training loss: 1.4255644083
Training acc: 0.475446428571
Validation acc: 0.447916666667
Epoch 90
20 / 28 : loss = 1.45573139191Training loss: 1.43292963505
Training acc: 0.481026785714
Validation acc: 0.4375
Epoch 91
20 / 28 : loss = 1.41072344782Training loss: 1.42565250397
Training acc: 0.472098214286
Validation acc: 0.520833333333
Epoch 92
20 / 28 : loss = 1.39230966568Training loss: 1.39646375179
Training acc: 0.502232142857
Validation acc: 0.510416666667
Epoch 93
20 / 28 : loss = 1.38642311096Training loss: 1.38661086559
Training acc: 0.498883928571
Validation acc: 0.552083333333
Epoch 94
20 / 28 : loss = 1.41884016991Training loss: 1.39787960052
Training acc: 0.510044642857
Validation acc: 0.59375
Epoch 95
20 / 28 : loss = 1.35294783115Training loss: 1.37390112877
Training acc: 0.530133928571
Validation acc: 0.447916666667
Epoch 96
20 / 28 : loss = 1.37733304501Training loss: 1.36912381649
Training acc: 0.524553571429
Validation acc: 0.4375
Epoch 97
20 / 28 : loss = 1.36697185045Training loss: 1.3623329401
Training acc: 0.513392857143
Validation acc: 0.520833333333
Epoch 98
20 / 28 : loss = 1.39679598808Training loss: 1.38468718529
Training acc: 0.5234375
Validation acc: 0.447916666667
Epoch 99
20 / 28 : loss = 1.35677361488Training loss: 1.38333392143
Training acc: 0.515625
Validation acc: 0.552083333333

**************************************

qa6_yes-no-questions
vocab = [u'.', u'?', u'Daniel', u'Is', u'John', u'Mary', u'Sandra', u'apple', u'back', u'bathroom', u'bedroom', u'discarded', u'down', u'dropped', u'football', u'garden', u'got', u'grabbed', u'hallway', u'in', u'journeyed', u'kitchen', u'left', u'milk', u'moved', u'no', u'office', u'picked', u'put', u'the', u'there', u'to', u'took', u'travelled', u'up', u'went', u'yes']
word_idx = {u'apple': 8, u'office': 27, u'bedroom': 11, u'moved': 25, u'back': 9, u'down': 13, u'Daniel': 3, u'dropped': 14, u'picked': 28, u'in': 20, u'yes': 37, u'John': 5, u'Mary': 6, u'bathroom': 10, u'grabbed': 18, u'no': 26, u'there': 31, u'milk': 24, u'.': 1, u'to': 32, u'Sandra': 7, u'got': 17, u'travelled': 34, u'?': 2, u'hallway': 19, u'garden': 16, u'football': 15, u'took': 33, u'put': 29, u'went': 36, u'kitchen': 22, u'journeyed': 21, u'Is': 4, u'up': 35, u'discarded': 12, u'the': 30, u'left': 23}
X.shape = (1000, 26, 7)
Xq.shape = (1000, 6)
Y.shape = (1000, 38)
story_maxlen, sentence_maxlen, query_maxlen = 26, 7, 6
max_epochs = 100
Epoch 0
20 / 28 : loss = 15.7868490219Training loss: 13.4266681671
Training acc: 0.452008928571
Validation acc: 0.53125
Testing acc: 0.497983870968
Epoch 1
Training loss: 5.8850092887946
Training acc: 0.498883928571
Validation acc: 0.447916666667
Epoch 2
Training loss: 4.1800551414522
Training acc: 0.511160714286
Validation acc: 0.53125
Epoch 3
Training loss: 3.7420520782593
Training acc: 0.511160714286
Validation acc: 0.541666666667
Epoch 4
Training loss: 3.4474408626624
Training acc: 0.495535714286
Validation acc: 0.46875
Epoch 5
20 / 28 : loss = 3.2484664917Training loss: 2.92944002151
Training acc: 0.504464285714
Validation acc: 0.572916666667
Epoch 6
20 / 28 : loss = 2.66560554504Training loss: 2.65605020523
Training acc: 0.494419642857
Validation acc: 0.5
Epoch 7
20 / 28 : loss = 2.32774996758Training loss: 2.35327458382
Training acc: 0.5078125
Validation acc: 0.53125
Epoch 8
20 / 28 : loss = 2.34109044075Training loss: 2.2484061718
Training acc: 0.506696428571
Validation acc: 0.510416666667
Epoch 9
20 / 28 : loss = 1.86716151237Training loss: 1.88068675995
Training acc: 0.512276785714
Validation acc: 0.5625
Epoch 10
20 / 28 : loss = 2.00735235214Training loss: 1.97296309471
Training acc: 0.495535714286
Validation acc: 0.427083333333
Epoch 11
20 / 28 : loss = 1.66634440422Training loss: 1.71417140961
Training acc: 0.522321428571
Validation acc: 0.572916666667
Epoch 12
20 / 28 : loss = 2.05176877975Training loss: 1.91848599911
Training acc: 0.479910714286
Validation acc: 0.510416666667
Epoch 13
20 / 28 : loss = 1.58569335938Training loss: 1.64890062809
Training acc: 0.4921875
Validation acc: 0.520833333333
Epoch 14
20 / 28 : loss = 1.39773774147Training loss: 1.58772969246
Training acc: 0.497767857143
Validation acc: 0.489583333333
Epoch 15
20 / 28 : loss = 1.56666254997Training loss: 1.57489740849
Training acc: 0.498883928571
Validation acc: 0.552083333333
Epoch 16
20 / 28 : loss = 1.44871890545Training loss: 1.45920956135
Training acc: 0.498883928571
Validation acc: 0.458333333333
Epoch 17
20 / 28 : loss = 1.21045470238Training loss: 1.24747371674
Training acc: 0.547991071429
Validation acc: 0.4375
Epoch 18
20 / 28 : loss = 1.28920006752Training loss: 1.34275925159
Training acc: 0.495535714286
Validation acc: 0.5
Epoch 19
20 / 28 : loss = 1.37123358251Training loss: 1.29113805294
Training acc: 0.515625
Validation acc: 0.458333333333
Epoch 20
20 / 28 : loss = 1.40706193447Training loss: 1.4005368948
Training acc: 0.485491071429
Validation acc: 0.416666666667
Testing acc: 0.502016129032
Epoch 21
Training loss: 1.4448032379238
Training acc: 0.469866071429
Validation acc: 0.520833333333
Epoch 22
Training loss: 1.2553504705411
Training acc: 0.487723214286
Validation acc: 0.489583333333
Epoch 23
Training loss: 1.1355212926989
Training acc: 0.486607142857
Validation acc: 0.46875
Epoch 24
Training loss: 1.0476797819141
Training acc: 0.503348214286
Validation acc: 0.520833333333
Epoch 25
20 / 28 : loss = 1.20001924038Training loss: 1.1698321104
Training acc: 0.486607142857
Validation acc: 0.53125
Epoch 26
20 / 28 : loss = 1.01487994194Training loss: 1.00142157078
Training acc: 0.508928571429
Validation acc: 0.510416666667
Epoch 27
20 / 28 : loss = 1.16949248314Training loss: 1.10832822323
Training acc: 0.5
Validation acc: 0.46875
Epoch 28
20 / 28 : loss = 0.916729271412Training loss: 0.982969880104
Training acc: 0.5
Validation acc: 0.510416666667
Epoch 29
20 / 28 : loss = 0.987195432186Training loss: 1.00984632969
Training acc: 0.488839285714
Validation acc: 0.510416666667
Epoch 30
20 / 28 : loss = 1.01331746578Training loss: 1.07306301594
Training acc: 0.497767857143
Validation acc: 0.552083333333
Epoch 31
20 / 28 : loss = 1.10728406906Training loss: 1.07974553108
Training acc: 0.4765625
Validation acc: 0.458333333333
Epoch 32
20 / 28 : loss = 1.03509855274Training loss: 1.04185557365
Training acc: 0.487723214286
Validation acc: 0.46875
Epoch 33
20 / 28 : loss = 1.07738935947Training loss: 1.01509022713
Training acc: 0.495535714286
Validation acc: 0.510416666667
Epoch 34
20 / 28 : loss = 0.941191971302Training loss: 0.924203932285
Training acc: 0.517857142857
Validation acc: 0.395833333333
Epoch 35
20 / 28 : loss = 0.944895148277Training loss: 0.932414889336
Training acc: 0.505580357143
Validation acc: 0.416666666667
Epoch 36
20 / 28 : loss = 0.983664572239Training loss: 0.956837236881
Training acc: 0.506696428571
Validation acc: 0.520833333333
Epoch 37
20 / 28 : loss = 0.884159088135Training loss: 0.937627017498
Training acc: 0.497767857143
Validation acc: 0.552083333333
Epoch 38
20 / 28 : loss = 0.878352999687Training loss: 0.913468241692
Training acc: 0.511160714286
Validation acc: 0.479166666667
Epoch 39
20 / 28 : loss = 0.908048748972Training loss: 0.908781051636
Training acc: 0.491071428571
Validation acc: 0.510416666667
Epoch 40
20 / 28 : loss = 0.917060315609Training loss: 0.889262080193
Training acc: 0.518973214286
Validation acc: 0.385416666667
Testing acc: 0.497983870968
Epoch 41
Training loss: 0.89841187000336
Training acc: 0.505580357143
Validation acc: 0.552083333333
Epoch 42
Training loss: 0.95029366016429
Training acc: 0.496651785714
Validation acc: 0.458333333333
Epoch 43
Training loss: 0.88970071077333
Training acc: 0.517857142857
Validation acc: 0.552083333333
Epoch 44
Training loss: 0.92205625772543
Training acc: 0.485491071429
Validation acc: 0.479166666667
Epoch 45
20 / 28 : loss = 0.894770324231Training loss: 0.877960681915
Training acc: 0.513392857143
Validation acc: 0.4375
Epoch 46
20 / 28 : loss = 0.886278450489Training loss: 0.884743511677
Training acc: 0.505580357143
Validation acc: 0.59375
Epoch 47
20 / 28 : loss = 0.900761544704Training loss: 0.889679729939
Training acc: 0.503348214286
Validation acc: 0.5
Epoch 48
20 / 28 : loss = 0.871959507465Training loss: 0.855482280254
Training acc: 0.511160714286
Validation acc: 0.552083333333
Epoch 49
20 / 28 : loss = 0.892997562885Training loss: 0.86717748642
Training acc: 0.506696428571
Validation acc: 0.520833333333
Epoch 50
20 / 28 : loss = 0.905361652374Training loss: 0.876949846745
Training acc: 0.484375
Validation acc: 0.447916666667
Epoch 51
20 / 28 : loss = 0.907592594624Training loss: 0.880076289177
Training acc: 0.495535714286
Validation acc: 0.520833333333
Epoch 52
20 / 28 : loss = 0.874233424664Training loss: 0.908023715019
Training acc: 0.46875
Validation acc: 0.458333333333
Epoch 53
20 / 28 : loss = 0.812339603901Training loss: 0.811978399754
Training acc: 0.53125
Validation acc: 0.46875
Epoch 54
20 / 28 : loss = 0.794055461884Training loss: 0.826351106167
Training acc: 0.514508928571
Validation acc: 0.458333333333
Epoch 55
20 / 28 : loss = 0.901705682278Training loss: 0.870704054832
Training acc: 0.503348214286
Validation acc: 0.520833333333
Epoch 56
20 / 28 : loss = 0.800609707832Training loss: 0.813479363918
Training acc: 0.5234375
Validation acc: 0.520833333333
Epoch 57
20 / 28 : loss = 0.891650974751Training loss: 0.866561591625
Training acc: 0.495535714286
Validation acc: 0.4375
Epoch 58
20 / 28 : loss = 0.812270581722Training loss: 0.821816027164
Training acc: 0.515625
Validation acc: 0.447916666667
Epoch 59
20 / 28 : loss = 0.844619572163Training loss: 0.84855222702
Training acc: 0.506696428571
Validation acc: 0.427083333333
Epoch 60
20 / 28 : loss = 0.813701748848Training loss: 0.824381530285
Training acc: 0.501116071429
Validation acc: 0.541666666667
Testing acc: 0.497983870968
Epoch 61
Training loss: 0.83264124393535
Training acc: 0.506696428571
Validation acc: 0.489583333333
Epoch 62
Training loss: 0.86495780944859
Training acc: 0.489955357143
Validation acc: 0.510416666667
Epoch 63
Training loss: 0.83039009571112
Training acc: 0.501116071429
Validation acc: 0.46875
Epoch 64
Training loss: 0.85463219881151
Training acc: 0.511160714286
Validation acc: 0.5
Epoch 65
20 / 28 : loss = 0.854716777802Training loss: 0.851453483105
Training acc: 0.496651785714
Validation acc: 0.541666666667
Epoch 66
20 / 28 : loss = 0.819067656994Training loss: 0.849637031555
Training acc: 0.494419642857
Validation acc: 0.489583333333
Epoch 67
20 / 28 : loss = 0.839214503765Training loss: 0.840549468994
Training acc: 0.487723214286
Validation acc: 0.510416666667
Epoch 68
20 / 28 : loss = 0.897977113724Training loss: 0.895749151707
Training acc: 0.473214285714
Validation acc: 0.520833333333
Epoch 69
20 / 28 : loss = 0.880852103233Training loss: 0.879443705082
Training acc: 0.489955357143
Validation acc: 0.447916666667
Epoch 70
20 / 28 : loss = 0.911240279675Training loss: 0.882169306278
Training acc: 0.477678571429
Validation acc: 0.5
Epoch 71
20 / 28 : loss = 0.841429591179Training loss: 0.828996121883
Training acc: 0.508928571429
Validation acc: 0.489583333333
Epoch 72
20 / 28 : loss = 0.771282017231Training loss: 0.770521700382
Training acc: 0.535714285714
Validation acc: 0.552083333333
Epoch 73
20 / 28 : loss = 0.764187872416Training loss: 0.788732349873
Training acc: 0.522321428571
Validation acc: 0.583333333333
Epoch 74
20 / 28 : loss = 0.809447526932Training loss: 0.799003720284
Training acc: 0.513392857143
Validation acc: 0.479166666667
Epoch 75
20 / 28 : loss = 0.798425316811Training loss: 0.800240576267
Training acc: 0.512276785714
Validation acc: 0.520833333333
Epoch 76
Training loss: 0.79284805059445
Training acc: 0.5078125
Validation acc: 0.541666666667
Epoch 77
20 / 28 : loss = 0.794794380665Training loss: 0.793922483921
Training acc: 0.503348214286
Validation acc: 0.510416666667
Epoch 78
Training loss: 0.77565085887911
Training acc: 0.506696428571
Validation acc: 0.53125
Epoch 79
Training loss: 0.78665983676966
Training acc: 0.511160714286
Validation acc: 0.416666666667
Epoch 80
20 / 28 : loss = 0.772526144981Training loss: 0.780687272549
Training acc: 0.508928571429
Validation acc: 0.46875
Testing acc: 0.510080645161
Epoch 81
Training loss: 0.80270332098752
Training acc: 0.503348214286
Validation acc: 0.447916666667
Epoch 82
Training loss: 0.79678481817233
Training acc: 0.484375
Validation acc: 0.520833333333
Epoch 83
Training loss: 0.78013926744573
Training acc: 0.503348214286
Validation acc: 0.541666666667
Epoch 84
Training loss: 0.76848733425198
Training acc: 0.533482142857
Validation acc: 0.572916666667
Epoch 85
20 / 28 : loss = 0.757521212101Training loss: 0.771269261837
Training acc: 0.517857142857
Validation acc: 0.520833333333
Epoch 86
20 / 28 : loss = 0.808323979378Training loss: 0.798046767712
Training acc: 0.481026785714
Validation acc: 0.604166666667
Epoch 87
20 / 28 : loss = 0.778819382191Training loss: 0.7731757164
Training acc: 0.518973214286
Validation acc: 0.510416666667
Epoch 88
20 / 28 : loss = 0.765996813774Training loss: 0.770036101341
Training acc: 0.5078125
Validation acc: 0.375
Epoch 89
20 / 28 : loss = 0.817917406559Training loss: 0.804994106293
Training acc: 0.502232142857
Validation acc: 0.5
Epoch 90
20 / 28 : loss = 0.775532484055Training loss: 0.770665168762
Training acc: 0.514508928571
Validation acc: 0.552083333333
Epoch 91
20 / 28 : loss = 0.752738296986Training loss: 0.757868468761
Training acc: 0.522321428571
Validation acc: 0.59375
Epoch 92
20 / 28 : loss = 0.792984366417Training loss: 0.78683000803
Training acc: 0.501116071429
Validation acc: 0.5625
Epoch 93
20 / 28 : loss = 0.754584491253Training loss: 0.755559802055
Training acc: 0.518973214286
Validation acc: 0.479166666667
Epoch 94
20 / 28 : loss = 0.813374817371Training loss: 0.795549869537
Training acc: 0.503348214286
Validation acc: 0.510416666667
Epoch 95
20 / 28 : loss = 0.783607006073Training loss: 0.772445142269
Training acc: 0.517857142857
Validation acc: 0.4375
Epoch 96
20 / 28 : loss = 0.785220980644Training loss: 0.790743768215
Training acc: 0.493303571429
Validation acc: 0.510416666667
Epoch 97
20 / 28 : loss = 0.774433314834Training loss: 0.770906090736
Training acc: 0.514508928571
Validation acc: 0.458333333333
Epoch 98
20 / 28 : loss = 0.759182810783Training loss: 0.751793026924
Training acc: 0.527901785714
Validation acc: 0.427083333333
Epoch 99
20 / 28 : loss = 0.760344803333Training loss: 0.757197797298
Training acc: 0.521205357143
Validation acc: 0.40625

**************************************

qa7_counting
vocab = [u'.', u'?', u'Daniel', u'How', u'John', u'Mary', u'Sandra', u'apple', u'back', u'bathroom', u'bedroom', u'carrying', u'discarded', u'down', u'dropped', u'football', u'garden', u'gave', u'got', u'grabbed', u'hallway', u'handed', u'is', u'journeyed', u'kitchen', u'left', u'many', u'milk', u'moved', u'none', u'objects', u'office', u'one', u'passed', u'picked', u'put', u'the', u'there', u'three', u'to', u'took', u'travelled', u'two', u'up', u'went']
word_idx = {u'apple': 8, u'office': 32, u'is': 23, u'moved': 29, u'back': 9, u'one': 33, u'down': 14, u'How': 4, u'Daniel': 3, u'dropped': 15, u'picked': 35, u'bedroom': 11, u'John': 5, u'Mary': 6, u'bathroom': 10, u'grabbed': 20, u'there': 38, u'milk': 28, u'three': 39, u'handed': 22, u'.': 1, u'to': 40, u'passed': 34, u'Sandra': 7, u'got': 19, u'travelled': 42, u'?': 2, u'gave': 18, u'hallway': 21, u'garden': 17, u'football': 16, u'took': 41, u'carrying': 12, u'two': 43, u'put': 36, u'went': 45, u'kitchen': 25, u'none': 30, u'journeyed': 24, u'many': 27, u'up': 44, u'discarded': 13, u'objects': 31, u'the': 37, u'left': 26}
X.shape = (1000, 34, 7)
Xq.shape = (1000, 7)
Y.shape = (1000, 46)
story_maxlen, sentence_maxlen, query_maxlen = 34, 7, 7
max_epochs = 100
Epoch 0
20 / 28 : loss = 33.3498497009Training loss: 28.5426826477
Training acc: 0.447544642857
Validation acc: 0.0
Testing acc: 0.00201612903226
Epoch 1
20 / 28 : loss = 15.116437912Training loss: 14.0453968048
Training acc: 0.448660714286
Validation acc: 0.604166666667
Epoch 2
20 / 28 : loss = 9.51313304901Training loss: 9.72356700897
Training acc: 0.493303571429
Validation acc: 0.604166666667
Epoch 3
20 / 28 : loss = 8.02051544189Training loss: 8.56211471558
Training acc: 0.494419642857
Validation acc: 0.458333333333
Epoch 4
20 / 28 : loss = 7.64029598236Training loss: 8.03626823425
Training acc: 0.470982142857
Validation acc: 0.0729166666667
Epoch 5
20 / 28 : loss = 8.41074752808Training loss: 7.51738977432
Training acc: 0.464285714286
Validation acc: 0.572916666667
Epoch 6
20 / 28 : loss = 6.11019229889Training loss: 6.20535516739
Training acc: 0.482142857143
Validation acc: 0.5
Epoch 7
20 / 28 : loss = 5.85463094711Training loss: 5.85223150253
Training acc: 0.482142857143
Validation acc: 0.40625
Epoch 8
20 / 28 : loss = 5.02366399765Training loss: 5.23266363144
Training acc: 0.485491071429
Validation acc: 0.4375
Epoch 9
20 / 28 : loss = 4.76836585999Training loss: 4.75747966766
Training acc: 0.506696428571
Validation acc: 0.520833333333
Epoch 10
20 / 28 : loss = 5.34248161316Training loss: 5.2612490654
Training acc: 0.473214285714
Validation acc: 0.479166666667
Epoch 11
20 / 28 : loss = 4.61696720123Training loss: 4.6349029541
Training acc: 0.484375
Validation acc: 0.4375
Epoch 12
20 / 28 : loss = 4.69374942782Training loss: 4.39989852905
Training acc: 0.4921875
Validation acc: 0.375
Epoch 13
20 / 28 : loss = 3.74814820291Training loss: 3.95619440079
Training acc: 0.513392857143
Validation acc: 0.458333333333
Epoch 14
20 / 28 : loss = 3.96647357941Training loss: 3.87191700935
Training acc: 0.478794642857
Validation acc: 0.583333333333
Epoch 15
20 / 28 : loss = 4.25755834579Training loss: 4.21486377716
Training acc: 0.435267857143
Validation acc: 0.479166666667
Epoch 16
20 / 28 : loss = 3.77624392509Training loss: 3.61777663231
Training acc: 0.478794642857
Validation acc: 0.541666666667
Epoch 17
20 / 28 : loss = 3.97880673409Training loss: 3.91055560112
Training acc: 0.466517857143
Validation acc: 0.541666666667
Epoch 18
20 / 28 : loss = 3.46376323799Training loss: 3.59388804436
Training acc: 0.469866071429
Validation acc: 0.4375
Epoch 19
20 / 28 : loss = 3.19268846512Training loss: 3.15140748024
Training acc: 0.512276785714
Validation acc: 0.4375
Epoch 20
20 / 28 : loss = 3.08335185051Training loss: 3.16052651405
Training acc: 0.472098214286
Validation acc: 0.416666666667
Testing acc: 0.487903225806
Epoch 21
20 / 28 : loss = 3.85710978508Training loss: 3.46784067154
Training acc: 0.474330357143
Validation acc: 0.5
Epoch 22
20 / 28 : loss = 3.26609182358Training loss: 3.28859210014
Training acc: 0.481026785714
Validation acc: 0.4375
Epoch 23
20 / 28 : loss = 3.40130734444Training loss: 3.37920737267
Training acc: 0.474330357143
Validation acc: 0.510416666667
Epoch 24
20 / 28 : loss = 3.03441143036Training loss: 2.93487882614
Training acc: 0.470982142857
Validation acc: 0.572916666667
Epoch 25
20 / 28 : loss = 2.69567203522Training loss: 2.60616064072
Training acc: 0.501116071429
Validation acc: 0.5
Epoch 26
20 / 28 : loss = 2.87219929695Training loss: 2.85232853889
Training acc: 0.475446428571
Validation acc: 0.479166666667
Epoch 27
20 / 28 : loss = 2.91990447044Training loss: 3.04320406914
Training acc: 0.465401785714
Validation acc: 0.447916666667
Epoch 28
20 / 28 : loss = 2.78163075447Training loss: 2.99826741219
Training acc: 0.450892857143
Validation acc: 0.53125
Epoch 29
20 / 28 : loss = 2.81179809578Training loss: 2.81333184242
Training acc: 0.478794642857
Validation acc: 0.5
Epoch 30
20 / 28 : loss = 2.37098622322Training loss: 2.31837654114
Training acc: 0.520089285714
Validation acc: 0.53125
Epoch 31
20 / 28 : loss = 2.48174476624Training loss: 2.3366997242
Training acc: 0.5
Validation acc: 0.5
Epoch 32
20 / 28 : loss = 2.67732024193Training loss: 2.65464568138
Training acc: 0.505580357143
Validation acc: 0.5625
Epoch 33
20 / 28 : loss = 2.25717735291Training loss: 2.30610013008
Training acc: 0.496651785714
Validation acc: 0.552083333333
Epoch 34
20 / 28 : loss = 2.59897017479Training loss: 2.53180575371
Training acc: 0.482142857143
Validation acc: 0.489583333333
Epoch 35
20 / 28 : loss = 2.56611323357Training loss: 2.29964900017
Training acc: 0.504464285714
Validation acc: 0.5
Epoch 36
20 / 28 : loss = 2.36743044853Training loss: 2.29743123055
Training acc: 0.489955357143
Validation acc: 0.489583333333
Epoch 37
20 / 28 : loss = 2.04100155833Training loss: 2.1988286972
Training acc: 0.522321428571
Validation acc: 0.541666666667
Epoch 38
20 / 28 : loss = 2.33902001381Training loss: 2.26693987846
Training acc: 0.516741071429
Validation acc: 0.416666666667
Epoch 39
20 / 28 : loss = 2.10244894028Training loss: 2.08055186272
Training acc: 0.512276785714
Validation acc: 0.489583333333
Epoch 40
20 / 28 : loss = 2.60008120537Training loss: 2.39904212952
Training acc: 0.5
Validation acc: 0.510416666667
Testing acc: 0.559475806452
Epoch 41
20 / 28 : loss = 2.27406573296Training loss: 2.05853199959
Training acc: 0.526785714286
Validation acc: 0.572916666667
Epoch 42
20 / 28 : loss = 1.94522404671Training loss: 1.98449409008
Training acc: 0.545758928571
Validation acc: 0.53125
Epoch 43
20 / 28 : loss = 2.3681666851Training loss: 2.12128591537
Training acc: 0.520089285714
Validation acc: 0.5
Epoch 44
20 / 28 : loss = 1.84222757816Training loss: 1.7823997736
Training acc: 0.541294642857
Validation acc: 0.489583333333
Epoch 45
20 / 28 : loss = 1.92012405396Training loss: 2.06115937233
Training acc: 0.497767857143
Validation acc: 0.479166666667
Epoch 46
20 / 28 : loss = 1.80606043339Training loss: 1.79809558392
Training acc: 0.566964285714
Validation acc: 0.520833333333
Epoch 47
20 / 28 : loss = 1.68922972679Training loss: 1.75359070301
Training acc: 0.574776785714
Validation acc: 0.4375
Epoch 48
20 / 28 : loss = 2.05172896385Training loss: 2.0167081356
Training acc: 0.545758928571
Validation acc: 0.5
Epoch 49
20 / 28 : loss = 1.80950725079Training loss: 1.77612030506
Training acc: 0.588169642857
Validation acc: 0.65625
Epoch 50
20 / 28 : loss = 1.86335623264Training loss: 1.90567469597
Training acc: 0.553571428571
Validation acc: 0.677083333333
Epoch 51
20 / 28 : loss = 1.66004741192Training loss: 1.69676077366
Training acc: 0.574776785714
Validation acc: 0.625
Epoch 52
20 / 28 : loss = 1.65980780125Training loss: 1.62846565247
Training acc: 0.59375
Validation acc: 0.666666666667
Epoch 53
20 / 28 : loss = 1.76560735703Training loss: 1.77302110195
Training acc: 0.574776785714
Validation acc: 0.614583333333
Epoch 54
20 / 28 : loss = 1.52719807625Training loss: 1.58570420742
Training acc: 0.590401785714
Validation acc: 0.614583333333
Epoch 55
20 / 28 : loss = 1.69602096081Training loss: 1.94496560097
Training acc: 0.583705357143
Validation acc: 0.697916666667
Epoch 56
20 / 28 : loss = 1.54578042033Training loss: 1.567471385
Training acc: 0.607142857143
Validation acc: 0.614583333333
Epoch 57
20 / 28 : loss = 1.30900108814Training loss: 1.43687617779
Training acc: 0.616071428571
Validation acc: 0.65625
Epoch 58
20 / 28 : loss = 1.41921734818Training loss: 1.55811989307
Training acc: 0.592633928571
Validation acc: 0.604166666667
Epoch 59
20 / 28 : loss = 1.47066295147Training loss: 1.52045738697
Training acc: 0.609375
Validation acc: 0.625
Epoch 60
20 / 28 : loss = 1.58291876316Training loss: 1.543846488
Training acc: 0.583705357143
Validation acc: 0.625
Testing acc: 0.654233870968
Epoch 61
20 / 28 : loss = 1.36888670921Training loss: 1.45615541935
Training acc: 0.600446428571
Validation acc: 0.625
Epoch 62
20 / 28 : loss = 1.44740927219Training loss: 1.47231602669
Training acc: 0.6015625
Validation acc: 0.53125
Epoch 63
20 / 28 : loss = 1.61476993561Training loss: 1.49842643738
Training acc: 0.610491071429
Validation acc: 0.666666666667
Epoch 64
20 / 28 : loss = 1.33386445045Training loss: 1.43237793446
Training acc: 0.6171875
Validation acc: 0.510416666667
Epoch 65
20 / 28 : loss = 1.58214747906Training loss: 1.53969609737
Training acc: 0.610491071429
Validation acc: 0.708333333333
Epoch 66
20 / 28 : loss = 1.36178302765Training loss: 1.38022613525
Training acc: 0.598214285714
Validation acc: 0.4375
Epoch 67
20 / 28 : loss = 1.65665018559Training loss: 1.56410777569
Training acc: 0.588169642857
Validation acc: 0.666666666667
Epoch 68
20 / 28 : loss = 1.45829105377Training loss: 1.53095686436
Training acc: 0.609375
Validation acc: 0.65625
Epoch 69
20 / 28 : loss = 1.26518690586Training loss: 1.25405442715
Training acc: 0.659598214286
Validation acc: 0.541666666667
Epoch 70
20 / 28 : loss = 1.46559369564Training loss: 1.65991723537
Training acc: 0.621651785714
Validation acc: 0.489583333333
Epoch 71
20 / 28 : loss = 1.75899374485Training loss: 1.62723648548
Training acc: 0.590401785714
Validation acc: 0.760416666667
Epoch 72
20 / 28 : loss = 1.18519604206Training loss: 1.2538254261
Training acc: 0.642857142857
Validation acc: 0.5625
Epoch 73
20 / 28 : loss = 1.65526068211Training loss: 1.62717664242
Training acc: 0.572544642857
Validation acc: 0.666666666667
Epoch 74
20 / 28 : loss = 1.17552924156Training loss: 1.18405556679
Training acc: 0.657366071429
Validation acc: 0.541666666667
Epoch 75
20 / 28 : loss = 1.18244349957Training loss: 1.38114392757
Training acc: 0.626116071429
Validation acc: 0.677083333333
Epoch 76
20 / 28 : loss = 1.41697025299Training loss: 1.39985454082
Training acc: 0.608258928571
Validation acc: 0.614583333333
Epoch 77
20 / 28 : loss = 1.26054668427Training loss: 1.26638865471
Training acc: 0.649553571429
Validation acc: 0.645833333333
Epoch 78
20 / 28 : loss = 1.30267810822Training loss: 1.35240101814
Training acc: 0.620535714286
Validation acc: 0.583333333333
Epoch 79
20 / 28 : loss = 1.35992240906Training loss: 1.31986629963
Training acc: 0.6171875
Validation acc: 0.625
Epoch 80
20 / 28 : loss = 1.35176527506Training loss: 1.30468714237
Training acc: 0.640625
Validation acc: 0.677083333333
Testing acc: 0.672379032258
Epoch 81
20 / 28 : loss = 1.37971496582Training loss: 1.28313064575
Training acc: 0.650669642857
Validation acc: 0.75
Epoch 82
20 / 28 : loss = 1.27006292343Training loss: 1.23332428932
Training acc: 0.676339285714
Validation acc: 0.697916666667
Epoch 83
20 / 28 : loss = 1.40051996708Training loss: 1.32002830505
Training acc: 0.674107142857
Validation acc: 0.71875
Epoch 84
20 / 28 : loss = 1.047132849697Training loss: 1.06909048557
Training acc: 0.719866071429
Validation acc: 0.802083333333
Epoch 85
20 / 28 : loss = 1.07877969742Training loss: 1.13268876076
Training acc: 0.698660714286
Validation acc: 0.875
Epoch 86
Training loss: 1.1473003625977
Training acc: 0.680803571429
Validation acc: 0.625
Epoch 87
20 / 28 : loss = 1.17495405674Training loss: 1.37745988369
Training acc: 0.65625
Validation acc: 0.625
Epoch 88
Training loss: 1.4722235202827
Training acc: 0.583705357143
Validation acc: 0.510416666667
Epoch 89
20 / 28 : loss = 1.25625622272Training loss: 1.22889685631
Training acc: 0.661830357143
Validation acc: 0.5625
Epoch 90
Training loss: 1.2089560031998
Training acc: 0.661830357143
Validation acc: 0.572916666667
Epoch 91
20 / 28 : loss = 1.21168196201Training loss: 1.19993293285
Training acc: 0.698660714286
Validation acc: 0.65625
Epoch 92
20 / 28 : loss = 1.19797110558Training loss: 1.30339622498
Training acc: 0.661830357143
Validation acc: 0.75
Epoch 93
20 / 28 : loss = 1.15107691288Training loss: 1.10346519947
Training acc: 0.720982142857
Validation acc: 0.708333333333
Epoch 94
20 / 28 : loss = 1.27862012386Training loss: 1.25066924095
Training acc: 0.6875
Validation acc: 0.75
Epoch 95
20 / 28 : loss = 1.12175953388Training loss: 1.11556363106
Training acc: 0.708705357143
Validation acc: 0.791666666667
Epoch 96
20 / 28 : loss = 1.15749919415Training loss: 1.11305832863
Training acc: 0.729910714286
Validation acc: 0.84375
Epoch 97
20 / 28 : loss = 0.999071002007Training loss: 0.969102442265
Training acc: 0.748883928571
Validation acc: 0.78125
Epoch 98
20 / 28 : loss = 1.05927228928Training loss: 1.08468973637
Training acc: 0.724330357143
Validation acc: 0.697916666667
Epoch 99
20 / 28 : loss = 1.06035745144Training loss: 1.01423227787
Training acc: 0.745535714286
Validation acc: 0.739583333333

**************************************

qa8_lists-sets
vocab = [u'.', u'?', u'Daniel', u'John', u'Mary', u'Sandra', u'What', u'apple', u'apple,football', u'apple,football,milk', u'apple,milk', u'apple,milk,football', u'back', u'bathroom', u'bedroom', u'carrying', u'discarded', u'down', u'dropped', u'football', u'football,apple', u'football,apple,milk', u'football,milk', u'garden', u'got', u'grabbed', u'hallway', u'is', u'journeyed', u'kitchen', u'left', u'milk', u'milk,apple', u'milk,football', u'milk,football,apple', u'moved', u'nothing', u'office', u'picked', u'put', u'the', u'there', u'to', u'took', u'travelled', u'up', u'went']
word_idx = {u'What': 7, u'apple': 8, u'office': 38, u'apple,milk,football': 12, u'is': 28, u'moved': 36, u'back': 13, u'down': 18, u'put': 40, u'Daniel': 3, u'dropped': 19, u'picked': 39, u'bedroom': 15, u'John': 4, u'Mary': 5, u'garden': 24, u'bathroom': 14, u'grabbed': 26, u'there': 42, u'milk': 32, u'.': 1, u'to': 43, u'milk,football': 34, u'apple,football,milk': 10, u'got': 25, u'travelled': 45, u'milk,apple': 33, u'?': 2, u'apple,football': 9, u'football,milk': 23, u'football': 20, u'took': 44, u'football,apple,milk': 22, u'hallway': 27, u'carrying': 16, u'nothing': 37, u'milk,football,apple': 35, u'went': 47, u'kitchen': 30, u'Sandra': 6, u'journeyed': 29, u'football,apple': 21, u'up': 46, u'apple,milk': 11, u'discarded': 17, u'the': 41, u'left': 31}
X.shape = (1000, 58, 7)
Xq.shape = (1000, 5)
Y.shape = (1000, 48)
story_maxlen, sentence_maxlen, query_maxlen = 58, 7, 5
max_epochs = 100
Epoch 0
20 / 28 : loss = 11.2949447632Training loss: 9.30146121979
Training acc: 0.256696428571
Validation acc: 0.375
Testing acc: 0.365927419355
Epoch 1
20 / 28 : loss = 3.00287532806Training loss: 3.0393383503
Training acc: 0.268973214286
Validation acc: 0.1875
Epoch 2
20 / 28 : loss = 2.85044312477Training loss: 2.77166485786
Training acc: 0.280133928571
Validation acc: 0.208333333333
Epoch 3
20 / 28 : loss = 2.69369888306Training loss: 2.65739011765
Training acc: 0.28125
Validation acc: 0.197916666667
Epoch 4
20 / 28 : loss = 2.62569761276Training loss: 2.5459125042
Training acc: 0.293526785714
Validation acc: 0.208333333333
Epoch 5
20 / 28 : loss = 2.43376040459Training loss: 2.41798567772
Training acc: 0.283482142857
Validation acc: 0.354166666667
Epoch 6
Training loss: 2.3989634513909
Training acc: 0.311383928571
Validation acc: 0.427083333333
Epoch 7
Training loss: 2.3386726379415
Training acc: 0.306919642857
Validation acc: 0.447916666667
Epoch 8
Training loss: 2.2382171154872
Training acc: 0.341517857143
Validation acc: 0.229166666667
Epoch 9
20 / 28 : loss = 2.18656587601Training loss: 2.1807281971
Training acc: 0.338169642857
Validation acc: 0.291666666667
Epoch 10
20 / 28 : loss = 2.12253165245Training loss: 2.14287829399
Training acc: 0.315848214286
Validation acc: 0.385416666667
Epoch 11
20 / 28 : loss = 2.02847671509Training loss: 2.10186386108
Training acc: 0.344866071429
Validation acc: 0.385416666667
Epoch 12
20 / 28 : loss = 2.0021045208Training loss: 2.03085160255
Training acc: 0.359375
Validation acc: 0.364583333333
Epoch 13
20 / 28 : loss = 2.03045678139Training loss: 1.99069297314
Training acc: 0.366071428571
Validation acc: 0.427083333333
Epoch 14
20 / 28 : loss = 2.01580524445Training loss: 1.93547689915
Training acc: 0.379464285714
Validation acc: 0.541666666667
Epoch 15
20 / 28 : loss = 1.86743378639Training loss: 1.90404891968
Training acc: 0.410714285714
Validation acc: 0.34375
Epoch 16
20 / 28 : loss = 1.83142852783Training loss: 1.79521489143
Training acc: 0.453125
Validation acc: 0.40625
Epoch 17
Training loss: 1.6071361303395
Training acc: 0.5390625
Validation acc: 0.604166666667
Epoch 18
Training loss: 1.5968638658511
Training acc: 0.608258928571
Validation acc: 0.791666666667
Epoch 19
20 / 28 : loss = 1.35168457031Training loss: 1.3444904089
Training acc: 0.697544642857
Validation acc: 0.791666666667
Epoch 20
20 / 28 : loss = 1.10366725922Training loss: 1.14026486874
Training acc: 0.774553571429
Validation acc: 0.770833333333
Testing acc: 0.738911290323
Epoch 21
20 / 28 : loss = 0.999284207821Training loss: 1.01406705379
Training acc: 0.787946428571
Validation acc: 0.666666666667
Epoch 22
20 / 28 : loss = 0.962788105011Training loss: 0.958109974861
Training acc: 0.795758928571
Validation acc: 0.708333333333
Epoch 23
20 / 28 : loss = 0.941450238228Training loss: 0.927670776844
Training acc: 0.792410714286
Validation acc: 0.635416666667
Epoch 24
Training loss: 0.91427838802388
Training acc: 0.777901785714
Validation acc: 0.864583333333
Epoch 25
Training loss: 0.87959510088821
Training acc: 0.786830357143
Validation acc: 0.78125
Epoch 26
20 / 28 : loss = 0.840651094913Training loss: 0.816153109074
Training acc: 0.805803571429
Validation acc: 0.697916666667
Epoch 27
Training loss: 0.84186780452721
Training acc: 0.782366071429
Validation acc: 0.864583333333
Epoch 28
Training loss: 0.83507812023264
Training acc: 0.7890625
Validation acc: 0.458333333333
Epoch 29
20 / 28 : loss = 0.903849363327Training loss: 0.85375058651
Training acc: 0.779017857143
Validation acc: 0.8125
Epoch 30
20 / 28 : loss = 0.789753615856Training loss: 0.787058651447
Training acc: 0.801339285714
Validation acc: 0.854166666667
Epoch 31
20 / 28 : loss = 0.727287173271Training loss: 0.760845720768
Training acc: 0.797991071429
Validation acc: 0.802083333333
Epoch 32
20 / 28 : loss = 0.761176943779Training loss: 0.751417636871
Training acc: 0.806919642857
Validation acc: 0.822916666667
Epoch 33
20 / 28 : loss = 0.711092829704Training loss: 0.7448092103
Training acc: 0.794642857143
Validation acc: 0.864583333333
Epoch 34
20 / 28 : loss = 0.68218266964Training loss: 0.718887925148
Training acc: 0.823660714286
Validation acc: 0.75
Epoch 35
20 / 28 : loss = 0.723713099957Training loss: 0.723167598248
Training acc: 0.809151785714
Validation acc: 0.75
Epoch 36
20 / 28 : loss = 0.74372202158Training loss: 0.743342220783
Training acc: 0.792410714286
Validation acc: 0.854166666667
Epoch 37
20 / 28 : loss = 0.735211849213Training loss: 0.734769225121
Training acc: 0.815848214286
Validation acc: 0.916666666667
Epoch 38
Training loss: 0.68751245737142
Training acc: 0.809151785714
Validation acc: 0.885416666667
Epoch 39
Training loss: 0.68997812271192
Training acc: 0.819196428571
Validation acc: 0.864583333333
Epoch 40
20 / 28 : loss = 0.663306534291Training loss: 0.666557908058
Training acc: 0.837053571429
Validation acc: 0.770833333333
Testing acc: 0.76310483871
Epoch 41
20 / 28 : loss = 0.648809552193Training loss: 0.659079730511
Training acc: 0.8203125
Validation acc: 0.739583333333
Epoch 42
Training loss: 0.66133338213804
Training acc: 0.830357142857
Validation acc: 0.875
Epoch 43
20 / 28 : loss = 0.700650095946Training loss: 0.684631764889
Training acc: 0.808035714286
Validation acc: 0.8125
Epoch 44
20 / 28 : loss = 0.647400736809Training loss: 0.657355248928
Training acc: 0.832589285714
Validation acc: 0.916666666667
Epoch 45
Training loss: 0.70010298490518
Training acc: 0.823660714286
Validation acc: 0.864583333333
Epoch 46
20 / 28 : loss = 0.65772330761Training loss: 0.652264416218
Training acc: 0.829241071429
Validation acc: 0.833333333333
Epoch 47
20 / 28 : loss = 0.632087945938Training loss: 0.636505007744
Training acc: 0.834821428571
Validation acc: 0.958333333333
Epoch 48
Training loss: 0.60296428203609
Training acc: 0.862723214286
Validation acc: 0.854166666667
Epoch 49
Training loss: 0.62477785348902
Training acc: 0.849330357143
Validation acc: 0.802083333333
Epoch 50
Training loss: 0.64244401454918
Training acc: 0.837053571429
Validation acc: 0.864583333333
Epoch 51
Training loss: 0.60071808099754
Training acc: 0.864955357143
Validation acc: 0.822916666667
Epoch 52
Training loss: 0.62411868572264
Training acc: 0.8515625
Validation acc: 0.90625
Epoch 53
20 / 28 : loss = 0.616140067577Training loss: 0.620273590088
Training acc: 0.845982142857
Validation acc: 0.8125
Epoch 54
20 / 28 : loss = 0.594736218452Training loss: 0.594621479511
Training acc: 0.862723214286
Validation acc: 0.802083333333
Epoch 55
20 / 28 : loss = 0.539805293083Training loss: 0.584542274475
Training acc: 0.870535714286
Validation acc: 0.822916666667
Epoch 56
20 / 28 : loss = 0.605659484863Training loss: 0.597856581211
Training acc: 0.861607142857
Validation acc: 0.90625
Epoch 57
Training loss: 0.55119526386311
Training acc: 0.895089285714
Validation acc: 0.833333333333
Epoch 58
20 / 28 : loss = 0.562623143196Training loss: 0.566374182701
Training acc: 0.878348214286
Validation acc: 0.9375
Epoch 59
20 / 28 : loss = 0.551275134087Training loss: 0.558959305286
Training acc: 0.885044642857
Validation acc: 0.854166666667
Epoch 60
20 / 28 : loss = 0.533181667328Training loss: 0.572585403919
Training acc: 0.873883928571
Validation acc: 0.854166666667
Testing acc: 0.720766129032
Epoch 61
20 / 28 : loss = 0.554429471493Training loss: 0.55593007803
Training acc: 0.895089285714
Validation acc: 0.90625
Epoch 62
20 / 28 : loss = 0.496505826712Training loss: 0.54092502594
Training acc: 0.896205357143
Validation acc: 0.895833333333
Epoch 63
20 / 28 : loss = 0.556977927685Training loss: 0.56689864397
Training acc: 0.891741071429
Validation acc: 0.90625
Epoch 64
Training loss: 0.55903953313825
Training acc: 0.895089285714
Validation acc: 0.916666666667
Epoch 65
Training loss: 0.56206780672168
Training acc: 0.879464285714
Validation acc: 0.833333333333
Epoch 66
20 / 28 : loss = 0.568498313427Training loss: 0.581212580204
Training acc: 0.873883928571
Validation acc: 0.875
Epoch 67
20 / 28 : loss = 0.587439537048Training loss: 0.568531394005
Training acc: 0.891741071429
Validation acc: 0.947916666667
Epoch 68
20 / 28 : loss = 0.514782488346Training loss: 0.521309912205
Training acc: 0.901785714286
Validation acc: 0.90625
Epoch 69
20 / 28 : loss = 0.497866451742Training loss: 0.511916339397
Training acc: 0.912946428571
Validation acc: 0.895833333333
Epoch 70
20 / 28 : loss = 0.507520854473Training loss: 0.505276441574
Training acc: 0.909598214286
Validation acc: 0.958333333333
Epoch 71
20 / 28 : loss = 0.479071170092Training loss: 0.49423211813
Training acc: 0.919642857143
Validation acc: 0.9375
Epoch 72
Training loss: 0.47418043017483
Training acc: 0.931919642857
Validation acc: 0.9375
Epoch 73
20 / 28 : loss = 0.584484398365Training loss: 0.590637087822
Training acc: 0.875
Validation acc: 0.90625
Epoch 74
20 / 28 : loss = 0.486958086491Training loss: 0.506316363811
Training acc: 0.916294642857
Validation acc: 0.895833333333
Epoch 75
20 / 28 : loss = 0.480975598097Training loss: 0.479089766741
Training acc: 0.9296875
Validation acc: 0.927083333333
Epoch 76
20 / 28 : loss = 0.501257300377Training loss: 0.5178617239
Training acc: 0.926339285714
Validation acc: 0.90625
Epoch 77
Training loss: 0.48325023055149
Training acc: 0.9375
Validation acc: 0.958333333333
Epoch 78
20 / 28 : loss = 0.491939276457Training loss: 0.496697574854
Training acc: 0.924107142857
Validation acc: 0.958333333333
Epoch 79
20 / 28 : loss = 0.513591408739Training loss: 0.50986546278
Training acc: 0.9140625
Validation acc: 0.9375
Epoch 80
20 / 28 : loss = 0.481683045626Training loss: 0.499027907848
Training acc: 0.935267857143
Validation acc: 0.927083333333
Testing acc: 0.748991935484
Epoch 81
20 / 28 : loss = 0.526153266432Training loss: 0.505217790604
Training acc: 0.926339285714
Validation acc: 0.927083333333
Epoch 82
20 / 28 : loss = 0.489316999912Training loss: 0.507909417152
Training acc: 0.920758928571
Validation acc: 0.958333333333
Epoch 83
20 / 28 : loss = 0.485273778439Training loss: 0.489714950323
Training acc: 0.930803571429
Validation acc: 0.9375
Epoch 84
20 / 28 : loss = 0.475324124098Training loss: 0.482253342867
Training acc: 0.933035714286
Validation acc: 0.9375
Epoch 85
Training loss: 0.46496793627798
Training acc: 0.9453125
Validation acc: 0.791666666667
Epoch 86
20 / 28 : loss = 0.554969310765Training loss: 0.548447191715
Training acc: 0.910714285714
Validation acc: 0.979166666667
Epoch 87
20 / 28 : loss = 0.448274791241Training loss: 0.448310643435
Training acc: 0.959821428571
Validation acc: 0.979166666667
Epoch 88
20 / 28 : loss = 0.457524210215Training loss: 0.459887892008
Training acc: 0.943080357143
Validation acc: 0.947916666667
Epoch 89
Training loss: 0.45306590199537
Training acc: 0.948660714286
Validation acc: 0.947916666667
Epoch 90
20 / 28 : loss = 0.433117538691Training loss: 0.441067516804
Training acc: 0.950892857143
Validation acc: 0.958333333333
Epoch 91
20 / 28 : loss = 0.436127573252Training loss: 0.429962486029
Training acc: 0.952008928571
Validation acc: 0.979166666667
Epoch 92
20 / 28 : loss = 0.487381577492Training loss: 0.554489672184
Training acc: 0.90625
Validation acc: 0.854166666667
Epoch 93
20 / 28 : loss = 0.559154927731Training loss: 0.547000646591
Training acc: 0.922991071429
Validation acc: 0.916666666667
Epoch 94
20 / 28 : loss = 0.462272107601Training loss: 0.459906041622
Training acc: 0.941964285714
Validation acc: 0.979166666667
Epoch 95
20 / 28 : loss = 0.451923698187Training loss: 0.450547486544
Training acc: 0.956473214286
Validation acc: 0.989583333333
Epoch 96
Training loss: 0.41579541564776
Training acc: 0.969866071429
Validation acc: 0.979166666667
Epoch 97
20 / 28 : loss = 0.430430263281Training loss: 0.43534591794
Training acc: 0.955357142857
Validation acc: 0.958333333333
Epoch 98
20 / 28 : loss = 0.413430750377Training loss: 0.437845766544
Training acc: 0.947544642857
Validation acc: 0.958333333333
Epoch 99
Training loss: 0.46385154128199
Training acc: 0.946428571429
Validation acc: 0.979166666667

**************************************

qa9_simple-negation
vocab = [u'.', u'?', u'Daniel', u'Is', u'John', u'Mary', u'Sandra', u'back', u'bathroom', u'bedroom', u'garden', u'hallway', u'in', u'is', u'journeyed', u'kitchen', u'longer', u'moved', u'no', u'not', u'office', u'the', u'to', u'travelled', u'went', u'yes']
word_idx = {u'office': 21, u'is': 14, u'bedroom': 10, u'moved': 18, u'back': 8, u'Daniel': 3, u'in': 13, u'yes': 26, u'John': 5, u'Mary': 6, u'bathroom': 9, u'no': 19, u'.': 1, u'to': 23, u'Sandra': 7, u'travelled': 24, u'?': 2, u'hallway': 12, u'garden': 11, u'not': 20, u'went': 25, u'kitchen': 16, u'longer': 17, u'journeyed': 15, u'Is': 4, u'the': 22}
X.shape = (1000, 10, 8)
Xq.shape = (1000, 6)
Y.shape = (1000, 27)
story_maxlen, sentence_maxlen, query_maxlen = 10, 8, 6
max_epochs = 100
Epoch 0
Training loss: 25.638793945354
Training acc: 0.524553571429
Validation acc: 0.53125
Testing acc: 0.637096774194
Epoch 1
Training loss: 11.194720268266
Training acc: 0.549107142857
Validation acc: 0.53125
Epoch 2
Training loss: 8.8236055374107
Training acc: 0.546875
Validation acc: 0.677083333333
Epoch 3
Training loss: 6.8079376220741
Training acc: 0.5625
Validation acc: 0.395833333333
Epoch 4
20 / 28 : loss = 7.20113277435Training loss: 6.84513998032
Training acc: 0.525669642857
Validation acc: 0.635416666667
Epoch 5
20 / 28 : loss = 5.46702384949Training loss: 5.34890651703
Training acc: 0.536830357143
Validation acc: 0.645833333333
Epoch 6
20 / 28 : loss = 5.39297866821Training loss: 5.81608295441
Training acc: 0.524553571429
Validation acc: 0.677083333333
Epoch 7
20 / 28 : loss = 5.34821939468Training loss: 5.45339202881
Training acc: 0.5234375
Validation acc: 0.760416666667
Epoch 8
20 / 28 : loss = 4.60780096054Training loss: 4.48448038101
Training acc: 0.530133928571
Validation acc: 0.572916666667
Epoch 9
20 / 28 : loss = 3.93674468994Training loss: 4.21277666092
Training acc: 0.565848214286
Validation acc: 0.291666666667
Epoch 10
20 / 28 : loss = 4.55460977554Training loss: 4.26275587082
Training acc: 0.537946428571
Validation acc: 0.677083333333
Epoch 11
20 / 28 : loss = 3.63297891617Training loss: 3.72365021706
Training acc: 0.537946428571
Validation acc: 0.34375
Epoch 12
Training loss: 4.2942080497798
Training acc: 0.524553571429
Validation acc: 0.520833333333
Epoch 13
Training loss: 3.9986522197763
Training acc: 0.505580357143
Validation acc: 0.614583333333
Epoch 14
20 / 28 : loss = 3.65556907654Training loss: 3.53926897049
Training acc: 0.5390625
Validation acc: 0.395833333333
Epoch 15
Training loss: 3.3342993259421
Training acc: 0.525669642857
Validation acc: 0.625
Epoch 16
20 / 28 : loss = 2.46643042564Training loss: 2.57423615456
Training acc: 0.564732142857
Validation acc: 0.541666666667
Epoch 17
20 / 28 : loss = 2.80580687523Training loss: 2.97931098938
Training acc: 0.521205357143
Validation acc: 0.65625
Epoch 18
20 / 28 : loss = 3.02918672562Training loss: 2.78930902481
Training acc: 0.533482142857
Validation acc: 0.375
Epoch 19
Training loss: 2.8730623722119
Training acc: 0.545758928571
Validation acc: 0.614583333333
Epoch 20
20 / 28 : loss = 2.79916930199Training loss: 2.5271832943
Training acc: 0.514508928571
Validation acc: 0.635416666667
Testing acc: 0.637096774194
Epoch 21
Training loss: 2.5371568203001
Training acc: 0.534598214286
Validation acc: 0.572916666667
Epoch 22
20 / 28 : loss = 2.62779450417Training loss: 2.59805893898
Training acc: 0.5234375
Validation acc: 0.614583333333
Epoch 23
20 / 28 : loss = 2.87925219536Training loss: 2.80899786949
Training acc: 0.516741071429
Validation acc: 0.375
Epoch 24
Training loss: 2.7569460868879
Training acc: 0.506696428571
Validation acc: 0.59375
Epoch 25
20 / 28 : loss = 2.25726509094Training loss: 2.18107938766
Training acc: 0.5390625
Validation acc: 0.34375
Epoch 26
Training loss: 2.2288086414315
Training acc: 0.551339285714
Validation acc: 0.59375
Epoch 27
20 / 28 : loss = 1.99626886845Training loss: 2.15281176567
Training acc: 0.534598214286
Validation acc: 0.625
Epoch 28
Training loss: 2.0913083553394
Training acc: 0.537946428571
Validation acc: 0.270833333333
Epoch 29
Training loss: 2.2025551796075
Training acc: 0.514508928571
Validation acc: 0.552083333333
Epoch 30
Training loss: 1.7280126810147
Training acc: 0.571428571429
Validation acc: 0.333333333333
Epoch 31
Training loss: 2.2609512805979
Training acc: 0.526785714286
Validation acc: 0.375
Epoch 32
Training loss: 2.2557847499848
Training acc: 0.506696428571
Validation acc: 0.3125
Epoch 33
20 / 28 : loss = 1.85470890999Training loss: 1.75183391571
Training acc: 0.546875
Validation acc: 0.729166666667
Epoch 34
20 / 28 : loss = 1.96148431301Training loss: 1.98882114887
Training acc: 0.512276785714
Validation acc: 0.520833333333
Epoch 35
20 / 28 : loss = 1.93483006954Training loss: 1.91656839848
Training acc: 0.522321428571
Validation acc: 0.635416666667
Epoch 36
20 / 28 : loss = 1.53380179405Training loss: 1.88671243191
Training acc: 0.558035714286
Validation acc: 0.375
Epoch 37
20 / 28 : loss = 1.91023385525Training loss: 1.73296201229
Training acc: 0.542410714286
Validation acc: 0.458333333333
Epoch 38
20 / 28 : loss = 1.55706679821Training loss: 1.62528204918
Training acc: 0.545758928571
Validation acc: 0.375
Epoch 39
Training loss: 1.7334717512176
Training acc: 0.522321428571
Validation acc: 0.552083333333
Epoch 40
Training loss: 1.7487802505522
Training acc: 0.545758928571
Validation acc: 0.541666666667
Testing acc: 0.637096774194
Epoch 41
Training loss: 1.7462265491552
Training acc: 0.516741071429
Validation acc: 0.302083333333
Epoch 42
20 / 28 : loss = 2.01338148117Training loss: 2.03925299644
Training acc: 0.511160714286
Validation acc: 0.65625
Epoch 43
Training loss: 1.5493427515195
Training acc: 0.5390625
Validation acc: 0.635416666667
Epoch 44
Training loss: 1.7009403705608
Training acc: 0.514508928571
Validation acc: 0.697916666667
Epoch 45
20 / 28 : loss = 1.70372331142Training loss: 1.67267501354
Training acc: 0.565848214286
Validation acc: 0.572916666667
Epoch 46
Training loss: 1.4414738416747
Training acc: 0.559151785714
Validation acc: 0.666666666667
Epoch 47
20 / 28 : loss = 1.64856755733Training loss: 1.83994615078
Training acc: 0.524553571429
Validation acc: 0.708333333333
Epoch 48
Training loss: 1.6005194187207
Training acc: 0.536830357143
Validation acc: 0.71875
Epoch 49
Training loss: 1.7278450727583
Training acc: 0.541294642857
Validation acc: 0.333333333333
Epoch 50
20 / 28 : loss = 1.43503808975Training loss: 1.4242579937
Training acc: 0.550223214286
Validation acc: 0.604166666667
Epoch 51
20 / 28 : loss = 1.57658207417Training loss: 1.57873702049
Training acc: 0.517857142857
Validation acc: 0.59375
Epoch 52
20 / 28 : loss = 1.36440479755Training loss: 1.46499848366
Training acc: 0.5625
Validation acc: 0.614583333333
Epoch 53
20 / 28 : loss = 1.38322162628Training loss: 1.4503070116
Training acc: 0.552455357143
Validation acc: 0.604166666667
Epoch 54
Training loss: 1.6301790475842
Training acc: 0.517857142857
Validation acc: 0.645833333333
Epoch 55
20 / 28 : loss = 1.41510546207Training loss: 1.33308720589
Training acc: 0.542410714286
Validation acc: 0.666666666667
Epoch 56
Training loss: 1.4295667409944
Training acc: 0.555803571429
Validation acc: 0.5625
Epoch 57
Training loss: 1.3597191572243
Training acc: 0.5546875
Validation acc: 0.59375
Epoch 58
20 / 28 : loss = 1.36252331734Training loss: 1.37550127506
Training acc: 0.553571428571
Validation acc: 0.40625
Epoch 59
20 / 28 : loss = 1.49839687347Training loss: 1.54251265526
Training acc: 0.512276785714
Validation acc: 0.3125
Epoch 60
Training loss: 1.5661147832946
Training acc: 0.504464285714
Validation acc: 0.375
Testing acc: 0.381048387097
Epoch 61
Training loss: 1.2351006269587
Training acc: 0.563616071429
Validation acc: 0.635416666667
Epoch 62
Training loss: 1.2951012849843
Training acc: 0.559151785714
Validation acc: 0.614583333333
Epoch 63
Training loss: 1.3336311578823
Training acc: 0.524553571429
Validation acc: 0.479166666667
Epoch 64
20 / 28 : loss = 1.34523832798Training loss: 1.2440392971
Training acc: 0.542410714286
Validation acc: 0.614583333333
Epoch 65
Training loss: 1.3251100778624
Training acc: 0.520089285714
Validation acc: 0.541666666667
Epoch 66
20 / 28 : loss = 1.38483834267Training loss: 1.31413769722
Training acc: 0.5390625
Validation acc: 0.635416666667
Epoch 67
20 / 28 : loss = 1.15612626076Training loss: 1.21060526371
Training acc: 0.561383928571
Validation acc: 0.625
Epoch 68
Training loss: 1.2121018171373
Training acc: 0.571428571429
Validation acc: 0.395833333333
Epoch 69
20 / 28 : loss = 1.24924945831Training loss: 1.2991181612
Training acc: 0.540178571429
Validation acc: 0.739583333333
Epoch 70
20 / 28 : loss = 1.48304569721Training loss: 1.41650354862
Training acc: 0.53125
Validation acc: 0.65625
Epoch 71
20 / 28 : loss = 1.39589715004Training loss: 1.30259859562
Training acc: 0.524553571429
Validation acc: 0.354166666667
Epoch 72
20 / 28 : loss = 1.26379477978Training loss: 1.26552176476
Training acc: 0.540178571429
Validation acc: 0.645833333333
Epoch 73
Training loss: 1.2124153375652
Training acc: 0.547991071429
Validation acc: 0.71875
Epoch 74
Training loss: 1.1632710695321
Training acc: 0.545758928571
Validation acc: 0.625
Epoch 75
20 / 28 : loss = 1.47968924046Training loss: 1.35608804226
Training acc: 0.526785714286
Validation acc: 0.71875
Epoch 76
20 / 28 : loss = 1.19712746143Training loss: 1.25028264523
Training acc: 0.5546875
Validation acc: 0.666666666667
Epoch 77
Training loss: 1.3038825988833
Training acc: 0.530133928571
Validation acc: 0.385416666667
Epoch 78
20 / 28 : loss = 1.30092906952Training loss: 1.32488536835
Training acc: 0.53125
Validation acc: 0.59375
Epoch 79
20 / 28 : loss = 1.43333494663Training loss: 1.35218214989
Training acc: 0.550223214286
Validation acc: 0.5625
Epoch 80
Training loss: 1.03649532795698
Training acc: 0.574776785714
Validation acc: 0.604166666667
Testing acc: 0.634072580645
Epoch 81
Training loss: 1.2129983902318
Training acc: 0.546875
Validation acc: 0.729166666667
Epoch 82
20 / 28 : loss = 1.1264487505Training loss: 1.12140595913
Training acc: 0.555803571429
Validation acc: 0.625
Epoch 83
20 / 28 : loss = 1.30311584473Training loss: 1.33160674572
Training acc: 0.546875
Validation acc: 0.354166666667
Epoch 84
20 / 28 : loss = 1.034998536112Training loss: 1.05452728271
Training acc: 0.5546875
Validation acc: 0.625
Epoch 85
20 / 28 : loss = 1.00867938995Training loss: 1.14078652859
Training acc: 0.565848214286
Validation acc: 0.4375
Epoch 86
20 / 28 : loss = 1.18418741226Training loss: 1.07809877396
Training acc: 0.577008928571
Validation acc: 0.625
Epoch 87
20 / 28 : loss = 0.948783576488Training loss: 0.975499808788
Training acc: 0.603794642857
Validation acc: 0.5
Epoch 88
20 / 28 : loss = 1.146554231644Training loss: 1.13133382797
Training acc: 0.563616071429
Validation acc: 0.333333333333
Epoch 89
20 / 28 : loss = 1.02354478836Training loss: 1.09237515926
Training acc: 0.575892857143
Validation acc: 0.395833333333
Epoch 90
Training loss: 1.05232608318858
Training acc: 0.584821428571
Validation acc: 0.666666666667
Epoch 91
Training loss: 1.0653771162472
Training acc: 0.560267857143
Validation acc: 0.375
Epoch 92
Training loss: 1.1074917316433
Training acc: 0.573660714286
Validation acc: 0.59375
Epoch 93
Training loss: 1.0244427919453
Training acc: 0.565848214286
Validation acc: 0.416666666667
Epoch 94
20 / 28 : loss = 1.15058648586Training loss: 1.05625927448
Training acc: 0.558035714286
Validation acc: 0.614583333333
Epoch 95
20 / 28 : loss = 0.992708921432Training loss: 1.04020035267
Training acc: 0.572544642857
Validation acc: 0.583333333333
Epoch 96
Training loss: 1.09763920307997
Training acc: 0.559151785714
Validation acc: 0.583333333333
Epoch 97
Training loss: 0.99941015243571
Training acc: 0.566964285714
Validation acc: 0.40625
Epoch 98
20 / 28 : loss = 0.94042634964Training loss: 0.968399167061
Training acc: 0.556919642857
Validation acc: 0.34375
Epoch 99
20 / 28 : loss = 1.10211575031Training loss: 1.08274996281
Training acc: 0.546875
Validation acc: 0.614583333333

**************************************

qa10_indefinite-knowledge
vocab = [u'.', u'?', u'Bill', u'Fred', u'Is', u'Julie', u'Mary', u'back', u'bedroom', u'cinema', u'either', u'in', u'is', u'journeyed', u'kitchen', u'maybe', u'moved', u'no', u'office', u'or', u'park', u'school', u'the', u'to', u'travelled', u'went', u'yes']
word_idx = {u'office': 19, u'cinema': 10, u'is': 13, u'bedroom': 9, u'moved': 17, u'back': 8, u'in': 12, u'yes': 27, u'.': 1, u'Mary': 7, u'no': 18, u'Fred': 4, u'to': 24, u'travelled': 25, u'?': 2, u'Bill': 3, u'park': 21, u'went': 26, u'kitchen': 15, u'Julie': 6, u'school': 22, u'journeyed': 14, u'maybe': 16, u'Is': 5, u'either': 11, u'the': 23, u'or': 20}
X.shape = (1000, 10, 10)
Xq.shape = (1000, 6)
Y.shape = (1000, 28)
story_maxlen, sentence_maxlen, query_maxlen = 10, 10, 6
max_epochs = 100
Epoch 0
Training loss: 10.818052291959
Training acc: 0.424107142857
Validation acc: 0.583333333333
Testing acc: 0.425403225806
Epoch 1
Training loss: 2.1197123527504
Training acc: 0.441964285714
Validation acc: 0.520833333333
Epoch 2
Training loss: 2.0063927173653
Training acc: 0.438616071429
Validation acc: 0.479166666667
Epoch 3
Training loss: 1.8813186883974
Training acc: 0.459821428571
Validation acc: 0.489583333333
Epoch 4
20 / 28 : loss = 1.80480825901Training loss: 1.80167615414
Training acc: 0.440848214286
Validation acc: 0.427083333333
Epoch 5
20 / 28 : loss = 1.70534265041Training loss: 1.72521853447
Training acc: 0.444196428571
Validation acc: 0.447916666667
Epoch 6
20 / 28 : loss = 1.66298961639Training loss: 1.64590537548
Training acc: 0.453125
Validation acc: 0.46875
Epoch 7
20 / 28 : loss = 1.59480226045Training loss: 1.57715642452
Training acc: 0.453125
Validation acc: 0.46875
Epoch 8
20 / 28 : loss = 1.54226577282Training loss: 1.53536248207
Training acc: 0.458705357143
Validation acc: 0.427083333333
Epoch 9
Training loss: 1.4798980951307
Training acc: 0.454241071429
Validation acc: 0.427083333333
Epoch 10
Training loss: 1.4539517164286
Training acc: 0.458705357143
Validation acc: 0.53125
Epoch 11
20 / 28 : loss = 1.40253281593Training loss: 1.39827859402
Training acc: 0.472098214286
Validation acc: 0.46875
Epoch 12
Training loss: 1.3651895523125
Training acc: 0.463169642857
Validation acc: 0.489583333333
Epoch 13
20 / 28 : loss = 1.32846045494Training loss: 1.32525980473
Training acc: 0.462053571429
Validation acc: 0.479166666667
Epoch 14
Training loss: 1.2814586162657
Training acc: 0.4765625
Validation acc: 0.34375
Epoch 15
20 / 28 : loss = 1.32079803944Training loss: 1.29683804512
Training acc: 0.4375
Validation acc: 0.489583333333
Epoch 16
20 / 28 : loss = 1.24362885952Training loss: 1.24317073822
Training acc: 0.477678571429
Validation acc: 0.40625
Epoch 17
Training loss: 1.2373211383824
Training acc: 0.464285714286
Validation acc: 0.489583333333
Epoch 18
20 / 28 : loss = 1.21268403537Training loss: 1.21393656731
Training acc: 0.469866071429
Validation acc: 0.5
Epoch 19
20 / 28 : loss = 1.21143031122Training loss: 1.20619785786
Training acc: 0.4609375
Validation acc: 0.458333333333
Epoch 20
20 / 28 : loss = 1.17838156223Training loss: 1.18536829948
Training acc: 0.467633928571
Validation acc: 0.479166666667
Testing acc: 0.470766129032
Epoch 21
Training loss: 1.1669346094162
Training acc: 0.473214285714
Validation acc: 0.510416666667
Epoch 22
Training loss: 1.1437982320885
Training acc: 0.46875
Validation acc: 0.416666666667
Epoch 23
20 / 28 : loss = 1.15352916718Training loss: 1.14453721046
Training acc: 0.46875
Validation acc: 0.458333333333
Epoch 24
20 / 28 : loss = 1.11156606674Training loss: 1.11224687099
Training acc: 0.477678571429
Validation acc: 0.5
Epoch 25
20 / 28 : loss = 1.10328161716Training loss: 1.11430740356
Training acc: 0.455357142857
Validation acc: 0.458333333333
Epoch 26
20 / 28 : loss = 1.10242021084Training loss: 1.09094083309
Training acc: 0.479910714286
Validation acc: 0.4375
Epoch 27
20 / 28 : loss = 1.08592259884Training loss: 1.09308922291
Training acc: 0.446428571429
Validation acc: 0.541666666667
Epoch 28
20 / 28 : loss = 1.07887101173Training loss: 1.09201085567
Training acc: 0.469866071429
Validation acc: 0.4375
Epoch 29
20 / 28 : loss = 1.08763527875Training loss: 1.07718110085
Training acc: 0.464285714286
Validation acc: 0.5625
Epoch 30
20 / 28 : loss = 1.04751157761Training loss: 1.0531257391
Training acc: 0.475446428571
Validation acc: 0.4375
Epoch 31
20 / 28 : loss = 1.04803073406Training loss: 1.05933785439
Training acc: 0.46875
Validation acc: 0.510416666667
Epoch 32
20 / 28 : loss = 1.06714332104Training loss: 1.06979203224
Training acc: 0.482142857143
Validation acc: 0.46875
Epoch 33
20 / 28 : loss = 1.05027043819Training loss: 1.04873502254
Training acc: 0.475446428571
Validation acc: 0.395833333333
Epoch 34
Training loss: 1.0360800027815
Training acc: 0.477678571429
Validation acc: 0.427083333333
Epoch 35
Training loss: 1.0483170747843
Training acc: 0.459821428571
Validation acc: 0.489583333333
Epoch 36
20 / 28 : loss = 1.02869474888Training loss: 1.02887237072
Training acc: 0.447544642857
Validation acc: 0.447916666667
Epoch 37
Training loss: 1.0208237171237
Training acc: 0.477678571429
Validation acc: 0.510416666667
Epoch 38
Training loss: 1.0247280597763
Training acc: 0.487723214286
Validation acc: 0.520833333333
Epoch 39
20 / 28 : loss = 1.00981545448Training loss: 1.01725316048
Training acc: 0.455357142857
Validation acc: 0.572916666667
Epoch 40
20 / 28 : loss = 0.99108594656Training loss: 1.00113832951
Training acc: 0.485491071429
Validation acc: 0.4375
Testing acc: 0.439516129032
Epoch 41
Training loss: 1.0110875368107
Training acc: 0.474330357143
Validation acc: 0.4375
Epoch 42
Training loss: 1.0065748691674
Training acc: 0.481026785714
Validation acc: 0.40625
Epoch 43
20 / 28 : loss = 1.01921045781Training loss: 1.01568233967
Training acc: 0.4453125
Validation acc: 0.447916666667
Epoch 44
20 / 28 : loss = 0.99217915535Training loss: 1.00004899502
Training acc: 0.481026785714
Validation acc: 0.479166666667
Epoch 45
Training loss: 0.99350517988278
Training acc: 0.463169642857
Validation acc: 0.375
Epoch 46
20 / 28 : loss = 0.997482180595Training loss: 0.984708487988
Training acc: 0.483258928571
Validation acc: 0.489583333333
Epoch 47
20 / 28 : loss = 0.999580264091Training loss: 0.998851835728
Training acc: 0.459821428571
Validation acc: 0.458333333333
Epoch 48
20 / 28 : loss = 0.994996309289Training loss: 0.981224656105
Training acc: 0.495535714286
Validation acc: 0.427083333333
Epoch 49
20 / 28 : loss = 1.001069068914Training loss: 0.980097591877
Training acc: 0.470982142857
Validation acc: 0.416666666667
Epoch 50
20 / 28 : loss = 0.953184306622Training loss: 0.973316252232
Training acc: 0.4765625
Validation acc: 0.5
Epoch 51
20 / 28 : loss = 0.972117006779Training loss: 0.966261863708
Training acc: 0.501116071429
Validation acc: 0.458333333333
Epoch 52
20 / 28 : loss = 0.985735952854Training loss: 0.967774689198
Training acc: 0.473214285714
Validation acc: 0.479166666667
Epoch 53
20 / 28 : loss = 0.965471148491Training loss: 0.971792519093
Training acc: 0.475446428571
Validation acc: 0.479166666667
Epoch 54
Training loss: 0.97199046611888
Training acc: 0.469866071429
Validation acc: 0.416666666667
Epoch 55
20 / 28 : loss = 0.979033410549Training loss: 0.986448168755
Training acc: 0.438616071429
Validation acc: 0.489583333333
Epoch 56
Training loss: 0.96731758117776
Training acc: 0.472098214286
Validation acc: 0.416666666667
Epoch 57
20 / 28 : loss = 0.979717791086Training loss: 0.967435181141
Training acc: 0.4921875
Validation acc: 0.541666666667
Epoch 58
20 / 28 : loss = 0.970235109329Training loss: 0.961369872093
Training acc: 0.504464285714
Validation acc: 0.416666666667
Epoch 59
Training loss: 0.96841561794356
Training acc: 0.459821428571
Validation acc: 0.447916666667
Epoch 60
20 / 28 : loss = 0.956862211227Training loss: 0.957175374031
Training acc: 0.4765625
Validation acc: 0.4375
Testing acc: 0.440524193548
Epoch 61
Training loss: 0.94791322946537
Training acc: 0.485491071429
Validation acc: 0.4375
Epoch 62
Training loss: 0.97463637590429
Training acc: 0.474330357143
Validation acc: 0.46875
Epoch 63
20 / 28 : loss = 0.969496667385Training loss: 0.97011834383
Training acc: 0.466517857143
Validation acc: 0.46875
Epoch 64
20 / 28 : loss = 0.937775909901Training loss: 0.948480010033
Training acc: 0.496651785714
Validation acc: 0.479166666667
Epoch 65
Training loss: 0.95029574632609
Training acc: 0.4765625
Validation acc: 0.416666666667
Epoch 66
20 / 28 : loss = 0.954969108105Training loss: 0.952504992485
Training acc: 0.489955357143
Validation acc: 0.375
Epoch 67
20 / 28 : loss = 0.947968542576Training loss: 0.953862547874
Training acc: 0.450892857143
Validation acc: 0.5
Epoch 68
20 / 28 : loss = 0.957422375679Training loss: 0.948049724102
Training acc: 0.484375
Validation acc: 0.510416666667
Epoch 69
20 / 28 : loss = 0.944659709933Training loss: 0.937136292458
Training acc: 0.493303571429
Validation acc: 0.447916666667
Epoch 70
20 / 28 : loss = 0.944613337517Training loss: 0.940535724163
Training acc: 0.488839285714
Validation acc: 0.510416666667
Epoch 71
20 / 28 : loss = 0.972944259644Training loss: 0.96545869112
Training acc: 0.453125
Validation acc: 0.541666666667
Epoch 72
20 / 28 : loss = 0.931464493275Training loss: 0.9446002841
Training acc: 0.486607142857
Validation acc: 0.53125
Epoch 73
Training loss: 0.93907755613333
Training acc: 0.479910714286
Validation acc: 0.520833333333
Epoch 74
Training loss: 0.95215004682506
Training acc: 0.483258928571
Validation acc: 0.53125
Epoch 75
20 / 28 : loss = 0.935308575633Training loss: 0.942073464394
Training acc: 0.477678571429
Validation acc: 0.520833333333
Epoch 76
20 / 28 : loss = 0.932918369773Training loss: 0.941395580769
Training acc: 0.474330357143
Validation acc: 0.510416666667
Epoch 77
Training loss: 0.94031256437381
Training acc: 0.447544642857
Validation acc: 0.479166666667
Epoch 78
Training loss: 0.93706721067488
Training acc: 0.466517857143
Validation acc: 0.458333333333
Epoch 79
Training loss: 0.94440096616712
Training acc: 0.474330357143
Validation acc: 0.40625
Epoch 80
20 / 28 : loss = 0.933548867702Training loss: 0.942521572113
Training acc: 0.491071428571
Validation acc: 0.53125
Testing acc: 0.441532258065
Epoch 81
Training loss: 0.93452805280756
Training acc: 0.497767857143
Validation acc: 0.5
Epoch 82
Training loss: 0.93878275156893
Training acc: 0.479910714286
Validation acc: 0.552083333333
Epoch 83
Training loss: 0.93340688943993
Training acc: 0.491071428571
Validation acc: 0.427083333333
Epoch 84
20 / 28 : loss = 0.927860438824Training loss: 0.941626966
Training acc: 0.479910714286
Validation acc: 0.447916666667
Epoch 85
20 / 28 : loss = 0.929536521435Training loss: 0.933697640896
Training acc: 0.467633928571
Validation acc: 0.40625
Epoch 86
20 / 28 : loss = 0.930521011353Training loss: 0.924056529999
Training acc: 0.483258928571
Validation acc: 0.447916666667
Epoch 87
Training loss: 0.93877583742186
Training acc: 0.4609375
Validation acc: 0.4375
Epoch 88
Training loss: 0.93242770433443
Training acc: 0.482142857143
Validation acc: 0.447916666667
Epoch 89
Training loss: 0.92513114213996
Training acc: 0.462053571429
Validation acc: 0.46875
Epoch 90
Training loss: 0.93135172128798
Training acc: 0.493303571429
Validation acc: 0.458333333333
Epoch 91
20 / 28 : loss = 0.931124210358Training loss: 0.923689007759
Training acc: 0.4921875
Validation acc: 0.458333333333
Epoch 92
20 / 28 : loss = 0.935252964497Training loss: 0.92935782671
Training acc: 0.496651785714
Validation acc: 0.447916666667
Epoch 93
Training loss: 0.92126798629878
Training acc: 0.497767857143
Validation acc: 0.489583333333
Epoch 94
20 / 28 : loss = 0.934258878231Training loss: 0.9226526618
Training acc: 0.4921875
Validation acc: 0.5
Epoch 95
Training loss: 0.92921334505151
Training acc: 0.478794642857
Validation acc: 0.4375
Epoch 96
Training loss: 0.92922991514254
Training acc: 0.473214285714
Validation acc: 0.53125
Epoch 97
20 / 28 : loss = 0.916829884052Training loss: 0.917802155018
Training acc: 0.486607142857
Validation acc: 0.416666666667
Epoch 98
20 / 28 : loss = 0.923576474196Training loss: 0.929072380066
Training acc: 0.463169642857
Validation acc: 0.46875
Epoch 99
20 / 28 : loss = 0.934523165226Training loss: 0.912253916264
Training acc: 0.503348214286
Validation acc: 0.510416666667

**************************************

qa11_basic-coreference
vocab = [u'.', u'?', u'After', u'Afterwards', u'Daniel', u'Following', u'John', u'Mary', u'Sandra', u'Then', u'Where', u'back', u'bathroom', u'bedroom', u'garden', u'hallway', u'he', u'is', u'journeyed', u'kitchen', u'moved', u'office', u'she', u'that', u'the', u'to', u'travelled', u'went']
word_idx = {u'office': 22, u'is': 18, u'moved': 21, u'back': 12, u'Daniel': 5, u'bedroom': 14, u'John': 7, u'Mary': 8, u'Then': 10, u'bathroom': 13, u'After': 3, u'.': 1, u'to': 26, u'Sandra': 9, u'travelled': 27, u'he': 17, u'?': 2, u'hallway': 16, u'garden': 15, u'that': 24, u'Following': 6, u'Where': 11, u'went': 28, u'kitchen': 20, u'Afterwards': 4, u'journeyed': 19, u'she': 23, u'the': 25}
X.shape = (1000, 10, 9)
Xq.shape = (1000, 4)
Y.shape = (1000, 29)
story_maxlen, sentence_maxlen, query_maxlen = 10, 9, 4
max_epochs = 100
Epoch 0
Training loss: 51.082286834772
Training acc: 0.145089285714
Validation acc: 0.177083333333
Testing acc: 0.16935483871
Epoch 1
Training loss: 26.365522384638
Training acc: 0.161830357143
Validation acc: 0.0833333333333
Epoch 2
Training loss: 19.453161239671
Training acc: 0.152901785714
Validation acc: 0.135416666667
Epoch 3
Training loss: 16.487236022968
Training acc: 0.170758928571
Validation acc: 0.197916666667
Epoch 4
20 / 28 : loss = 14.6297273636Training loss: 15.2995386124
Training acc: 0.126116071429
Validation acc: 0.09375
Epoch 5
20 / 28 : loss = 10.3586072922Training loss: 10.8273067474
Training acc: 0.1953125
Validation acc: 0.09375
Epoch 6
20 / 28 : loss = 9.90727043152Training loss: 10.3036193848
Training acc: 0.161830357143
Validation acc: 0.197916666667
Epoch 7
20 / 28 : loss = 9.89708137512Training loss: 9.8219203949
Training acc: 0.161830357143
Validation acc: 0.166666666667
Epoch 8
Training loss: 11.344064712593
Training acc: 0.1640625
Validation acc: 0.208333333333
Epoch 9
20 / 28 : loss = 10.1168708801Training loss: 10.3951215744
Training acc: 0.147321428571
Validation acc: 0.145833333333
Epoch 10
20 / 28 : loss = 9.19806575775Training loss: 9.50462341309
Training acc: 0.145089285714
Validation acc: 0.166666666667
Epoch 11
20 / 28 : loss = 7.62578821182Training loss: 8.0529756546
Training acc: 0.171875
Validation acc: 0.145833333333
Epoch 12
20 / 28 : loss = 7.53781414032Training loss: 7.83018493652
Training acc: 0.189732142857
Validation acc: 0.25
Epoch 13
Training loss: 7.0018954277804
Training acc: 0.1796875
Validation acc: 0.229166666667
Epoch 14
20 / 28 : loss = 7.70766544342Training loss: 8.1121673584
Training acc: 0.131696428571
Validation acc: 0.197916666667
Epoch 15
Training loss: 7.4994215965391
Training acc: 0.166294642857
Validation acc: 0.125
Epoch 16
20 / 28 : loss = 6.27132034302Training loss: 6.45128965378
Training acc: 0.152901785714
Validation acc: 0.270833333333
Epoch 17
Training loss: 6.8529400825567
Training acc: 0.181919642857
Validation acc: 0.104166666667
Epoch 18
20 / 28 : loss = 5.75271987915Training loss: 5.99709653854
Training acc: 0.155133928571
Validation acc: 0.114583333333
Epoch 19
20 / 28 : loss = 6.56776523593Training loss: 6.32039642334
Training acc: 0.138392857143
Validation acc: 0.145833333333
Epoch 20
20 / 28 : loss = 5.79328966141Training loss: 5.96789836884
Training acc: 0.159598214286
Validation acc: 0.15625
Testing acc: 0.15625
Epoch 21
Training loss: 6.3124361038223
Training acc: 0.146205357143
Validation acc: 0.166666666667
Epoch 22
Training loss: 5.6372504234376
Training acc: 0.137276785714
Validation acc: 0.229166666667
Epoch 23
20 / 28 : loss = 5.13148975372Training loss: 5.3089632988
Training acc: 0.149553571429
Validation acc: 0.135416666667
Epoch 24
20 / 28 : loss = 4.94943666458Training loss: 5.04835891724
Training acc: 0.166294642857
Validation acc: 0.25
Epoch 25
Training loss: 5.0466923713733
Training acc: 0.154017857143
Validation acc: 0.104166666667
Epoch 26
Training loss: 4.7733268737835
Training acc: 0.199776785714
Validation acc: 0.15625
Epoch 27
Training loss: 4.8883891105738
Training acc: 0.165178571429
Validation acc: 0.125
Epoch 28
Training loss: 4.8893370628415
Training acc: 0.157366071429
Validation acc: 0.197916666667
Epoch 29
Training loss: 4.3109526634207
Training acc: 0.184151785714
Validation acc: 0.0625
Epoch 30
20 / 28 : loss = 4.20860433578Training loss: 4.3690495491
Training acc: 0.183035714286
Validation acc: 0.1875
Epoch 31
20 / 28 : loss = 3.85922598839Training loss: 4.04576635361
Training acc: 0.188616071429
Validation acc: 0.114583333333
Epoch 32
Training loss: 3.975918531421
Training acc: 0.174107142857
Validation acc: 0.145833333333
Epoch 33
Training loss: 4.2558240890595
Training acc: 0.180803571429
Validation acc: 0.166666666667
Epoch 34
20 / 28 : loss = 3.99138236046Training loss: 3.89395093918
Training acc: 0.194196428571
Validation acc: 0.239583333333
Epoch 35
Training loss: 4.1189990043628
Training acc: 0.175223214286
Validation acc: 0.135416666667
Epoch 36
20 / 28 : loss = 4.02351903915Training loss: 3.98966026306
Training acc: 0.181919642857
Validation acc: 0.1875
Epoch 37
20 / 28 : loss = 3.59467363358Training loss: 3.79340052605
Training acc: 0.178571428571
Validation acc: 0.114583333333
Epoch 38
20 / 28 : loss = 3.90150332451Training loss: 3.96331071854
Training acc: 0.158482142857
Validation acc: 0.197916666667
Epoch 39
20 / 28 : loss = 3.84003710747Training loss: 3.87119841576
Training acc: 0.162946428571
Validation acc: 0.0833333333333
Epoch 40
20 / 28 : loss = 4.29254579544Training loss: 4.26139497757
Training acc: 0.154017857143
Validation acc: 0.291666666667
Testing acc: 0.216733870968
Epoch 41
Training loss: 3.8819477558188
Training acc: 0.1796875
Validation acc: 0.208333333333
Epoch 42
Training loss: 3.9947123527507
Training acc: 0.174107142857
Validation acc: 0.208333333333
Epoch 43
Training loss: 3.8805301189419
Training acc: 0.172991071429
Validation acc: 0.0625
Epoch 44
20 / 28 : loss = 4.01143312454Training loss: 3.76185441017
Training acc: 0.161830357143
Validation acc: 0.239583333333
Epoch 45
20 / 28 : loss = 3.78283262253Training loss: 3.89343428612
Training acc: 0.1484375
Validation acc: 0.125
Epoch 46
Training loss: 3.7421932220532
Training acc: 0.193080357143
Validation acc: 0.104166666667
Epoch 47
20 / 28 : loss = 3.38234972954Training loss: 3.36258769035
Training acc: 0.1953125
Validation acc: 0.208333333333
Epoch 48
20 / 28 : loss = 3.52329397202Training loss: 3.46328234673
Training acc: 0.1875
Validation acc: 0.197916666667
Epoch 49
20 / 28 : loss = 3.89649081239Training loss: 3.91143989563
Training acc: 0.183035714286
Validation acc: 0.114583333333
Epoch 50
20 / 28 : loss = 4.00665616989Training loss: 4.59489488602
Training acc: 0.15625
Validation acc: 0.135416666667
Epoch 51
20 / 28 : loss = 4.22642421722Training loss: 4.05699777603
Training acc: 0.162946428571
Validation acc: 0.1875
Epoch 52
20 / 28 : loss = 4.48834085464Training loss: 4.47894382477
Training acc: 0.171875
Validation acc: 0.15625
Epoch 53
20 / 28 : loss = 3.73985433578Training loss: 3.61648583412
Training acc: 0.207589285714
Validation acc: 0.291666666667
Epoch 54
Training loss: 3.9901416301701
Training acc: 0.198660714286
Validation acc: 0.270833333333
Epoch 55
20 / 28 : loss = 3.4362154007Training loss: 3.33891177177
Training acc: 0.258928571429
Validation acc: 0.21875
Epoch 56
20 / 28 : loss = 3.05615425114Training loss: 3.17156434059
Training acc: 0.251116071429
Validation acc: 0.166666666667
Epoch 57
Training loss: 3.1018340587647
Training acc: 0.262276785714
Validation acc: 0.3125
Epoch 58
Training loss: 3.1663005352166
Training acc: 0.258928571429
Validation acc: 0.229166666667
Epoch 59
20 / 28 : loss = 2.96403765678Training loss: 2.92598581314
Training acc: 0.279017857143
Validation acc: 0.364583333333
Epoch 60
20 / 28 : loss = 3.27705311775Training loss: 3.24568247795
Training acc: 0.270089285714
Validation acc: 0.395833333333
Testing acc: 0.302419354839
Epoch 61
Training loss: 2.8642103672027
Training acc: 0.3046875
Validation acc: 0.25
Epoch 62
Training loss: 3.0125710964264
Training acc: 0.282366071429
Validation acc: 0.229166666667
Epoch 63
20 / 28 : loss = 3.03547239304Training loss: 2.99814391136
Training acc: 0.283482142857
Validation acc: 0.364583333333
Epoch 64
20 / 28 : loss = 2.86242389679Training loss: 2.81305861473
Training acc: 0.330357142857
Validation acc: 0.270833333333
Epoch 65
Training loss: 2.6866593360987
Training acc: 0.370535714286
Validation acc: 0.385416666667
Epoch 66
Training loss: 2.5764255523761
Training acc: 0.380580357143
Validation acc: 0.520833333333
Epoch 67
20 / 28 : loss = 2.51467943192Training loss: 2.45342063904
Training acc: 0.421875
Validation acc: 0.458333333333
Epoch 68
20 / 28 : loss = 2.58854699135Training loss: 2.42221069336
Training acc: 0.444196428571
Validation acc: 0.53125
Epoch 69
20 / 28 : loss = 1.99300253391Training loss: 2.11561369896
Training acc: 0.496651785714
Validation acc: 0.541666666667
Epoch 70
20 / 28 : loss = 1.9895786047Training loss: 2.0331223011
Training acc: 0.526785714286
Validation acc: 0.645833333333
Epoch 71
Training loss: 2.0228555202573
Training acc: 0.526785714286
Validation acc: 0.416666666667
Epoch 72
Training loss: 1.8985463380866
Training acc: 0.590401785714
Validation acc: 0.65625
Epoch 73
20 / 28 : loss = 1.82033050061Training loss: 1.87805581093
Training acc: 0.573660714286
Validation acc: 0.541666666667
Epoch 74
Training loss: 1.8210458755531
Training acc: 0.563616071429
Validation acc: 0.5625
Epoch 75
Training loss: 1.9502576589616
Training acc: 0.565848214286
Validation acc: 0.604166666667
Epoch 76
Training loss: 1.6936818361361
Training acc: 0.635044642857
Validation acc: 0.614583333333
Epoch 77
20 / 28 : loss = 1.83058691025Training loss: 1.85961997509
Training acc: 0.594866071429
Validation acc: 0.739583333333
Epoch 78
Training loss: 1.6785601377531
Training acc: 0.629464285714
Validation acc: 0.645833333333
Epoch 79
Training loss: 1.6648713350309
Training acc: 0.639508928571
Validation acc: 0.6875
Epoch 80
20 / 28 : loss = 1.69341206551Training loss: 1.77734935284
Training acc: 0.608258928571
Validation acc: 0.739583333333
Testing acc: 0.73689516129
Epoch 81
Training loss: 1.6200143098827
Training acc: 0.6328125
Validation acc: 0.708333333333
Epoch 82
Training loss: 1.6507070064542
Training acc: 0.618303571429
Validation acc: 0.614583333333
Epoch 83
20 / 28 : loss = 1.55146479607Training loss: 1.68209898472
Training acc: 0.626116071429
Validation acc: 0.625
Epoch 84
20 / 28 : loss = 1.73820698261Training loss: 1.70637571812
Training acc: 0.623883928571
Validation acc: 0.677083333333
Epoch 85
20 / 28 : loss = 1.54902124405Training loss: 1.6745121479
Training acc: 0.627232142857
Validation acc: 0.677083333333
Epoch 86
Training loss: 1.6168295145612
Training acc: 0.645089285714
Validation acc: 0.604166666667
Epoch 87
20 / 28 : loss = 1.60064351559Training loss: 1.53012597561
Training acc: 0.660714285714
Validation acc: 0.59375
Epoch 88
Training loss: 1.5531524419803
Training acc: 0.638392857143
Validation acc: 0.583333333333
Epoch 89
20 / 28 : loss = 1.51408302784Training loss: 1.4969753027
Training acc: 0.662946428571
Validation acc: 0.645833333333
Epoch 90
20 / 28 : loss = 1.58104348183Training loss: 1.59736311436
Training acc: 0.630580357143
Validation acc: 0.625
Epoch 91
20 / 28 : loss = 1.56032073498Training loss: 1.52660822868
Training acc: 0.646205357143
Validation acc: 0.635416666667
Epoch 92
20 / 28 : loss = 1.51854944229Training loss: 1.48220551014
Training acc: 0.668526785714
Validation acc: 0.614583333333
Epoch 93
20 / 28 : loss = 1.52403390408Training loss: 1.52581477165
Training acc: 0.638392857143
Validation acc: 0.5625
Epoch 94
20 / 28 : loss = 1.59420228004Training loss: 1.57654345036
Training acc: 0.626116071429
Validation acc: 0.65625
Epoch 95
Training loss: 1.5793100595567
Training acc: 0.639508928571
Validation acc: 0.6875
Epoch 96
20 / 28 : loss = 1.48010349274Training loss: 1.48744165897
Training acc: 0.660714285714
Validation acc: 0.666666666667
Epoch 97
20 / 28 : loss = 1.71350038052Training loss: 1.71633219719
Training acc: 0.611607142857
Validation acc: 0.625
Epoch 98
20 / 28 : loss = 1.39767515659Training loss: 1.53104484081
Training acc: 0.655133928571
Validation acc: 0.71875
Epoch 99
Training loss: 1.4697242975235
Training acc: 0.684151785714
Validation acc: 0.59375

**************************************

qa12_conjunction
vocab = [u'.', u'?', u'Daniel', u'John', u'Mary', u'Sandra', u'Where', u'and', u'back', u'bathroom', u'bedroom', u'garden', u'hallway', u'is', u'journeyed', u'kitchen', u'moved', u'office', u'the', u'to', u'travelled', u'went']
word_idx = {u'and': 8, u'office': 18, u'is': 14, u'moved': 17, u'back': 9, u'Daniel': 3, u'bedroom': 11, u'John': 4, u'Mary': 5, u'bathroom': 10, u'.': 1, u'to': 20, u'Sandra': 6, u'travelled': 21, u'?': 2, u'hallway': 13, u'garden': 12, u'Where': 7, u'the': 19, u'kitchen': 16, u'journeyed': 15, u'went': 22}
X.shape = (1000, 10, 9)
Xq.shape = (1000, 4)
Y.shape = (1000, 23)
story_maxlen, sentence_maxlen, query_maxlen = 10, 9, 4
max_epochs = 100
Epoch 0
Training loss: 12.188500404441
Training acc: 0.166294642857
Validation acc: 0.1875
Testing acc: 0.162298387097
Epoch 1
Training loss: 4.2111153602678
Training acc: 0.178571428571
Validation acc: 0.135416666667
Epoch 2
Training loss: 3.7566959857918
Training acc: 0.1796875
Validation acc: 0.177083333333
Epoch 3
Training loss: 3.5334718227459
Training acc: 0.177455357143
Validation acc: 0.177083333333
Epoch 4
20 / 28 : loss = 3.31914186478Training loss: 3.28886938095
Training acc: 0.199776785714
Validation acc: 0.15625
Epoch 5
Training loss: 3.2474005222311
Training acc: 0.174107142857
Validation acc: 0.21875
Epoch 6
Training loss: 3.0914502143909
Training acc: 0.194196428571
Validation acc: 0.1875
Epoch 7
Training loss: 3.0242083072746
Training acc: 0.1796875
Validation acc: 0.135416666667
Epoch 8
Training loss: 2.9128262996722
Training acc: 0.186383928571
Validation acc: 0.135416666667
Epoch 9
20 / 28 : loss = 2.88623142242Training loss: 2.86846208572
Training acc: 0.177455357143
Validation acc: 0.166666666667
Epoch 10
Training loss: 2.8110299110411
Training acc: 0.184151785714
Validation acc: 0.177083333333
Epoch 11
Training loss: 2.7091965675431
Training acc: 0.188616071429
Validation acc: 0.145833333333
Epoch 12
Training loss: 2.6534798145325
Training acc: 0.185267857143
Validation acc: 0.166666666667
Epoch 13
20 / 28 : loss = 2.63881063461Training loss: 2.6441848278
Training acc: 0.183035714286
Validation acc: 0.166666666667
Epoch 14
20 / 28 : loss = 2.57086706161Training loss: 2.56182670593
Training acc: 0.171875
Validation acc: 0.166666666667
Epoch 15
Training loss: 2.5222611427386
Training acc: 0.178571428571
Validation acc: 0.208333333333
Epoch 16
20 / 28 : loss = 2.47327136993Training loss: 2.47524428368
Training acc: 0.174107142857
Validation acc: 0.15625
Epoch 17
20 / 28 : loss = 2.43812608719Training loss: 2.44099497795
Training acc: 0.196428571429
Validation acc: 0.260416666667
Epoch 18
20 / 28 : loss = 2.42941236496Training loss: 2.41811299324
Training acc: 0.1796875
Validation acc: 0.125
Epoch 19
Training loss: 2.3872697353475
Training acc: 0.183035714286
Validation acc: 0.15625
Epoch 20
20 / 28 : loss = 2.34777951241Training loss: 2.35946512222
Training acc: 0.180803571429
Validation acc: 0.197916666667
Testing acc: 0.188508064516
Epoch 21
Training loss: 2.3485445976386
Training acc: 0.183035714286
Validation acc: 0.177083333333
Epoch 22
20 / 28 : loss = 2.31299805641Training loss: 2.30636358261
Training acc: 0.167410714286
Validation acc: 0.208333333333
Epoch 23
Training loss: 2.3113076686905
Training acc: 0.174107142857
Validation acc: 0.1875
Epoch 24
Training loss: 2.2933707237282
Training acc: 0.181919642857
Validation acc: 0.208333333333
Epoch 25
20 / 28 : loss = 2.25553631783Training loss: 2.24801039696
Training acc: 0.176339285714
Validation acc: 0.166666666667
Epoch 26
Training loss: 2.2666192054728
Training acc: 0.196428571429
Validation acc: 0.1875
Epoch 27
20 / 28 : loss = 2.1840865612Training loss: 2.20077419281
Training acc: 0.217633928571
Validation acc: 0.3125
Epoch 28
Training loss: 2.1269929409191
Training acc: 0.255580357143
Validation acc: 0.354166666667
Epoch 29
Training loss: 2.0224192142514
Training acc: 0.316964285714
Validation acc: 0.364583333333
Epoch 30
20 / 28 : loss = 1.90783059597Training loss: 1.90505588055
Training acc: 0.354910714286
Validation acc: 0.375
Epoch 31
20 / 28 : loss = 1.81364643574Training loss: 1.81812942028
Training acc: 0.417410714286
Validation acc: 0.416666666667
Epoch 32
20 / 28 : loss = 1.91755700111Training loss: 1.8826341629
Training acc: 0.449776785714
Validation acc: 0.645833333333
Epoch 33
20 / 28 : loss = 1.76433253288Training loss: 1.76985621452
Training acc: 0.486607142857
Validation acc: 0.520833333333
Epoch 34
20 / 28 : loss = 1.63015604019Training loss: 1.69154512882
Training acc: 0.546875
Validation acc: 0.604166666667
Epoch 35
20 / 28 : loss = 1.61247217655Training loss: 1.63340175152
Training acc: 0.573660714286
Validation acc: 0.5625
Epoch 36
20 / 28 : loss = 1.52807545662Training loss: 1.52601468563
Training acc: 0.666294642857
Validation acc: 0.708333333333
Epoch 37
20 / 28 : loss = 1.48719990253Training loss: 1.45485150814
Training acc: 0.650669642857
Validation acc: 0.770833333333
Epoch 38
20 / 28 : loss = 1.35023379326Training loss: 1.35621702671
Training acc: 0.685267857143
Validation acc: 0.697916666667
Epoch 39
20 / 28 : loss = 1.35566878319Training loss: 1.3601218462
Training acc: 0.670758928571
Validation acc: 0.739583333333
Epoch 40
20 / 28 : loss = 1.28109157085Training loss: 1.30012607574
Training acc: 0.680803571429
Validation acc: 0.729166666667
Testing acc: 0.765120967742
Epoch 41
Training loss: 1.2305166721332
Training acc: 0.691964285714
Validation acc: 0.645833333333
Epoch 42
20 / 28 : loss = 1.24483466148Training loss: 1.26100361347
Training acc: 0.660714285714
Validation acc: 0.697916666667
Epoch 43
Training loss: 1.1901732683294
Training acc: 0.677455357143
Validation acc: 0.666666666667
Epoch 44
Training loss: 1.2078753709826
Training acc: 0.6640625
Validation acc: 0.760416666667
Epoch 45
20 / 28 : loss = 1.17192351818Training loss: 1.1932567358
Training acc: 0.655133928571
Validation acc: 0.6875
Epoch 46
Training loss: 1.1885114908221
Training acc: 0.667410714286
Validation acc: 0.65625
Epoch 47
Training loss: 1.1710397005148
Training acc: 0.670758928571
Validation acc: 0.677083333333
Epoch 48
20 / 28 : loss = 1.13972949982Training loss: 1.12942945957
Training acc: 0.671875
Validation acc: 0.760416666667
Epoch 49
20 / 28 : loss = 1.13780713081Training loss: 1.12193739414
Training acc: 0.683035714286
Validation acc: 0.635416666667
Epoch 50
20 / 28 : loss = 1.05963075161Training loss: 1.05958414078
Training acc: 0.686383928571
Validation acc: 0.645833333333
Epoch 51
20 / 28 : loss = 1.07899582386Training loss: 1.10863089561
Training acc: 0.681919642857
Validation acc: 0.739583333333
Epoch 52
20 / 28 : loss = 1.09658575058Training loss: 1.09385669231
Training acc: 0.677455357143
Validation acc: 0.71875
Epoch 53
20 / 28 : loss = 1.05822277069Training loss: 1.06321322918
Training acc: 0.683035714286
Validation acc: 0.666666666667
Epoch 54
Training loss: 1.0646097660109
Training acc: 0.684151785714
Validation acc: 0.677083333333
Epoch 55
20 / 28 : loss = 1.07366418839Training loss: 1.06767594814
Training acc: 0.6875
Validation acc: 0.614583333333
Epoch 56
20 / 28 : loss = 1.02629745007Training loss: 1.03066051006
Training acc: 0.694196428571
Validation acc: 0.635416666667
Epoch 57
20 / 28 : loss = 1.05606293678Training loss: 1.05512690544
Training acc: 0.670758928571
Validation acc: 0.71875
Epoch 58
20 / 28 : loss = 1.05148053169Training loss: 1.03206622601
Training acc: 0.694196428571
Validation acc: 0.71875
Epoch 59
20 / 28 : loss = 1.03277862072Training loss: 1.03048300743
Training acc: 0.683035714286
Validation acc: 0.708333333333
Epoch 60
20 / 28 : loss = 1.035684704786Training loss: 1.03569114208
Training acc: 0.688616071429
Validation acc: 0.71875
Testing acc: 0.650201612903
Epoch 61
Training loss: 1.01211786275842
Training acc: 0.696428571429
Validation acc: 0.729166666667
Epoch 62
Training loss: 1.0172349214658
Training acc: 0.697544642857
Validation acc: 0.697916666667
Epoch 63
20 / 28 : loss = 1.022571325308Training loss: 1.0056886673
Training acc: 0.697544642857
Validation acc: 0.739583333333
Epoch 64
Training loss: 0.99648535251614
Training acc: 0.686383928571
Validation acc: 0.71875
Epoch 65
20 / 28 : loss = 1.03102087975Training loss: 0.99552577734
Training acc: 0.685267857143
Validation acc: 0.645833333333
Epoch 66
Training loss: 1.02840626249256
Training acc: 0.669642857143
Validation acc: 0.59375
Epoch 67
20 / 28 : loss = 0.972054362297Training loss: 0.979324638844
Training acc: 0.690848214286
Validation acc: 0.6875
Epoch 68
Training loss: 0.97073411941595
Training acc: 0.6875
Validation acc: 0.65625
Epoch 69
20 / 28 : loss = 0.909566402435Training loss: 0.952691376209
Training acc: 0.716517857143
Validation acc: 0.65625
Epoch 70
20 / 28 : loss = 1.00633716583Training loss: 1.00802302361
Training acc: 0.690848214286
Validation acc: 0.8125
Epoch 71
Training loss: 0.94865405559562
Training acc: 0.699776785714
Validation acc: 0.770833333333
Epoch 72
20 / 28 : loss = 0.949972450733Training loss: 0.948968052864
Training acc: 0.697544642857
Validation acc: 0.666666666667
Epoch 73
20 / 28 : loss = 0.937665581703Training loss: 0.950157701969
Training acc: 0.724330357143
Validation acc: 0.6875
Epoch 74
20 / 28 : loss = 0.967694520952Training loss: 0.961609899998
Training acc: 0.708705357143
Validation acc: 0.729166666667
Epoch 75
20 / 28 : loss = 0.945155739784Training loss: 0.960035979748
Training acc: 0.696428571429
Validation acc: 0.770833333333
Epoch 76
20 / 28 : loss = 0.892317831516Training loss: 0.883761763573
Training acc: 0.735491071429
Validation acc: 0.697916666667
Epoch 77
20 / 28 : loss = 0.910123527052Training loss: 0.948014616966
Training acc: 0.719866071429
Validation acc: 0.708333333333
Epoch 78
20 / 28 : loss = 0.931809186935Training loss: 0.952642500401
Training acc: 0.707589285714
Validation acc: 0.666666666667
Epoch 79
Training loss: 0.95352643728363
Training acc: 0.71875
Validation acc: 0.739583333333
Epoch 80
20 / 28 : loss = 0.890205562115Training loss: 0.88894110918
Training acc: 0.732142857143
Validation acc: 0.697916666667
Testing acc: 0.695564516129
Epoch 81
Training loss: 0.92787081003247
Training acc: 0.706473214286
Validation acc: 0.6875
Epoch 82
Training loss: 0.90319967269937
Training acc: 0.708705357143
Validation acc: 0.75
Epoch 83
Training loss: 0.92203474044824
Training acc: 0.729910714286
Validation acc: 0.729166666667
Epoch 84
Training loss: 0.91189956665081
Training acc: 0.705357142857
Validation acc: 0.770833333333
Epoch 85
20 / 28 : loss = 0.852670550346Training loss: 0.882180988789
Training acc: 0.738839285714
Validation acc: 0.677083333333
Epoch 86
Training loss: 0.90759974718132
Training acc: 0.707589285714
Validation acc: 0.708333333333
Epoch 87
Training loss: 0.89125365018872
Training acc: 0.736607142857
Validation acc: 0.729166666667
Epoch 88
20 / 28 : loss = 0.866566896439Training loss: 0.871307432652
Training acc: 0.737723214286
Validation acc: 0.6875
Epoch 89
Training loss: 0.87049627304134
Training acc: 0.746651785714
Validation acc: 0.635416666667
Epoch 90
Training loss: 0.84706306457554
Training acc: 0.7421875
Validation acc: 0.739583333333
Epoch 91
20 / 28 : loss = 0.904802858829Training loss: 0.875122964382
Training acc: 0.746651785714
Validation acc: 0.6875
Epoch 92
Training loss: 0.85484027862588
Training acc: 0.752232142857
Validation acc: 0.697916666667
Epoch 93
Training loss: 0.86075013876795
Training acc: 0.753348214286
Validation acc: 0.739583333333
Epoch 94
Training loss: 0.82751458883369
Training acc: 0.754464285714
Validation acc: 0.729166666667
Epoch 95
20 / 28 : loss = 0.827899634838Training loss: 0.861683428288
Training acc: 0.754464285714
Validation acc: 0.791666666667
Epoch 96
20 / 28 : loss = 0.799592614174Training loss: 0.804896950722
Training acc: 0.776785714286
Validation acc: 0.760416666667
Epoch 97
Training loss: 0.82053756713913
Training acc: 0.743303571429
Validation acc: 0.75
Epoch 98
20 / 28 : loss = 0.822022497654Training loss: 0.803772866726
Training acc: 0.774553571429
Validation acc: 0.760416666667
Epoch 99
20 / 28 : loss = 0.797124862671Training loss: 0.806888103485
Training acc: 0.794642857143
Validation acc: 0.75

**************************************

qa13_compound-coreference
vocab = [u'.', u'?', u'After', u'Afterwards', u'Daniel', u'Following', u'John', u'Mary', u'Sandra', u'Then', u'Where', u'and', u'back', u'bathroom', u'bedroom', u'garden', u'hallway', u'is', u'journeyed', u'kitchen', u'moved', u'office', u'that', u'the', u'they', u'to', u'travelled', u'went']
word_idx = {u'and': 12, u'office': 22, u'is': 18, u'moved': 21, u'back': 13, u'Daniel': 5, u'bedroom': 15, u'John': 7, u'Mary': 8, u'Then': 10, u'bathroom': 14, u'After': 3, u'.': 1, u'to': 26, u'Sandra': 9, u'travelled': 27, u'?': 2, u'hallway': 17, u'garden': 16, u'that': 23, u'they': 25, u'Following': 6, u'Where': 11, u'went': 28, u'kitchen': 20, u'Afterwards': 4, u'journeyed': 19, u'the': 24}
X.shape = (1000, 10, 9)
Xq.shape = (1000, 4)
Y.shape = (1000, 29)
story_maxlen, sentence_maxlen, query_maxlen = 10, 9, 4
max_epochs = 100
Epoch 0
Training loss: 8.7899923324621
Training acc: 0.138392857143
Validation acc: 0.135416666667
Testing acc: 0.152217741935
Epoch 1
Training loss: 4.0100698471103
Training acc: 0.154017857143
Validation acc: 0.114583333333
Epoch 2
20 / 28 : loss = 3.64623618126Training loss: 3.62305092812
Training acc: 0.15625
Validation acc: 0.208333333333
Epoch 3
Training loss: 3.2855091095401
Training acc: 0.167410714286
Validation acc: 0.197916666667
Epoch 4
Training loss: 3.0227677822111
Training acc: 0.181919642857
Validation acc: 0.145833333333
Epoch 5
Training loss: 2.9258384704672
Training acc: 0.181919642857
Validation acc: 0.25
Epoch 6
Training loss: 2.8479473590924
Training acc: 0.188616071429
Validation acc: 0.229166666667
Epoch 7
Training loss: 2.7163603305862
Training acc: 0.188616071429
Validation acc: 0.1875
Epoch 8
20 / 28 : loss = 2.68825960159Training loss: 2.75580215454
Training acc: 0.176339285714
Validation acc: 0.1875
Epoch 9
20 / 28 : loss = 2.44841122627Training loss: 2.45393538475
Training acc: 0.260044642857
Validation acc: 0.270833333333
Epoch 10
20 / 28 : loss = 2.12962245941Training loss: 2.15983128548
Training acc: 0.332589285714
Validation acc: 0.34375
Epoch 11
20 / 28 : loss = 2.08572697639Training loss: 2.03126835823
Training acc: 0.380580357143
Validation acc: 0.447916666667
Epoch 12
20 / 28 : loss = 1.93872964382Training loss: 1.89301073551
Training acc: 0.428571428571
Validation acc: 0.5625
Epoch 13
20 / 28 : loss = 1.71402251726Training loss: 1.71607780457
Training acc: 0.542410714286
Validation acc: 0.59375
Epoch 14
Training loss: 1.5540418624983
Training acc: 0.637276785714
Validation acc: 0.791666666667
Epoch 15
20 / 28 : loss = 1.32861602306Training loss: 1.36024224758
Training acc: 0.724330357143
Validation acc: 0.791666666667
Epoch 16
20 / 28 : loss = 1.18444406986Training loss: 1.16562914848
Training acc: 0.797991071429
Validation acc: 0.885416666667
Epoch 17
20 / 28 : loss = 0.944836020478Training loss: 0.974009096622
Training acc: 0.904017857143
Validation acc: 0.989583333333
Epoch 18
20 / 28 : loss = 0.989402651787Training loss: 0.956751167774
Training acc: 0.895089285714
Validation acc: 0.916666666667
Epoch 19
20 / 28 : loss = 0.858604431152Training loss: 0.854575276375
Training acc: 0.920758928571
Validation acc: 0.96875
Epoch 20
20 / 28 : loss = 0.794272303581Training loss: 0.795596659184
Training acc: 0.924107142857
Validation acc: 0.958333333333
Testing acc: 0.943548387097
Epoch 21
Training loss: 0.75511968135883
Training acc: 0.924107142857
Validation acc: 0.9375
Epoch 22
Training loss: 0.75337558984862
Training acc: 0.918526785714
Validation acc: 0.958333333333
Epoch 23
20 / 28 : loss = 0.717596173286Training loss: 0.721833527088
Training acc: 0.917410714286
Validation acc: 0.947916666667
Epoch 24
Training loss: 0.69743496179693
Training acc: 0.918526785714
Validation acc: 0.96875
Epoch 25
20 / 28 : loss = 0.673203766346Training loss: 0.668654441833
Training acc: 0.920758928571
Validation acc: 0.927083333333
Epoch 26
20 / 28 : loss = 0.605014324188Training loss: 0.630503475666
Training acc: 0.927455357143
Validation acc: 0.947916666667
Epoch 27
Training loss: 0.62325000762988
Training acc: 0.924107142857
Validation acc: 0.927083333333
Epoch 28
Training loss: 0.58970040082934
Training acc: 0.925223214286
Validation acc: 0.9375
Epoch 29
20 / 28 : loss = 0.567880153656Training loss: 0.564825952053
Training acc: 0.9296875
Validation acc: 0.895833333333
Epoch 30
20 / 28 : loss = 0.572031438351Training loss: 0.58332246542
Training acc: 0.9140625
Validation acc: 0.927083333333
Epoch 31
20 / 28 : loss = 0.5482172966Training loss: 1.06817901134
Training acc: 0.792410714286
Validation acc: 0.645833333333
Epoch 32
20 / 28 : loss = 0.961385071278Training loss: 0.908272087574
Training acc: 0.841517857143
Validation acc: 0.885416666667
Epoch 33
Training loss: 0.70537668466617
Training acc: 0.912946428571
Validation acc: 0.96875
Epoch 34
Training loss: 0.65278846025525
Training acc: 0.925223214286
Validation acc: 0.9375
Epoch 35
Training loss: 0.59046608209641
Training acc: 0.922991071429
Validation acc: 0.979166666667
Epoch 36
20 / 28 : loss = 0.547105669975Training loss: 0.571323335171
Training acc: 0.919642857143
Validation acc: 0.9375
Epoch 37
20 / 28 : loss = 0.582650065422Training loss: 0.541839957237
Training acc: 0.920758928571
Validation acc: 0.947916666667
Epoch 38
Training loss: 0.53439986705857
Training acc: 0.917410714286
Validation acc: 0.958333333333
Epoch 39
Training loss: 0.50369411706982
Training acc: 0.928571428571
Validation acc: 0.916666666667
Epoch 40
20 / 28 : loss = 0.500353813171Training loss: 0.496654093266
Training acc: 0.9296875
Validation acc: 0.947916666667
Testing acc: 0.936491935484
Epoch 41
Training loss: 0.48025709390687
Training acc: 0.921875
Validation acc: 0.9375
Epoch 42
Training loss: 0.46929603815117
Training acc: 0.930803571429
Validation acc: 0.9375
Epoch 43
20 / 28 : loss = 0.456750929356Training loss: 0.455394595861
Training acc: 0.925223214286
Validation acc: 0.9375
Epoch 44
Training loss: 0.44870474934656
Training acc: 0.930803571429
Validation acc: 0.947916666667
Epoch 45
Training loss: 0.43427509069445
Training acc: 0.935267857143
Validation acc: 0.895833333333
Epoch 46
Training loss: 0.46359449625866
Training acc: 0.920758928571
Validation acc: 0.885416666667
Epoch 47
20 / 28 : loss = 0.468710213942Training loss: 0.465647906065
Training acc: 0.922991071429
Validation acc: 0.96875
Epoch 48
Training loss: 0.42061406374503
Training acc: 0.930803571429
Validation acc: 0.90625
Epoch 49
Training loss: 0.49974754452745
Training acc: 0.916294642857
Validation acc: 0.927083333333
Epoch 50
Training loss: 0.44785812497195
Training acc: 0.926339285714
Validation acc: 0.927083333333
Epoch 51
20 / 28 : loss = 0.371428072453Training loss: 0.404464453459
Training acc: 0.943080357143
Validation acc: 0.927083333333
Epoch 52
Training loss: 0.38492950797116
Training acc: 0.943080357143
Validation acc: 0.875
Epoch 53
Training loss: 0.40803763270451
Training acc: 0.934151785714
Validation acc: 0.9375
Epoch 54
Training loss: 0.36577704548814
Training acc: 0.946428571429
Validation acc: 0.916666666667
Epoch 55
Training loss: 0.41366299986878
Training acc: 0.927455357143
Validation acc: 0.979166666667
Epoch 56
20 / 28 : loss = 0.336057364941Training loss: 0.357568055391
Training acc: 0.948660714286
Validation acc: 0.864583333333
Epoch 57
20 / 28 : loss = 0.359125137329Training loss: 0.376967638731
Training acc: 0.941964285714
Validation acc: 0.927083333333
Epoch 58
Training loss: 0.36086329817865
Training acc: 0.941964285714
Validation acc: 0.947916666667
Epoch 59
20 / 28 : loss = 0.364222437143Training loss: 0.361908107996
Training acc: 0.941964285714
Validation acc: 0.958333333333
Epoch 60
Training loss: 0.35453215241467
Training acc: 0.952008928571
Validation acc: 0.916666666667
Testing acc: 0.929435483871
Epoch 61
Training loss: 0.33088546991315
Training acc: 0.962053571429
Validation acc: 0.979166666667
Epoch 62
Training loss: 0.32890605926563
Training acc: 0.957589285714
Validation acc: 0.947916666667
Epoch 63
20 / 28 : loss = 0.360317856073Training loss: 0.364650994539
Training acc: 0.943080357143
Validation acc: 0.96875
Epoch 64
20 / 28 : loss = 0.310155719519Training loss: 0.354071617126
Training acc: 0.939732142857
Validation acc: 0.604166666667
Epoch 65
20 / 28 : loss = 1.08581829071Training loss: 0.983786165714
Training acc: 0.8515625
Validation acc: 0.9375
Epoch 66
20 / 28 : loss = 0.515763044357Training loss: 0.494988203049
Training acc: 0.938616071429
Validation acc: 0.927083333333
Epoch 67
20 / 28 : loss = 0.401317358017Training loss: 0.421630442142
Training acc: 0.948660714286
Validation acc: 0.947916666667
Epoch 68
Training loss: 0.41105729341549
Training acc: 0.946428571429
Validation acc: 0.958333333333
Epoch 69
Training loss: 0.36546233296443
Training acc: 0.952008928571
Validation acc: 0.989583333333
Epoch 70
Training loss: 0.36582967639695
Training acc: 0.954241071429
Validation acc: 0.947916666667
Epoch 71
20 / 28 : loss = 0.357667684555Training loss: 0.352378636599
Training acc: 0.956473214286
Validation acc: 1.0
Epoch 72
20 / 28 : loss = 0.326521009207Training loss: 0.332781612873
Training acc: 0.962053571429
Validation acc: 0.989583333333
Epoch 73
20 / 28 : loss = 0.304884582758Training loss: 0.31715580821
Training acc: 0.962053571429
Validation acc: 0.96875
Epoch 74
20 / 28 : loss = 0.324571549892Training loss: 0.32342544198
Training acc: 0.959821428571
Validation acc: 0.989583333333
Epoch 75
Training loss: 0.34559369087236
Training acc: 0.952008928571
Validation acc: 0.989583333333
Epoch 76
20 / 28 : loss = 0.351272672415Training loss: 0.344320356846
Training acc: 0.950892857143
Validation acc: 0.979166666667
Epoch 77
Training loss: 0.30200132727613
Training acc: 0.969866071429
Validation acc: 0.947916666667
Epoch 78
Training loss: 0.3275178074842
Training acc: 0.949776785714
Validation acc: 0.989583333333
Epoch 79
20 / 28 : loss = 0.310401737694Training loss: 0.318555861712
Training acc: 0.957589285714
Validation acc: 0.979166666667
Epoch 80
20 / 28 : loss = 0.294434010983Training loss: 0.291969746351
Training acc: 0.973214285714
Validation acc: 1.0
Testing acc: 0.923387096774
Epoch 81
Training loss: 0.29707479476911
Training acc: 0.964285714286
Validation acc: 0.989583333333
Epoch 82
Training loss: 0.29063811898254
Training acc: 0.963169642857
Validation acc: 0.96875
Epoch 83
Training loss: 0.30998712778168
Training acc: 0.953125
Validation acc: 0.989583333333
Epoch 84
Training loss: 0.28186634182903
Training acc: 0.9765625
Validation acc: 0.96875
Epoch 85
Training loss: 0.29261460900365
Training acc: 0.972098214286
Validation acc: 0.989583333333
Epoch 86
20 / 28 : loss = 0.303448438644Training loss: 0.297722101212
Training acc: 0.962053571429
Validation acc: 0.947916666667
Epoch 87
Training loss: 0.27774506807397
Training acc: 0.965401785714
Validation acc: 0.947916666667
Epoch 88
20 / 28 : loss = 0.295890241861Training loss: 0.297961086035
Training acc: 0.9609375
Validation acc: 0.947916666667
Epoch 89
20 / 28 : loss = 0.269555628362Training loss: 0.285053789616
Training acc: 0.967633928571
Validation acc: 0.958333333333
Epoch 90
Training loss: 0.27559360861881
Training acc: 0.975446428571
Validation acc: 0.989583333333
Epoch 91
20 / 28 : loss = 0.241520702839Training loss: 0.251398861408
Training acc: 0.988839285714
Validation acc: 0.9375
Epoch 92
20 / 28 : loss = 0.270934373145Training loss: 0.272332876921
Training acc: 0.972098214286
Validation acc: 0.979166666667
Epoch 93
Training loss: 0.27737775445767
Training acc: 0.967633928571
Validation acc: 0.979166666667
Epoch 94
Training loss: 0.27554816007629
Training acc: 0.973214285714
Validation acc: 1.0
Epoch 95
Training loss: 0.27457016706512
Training acc: 0.977678571429
Validation acc: 0.96875
Epoch 96
20 / 28 : loss = 0.266067951918Training loss: 0.265017956495
Training acc: 0.974330357143
Validation acc: 1.0
Epoch 97
Training loss: 0.25545427203201
Training acc: 0.983258928571
Validation acc: 0.989583333333
Epoch 98
Training loss: 0.24748656153738
Training acc: 0.983258928571
Validation acc: 0.989583333333
Epoch 99
20 / 28 : loss = 0.257069289684Training loss: 0.258058279753
Training acc: 0.977678571429
Validation acc: 0.979166666667

**************************************

qa14_time-reasoning
vocab = [u'.', u'?', u'Bill', u'Fred', u'Julie', u'Mary', u'This', u'Where', u'Yesterday', u'afternoon', u'back', u'bedroom', u'before', u'cinema', u'evening', u'journeyed', u'kitchen', u'morning', u'moved', u'office', u'park', u'school', u'the', u'this', u'to', u'travelled', u'was', u'went', u'yesterday']
word_idx = {u'office': 20, u'cinema': 14, u'moved': 19, u'back': 11, u'bedroom': 12, u'.': 1, u'Mary': 6, u'before': 13, u'Yesterday': 9, u'Fred': 4, u'to': 25, u'travelled': 26, u'was': 27, u'?': 2, u'evening': 15, u'This': 7, u'Bill': 3, u'park': 21, u'yesterday': 29, u'Where': 8, u'went': 28, u'kitchen': 17, u'school': 22, u'journeyed': 16, u'this': 24, u'Julie': 5, u'morning': 18, u'afternoon': 10, u'the': 23}
X.shape = (1000, 14, 9)
Xq.shape = (1000, 7)
Y.shape = (1000, 30)
story_maxlen, sentence_maxlen, query_maxlen = 14, 9, 7
max_epochs = 100
Epoch 0
20 / 28 : loss = 16.1962833405Training loss: 13.1664133072
Training acc: 0.161830357143
Validation acc: 0.125
Testing acc: 0.161290322581
Epoch 1
Training loss: 3.1612861156595
Training acc: 0.160714285714
Validation acc: 0.135416666667
Epoch 2
Training loss: 3.0100982189212
Training acc: 0.166294642857
Validation acc: 0.135416666667
Epoch 3
Training loss: 2.7092401981415
Training acc: 0.169642857143
Validation acc: 0.208333333333
Epoch 4
20 / 28 : loss = 2.71889662743Training loss: 2.68283677101
Training acc: 0.160714285714
Validation acc: 0.145833333333
Epoch 5
20 / 28 : loss = 2.57423734665Training loss: 2.582498312
Training acc: 0.154017857143
Validation acc: 0.177083333333
Epoch 6
20 / 28 : loss = 2.49888110161Training loss: 2.50878572464
Training acc: 0.160714285714
Validation acc: 0.21875
Epoch 7
20 / 28 : loss = 2.43725681305Training loss: 2.43852591515
Training acc: 0.1640625
Validation acc: 0.15625
Epoch 8
Training loss: 2.3573195934328
Training acc: 0.177455357143
Validation acc: 0.197916666667
Epoch 9
Training loss: 2.3093750476824
Training acc: 0.162946428571
Validation acc: 0.208333333333
Epoch 10
Training loss: 2.2949600219792
Training acc: 0.145089285714
Validation acc: 0.208333333333
Epoch 11
20 / 28 : loss = 2.25940585136Training loss: 2.25966477394
Training acc: 0.154017857143
Validation acc: 0.135416666667
Epoch 12
20 / 28 : loss = 2.22370934486Training loss: 2.22419977188
Training acc: 0.157366071429
Validation acc: 0.21875
Epoch 13
20 / 28 : loss = 2.18644452095Training loss: 2.20171236992
Training acc: 0.160714285714
Validation acc: 0.15625
Epoch 14
20 / 28 : loss = 2.19224405289Training loss: 2.18213510513
Training acc: 0.172991071429
Validation acc: 0.166666666667
Epoch 15
Training loss: 2.1600205898349
Training acc: 0.157366071429
Validation acc: 0.21875
Epoch 16
Training loss: 2.1420128345552
Training acc: 0.15625
Validation acc: 0.1875
Epoch 17
20 / 28 : loss = 2.12167334557Training loss: 2.11643838882
Training acc: 0.165178571429
Validation acc: 0.15625
Epoch 18
20 / 28 : loss = 2.11204791069Training loss: 2.10665345192
Training acc: 0.149553571429
Validation acc: 0.197916666667
Epoch 19
20 / 28 : loss = 2.04727411279Training loss: 2.05325126648
Training acc: 0.186383928571
Validation acc: 0.25
Epoch 20
Training loss: 2.0570318698967
Training acc: 0.157366071429
Validation acc: 0.166666666667
Testing acc: 0.179435483871
Epoch 21
Training loss: 2.0788633823474
Training acc: 0.162946428571
Validation acc: 0.208333333333
Epoch 22
20 / 28 : loss = 2.03666639328Training loss: 2.03138518333
Training acc: 0.172991071429
Validation acc: 0.1875
Epoch 23
20 / 28 : loss = 2.04808092117Training loss: 2.06921982765
Training acc: 0.138392857143
Validation acc: 0.270833333333
Epoch 24
Training loss: 2.0255033969954
Training acc: 0.169642857143
Validation acc: 0.145833333333
Epoch 25
20 / 28 : loss = 2.02024412155Training loss: 2.03796696663
Training acc: 0.145089285714
Validation acc: 0.21875
Epoch 26
20 / 28 : loss = 2.02182340622Training loss: 2.01922869682
Training acc: 0.166294642857
Validation acc: 0.125
Epoch 27
20 / 28 : loss = 2.01994252205Training loss: 2.00387239456
Training acc: 0.181919642857
Validation acc: 0.166666666667
Epoch 28
20 / 28 : loss = 2.00767207146Training loss: 2.00533175468
Training acc: 0.166294642857
Validation acc: 0.166666666667
Epoch 29
Training loss: 1.9885283708659
Training acc: 0.176339285714
Validation acc: 0.15625
Epoch 30
Training loss: 2.0061295032501
Training acc: 0.147321428571
Validation acc: 0.197916666667
Epoch 31
Training loss: 1.9901367425968
Training acc: 0.1484375
Validation acc: 0.125
Epoch 32
20 / 28 : loss = 2.00286054611Training loss: 1.98304438591
Training acc: 0.157366071429
Validation acc: 0.114583333333
Epoch 33
Training loss: 1.9661368131679
Training acc: 0.180803571429
Validation acc: 0.239583333333
Epoch 34
Training loss: 1.9894603490871
Training acc: 0.152901785714
Validation acc: 0.229166666667
Epoch 35
20 / 28 : loss = 1.94629883766Training loss: 1.97041118145
Training acc: 0.1796875
Validation acc: 0.09375
Epoch 36
20 / 28 : loss = 1.97341597089Training loss: 1.963976264
Training acc: 0.180803571429
Validation acc: 0.166666666667
Epoch 37
20 / 28 : loss = 1.95536935329Training loss: 1.9586840868
Training acc: 0.181919642857
Validation acc: 0.166666666667
Epoch 38
Training loss: 1.9426494836805
Training acc: 0.189732142857
Validation acc: 0.177083333333
Epoch 39
20 / 28 : loss = 1.96530914307Training loss: 1.95194339752
Training acc: 0.170758928571
Validation acc: 0.239583333333
Epoch 40
20 / 28 : loss = 1.96339631081Training loss: 1.9663850069
Training acc: 0.147321428571
Validation acc: 0.208333333333
Testing acc: 0.16935483871
Epoch 41
20 / 28 : loss = 1.92066681385Training loss: 1.92687320709
Training acc: 0.169642857143
Validation acc: 0.145833333333
Epoch 42
20 / 28 : loss = 1.93614327908Training loss: 1.93319737911
Training acc: 0.172991071429
Validation acc: 0.197916666667
Epoch 43
20 / 28 : loss = 1.94366359711Training loss: 1.94387793541
Training acc: 0.155133928571
Validation acc: 0.15625
Epoch 44
20 / 28 : loss = 1.93024420738Training loss: 1.93570458889
Training acc: 0.165178571429
Validation acc: 0.208333333333
Epoch 45
20 / 28 : loss = 1.93134820461Training loss: 1.93298363686
Training acc: 0.184151785714
Validation acc: 0.114583333333
Epoch 46
Training loss: 1.9416010379866
Training acc: 0.170758928571
Validation acc: 0.166666666667
Epoch 47
20 / 28 : loss = 1.93955254555Training loss: 1.93466675282
Training acc: 0.160714285714
Validation acc: 0.09375
Epoch 48
20 / 28 : loss = 1.94074213505Training loss: 1.93865680695
Training acc: 0.159598214286
Validation acc: 0.166666666667
Epoch 49
Training loss: 1.9279583692636
Training acc: 0.165178571429
Validation acc: 0.197916666667
Epoch 50
Training loss: 1.9213804006605
Training acc: 0.194196428571
Validation acc: 0.197916666667
Epoch 51
Training loss: 1.9227058887508
Training acc: 0.1796875
Validation acc: 0.25
Epoch 52
Training loss: 1.9330718517328
Training acc: 0.168526785714
Validation acc: 0.177083333333
Epoch 53
20 / 28 : loss = 1.91327047348Training loss: 1.92039597034
Training acc: 0.1875
Validation acc: 0.145833333333
Epoch 54
Training loss: 1.9175431728474
Training acc: 0.1875
Validation acc: 0.260416666667
Epoch 55
Training loss: 1.9226757288402
Training acc: 0.151785714286
Validation acc: 0.145833333333
Epoch 56
20 / 28 : loss = 1.90120971203Training loss: 1.90695178509
Training acc: 0.183035714286
Validation acc: 0.0833333333333
Epoch 57
Training loss: 1.9218080043853
Training acc: 0.180803571429
Validation acc: 0.135416666667
Epoch 58
20 / 28 : loss = 1.91501474386Training loss: 1.91968905926
Training acc: 0.161830357143
Validation acc: 0.166666666667
Epoch 59
20 / 28 : loss = 1.91342675686Training loss: 1.9107054472
Training acc: 0.190848214286
Validation acc: 0.104166666667
Epoch 60
20 / 28 : loss = 1.92812633514Training loss: 1.91544282436
Training acc: 0.172991071429
Validation acc: 0.15625
Testing acc: 0.15625
Epoch 61
20 / 28 : loss = 1.90790832043Training loss: 1.91370236874
Training acc: 0.160714285714
Validation acc: 0.197916666667
Epoch 62
20 / 28 : loss = 1.89869725704Training loss: 1.9033011198
Training acc: 0.170758928571
Validation acc: 0.145833333333
Epoch 63
20 / 28 : loss = 1.91650152206Training loss: 1.90802836418
Training acc: 0.213169642857
Validation acc: 0.15625
Epoch 64
20 / 28 : loss = 1.91981160641Training loss: 1.9196344614
Training acc: 0.158482142857
Validation acc: 0.135416666667
Epoch 65
20 / 28 : loss = 1.92053914071Training loss: 1.92666316032
Training acc: 0.158482142857
Validation acc: 0.125
Epoch 66
20 / 28 : loss = 1.90604162216Training loss: 1.91146755219
Training acc: 0.165178571429
Validation acc: 0.208333333333
Epoch 67
20 / 28 : loss = 1.89926111698Training loss: 1.89793968201
Training acc: 0.194196428571
Validation acc: 0.145833333333
Epoch 68
Training loss: 1.9099209308627
Training acc: 0.149553571429
Validation acc: 0.208333333333
Epoch 69
Training loss: 1.9004898071318
Training acc: 0.1953125
Validation acc: 0.125
Epoch 70
20 / 28 : loss = 1.89756453037Training loss: 1.89840197563
Training acc: 0.162946428571
Validation acc: 0.15625
Epoch 71
Training loss: 1.9016877412843
Training acc: 0.176339285714
Validation acc: 0.135416666667
Epoch 72
20 / 28 : loss = 1.89014792442Training loss: 1.89383149147
Training acc: 0.183035714286
Validation acc: 0.1875
Epoch 73
20 / 28 : loss = 1.90477645397Training loss: 1.89981734753
Training acc: 0.152901785714
Validation acc: 0.145833333333
Epoch 74
20 / 28 : loss = 1.88417708874Training loss: 1.89517569542
Training acc: 0.183035714286
Validation acc: 0.104166666667
Epoch 75
Training loss: 1.8964802026788
Training acc: 0.168526785714
Validation acc: 0.208333333333
Epoch 76
20 / 28 : loss = 1.90436828136Training loss: 1.9085444212
Training acc: 0.170758928571
Validation acc: 0.197916666667
Epoch 77
Training loss: 1.9105951786242
Training acc: 0.176339285714
Validation acc: 0.166666666667
Epoch 78
Training loss: 1.8809868097314
Training acc: 0.181919642857
Validation acc: 0.114583333333
Epoch 79
Training loss: 1.8974514007699
Training acc: 0.180803571429
Validation acc: 0.21875
Epoch 80
20 / 28 : loss = 1.90049386024Training loss: 1.89709949493
Training acc: 0.181919642857
Validation acc: 0.1875
Testing acc: 0.158266129032
Epoch 81
20 / 28 : loss = 1.89049220085Training loss: 1.89391255379
Training acc: 0.169642857143
Validation acc: 0.197916666667
Epoch 82
Training loss: 1.8874009847627
Training acc: 0.181919642857
Validation acc: 0.1875
Epoch 83
20 / 28 : loss = 1.89400446415Training loss: 1.89220297337
Training acc: 0.168526785714
Validation acc: 0.177083333333
Epoch 84
Training loss: 1.8829857111365
Training acc: 0.185267857143
Validation acc: 0.145833333333
Epoch 85
20 / 28 : loss = 1.88851261139Training loss: 1.89070701599
Training acc: 0.181919642857
Validation acc: 0.125
Epoch 86
20 / 28 : loss = 1.90674412251Training loss: 1.90199291706
Training acc: 0.158482142857
Validation acc: 0.1875
Epoch 87
20 / 28 : loss = 1.87991654873Training loss: 1.88068258762
Training acc: 0.168526785714
Validation acc: 0.15625
Epoch 88
Training loss: 1.8911615610128
Training acc: 0.1484375
Validation acc: 0.104166666667
Epoch 89
Training loss: 1.8754155635869
Training acc: 0.166294642857
Validation acc: 0.177083333333
Epoch 90
20 / 28 : loss = 1.90000224113Training loss: 1.89837241173
Training acc: 0.157366071429
Validation acc: 0.260416666667
Epoch 91
Training loss: 1.8867255449329
Training acc: 0.177455357143
Validation acc: 0.239583333333
Epoch 92
20 / 28 : loss = 1.87669587135Training loss: 1.88031673431
Training acc: 0.185267857143
Validation acc: 0.15625
Epoch 93
20 / 28 : loss = 1.87305176258Training loss: 1.87321960926
Training acc: 0.176339285714
Validation acc: 0.229166666667
Epoch 94
Training loss: 1.8716629743625
Training acc: 0.196428571429
Validation acc: 0.21875
Epoch 95
Training loss: 1.8794879913332
Training acc: 0.165178571429
Validation acc: 0.09375
Epoch 96
Training loss: 1.8787820339225
Training acc: 0.174107142857
Validation acc: 0.208333333333
Epoch 97
20 / 28 : loss = 1.87595009804Training loss: 1.87612450123
Training acc: 0.172991071429
Validation acc: 0.239583333333
Epoch 98
Training loss: 1.8851683139833
Training acc: 0.174107142857
Validation acc: 0.208333333333
Epoch 99
20 / 28 : loss = 1.88902592659Training loss: 1.88599026203
Training acc: 0.170758928571
Validation acc: 0.1875

**************************************

qa15_basic-deduction
vocab = [u'.', u'?', u'Cats', u'Emily', u'Gertrude', u'Jessica', u'Mice', u'Sheep', u'What', u'Winona', u'Wolves', u'a', u'afraid', u'are', u'cat', u'cats', u'emily', u'gertrude', u'is', u'jessica', u'mice', u'mouse', u'of', u'sheep', u'winona', u'wolf', u'wolves']
word_idx = {u'Gertrude': 5, u'Sheep': 8, u'What': 9, u'is': 19, u'Cats': 3, u'are': 14, u'mouse': 22, u'Wolves': 11, u'emily': 17, u'gertrude': 18, u'afraid': 13, u'Jessica': 6, u'.': 1, u'Winona': 10, u'cats': 16, u'Mice': 7, u'?': 2, u'sheep': 24, u'jessica': 20, u'winona': 25, u'mice': 21, u'a': 12, u'of': 23, u'cat': 15, u'wolf': 26, u'wolves': 27, u'Emily': 4}
X.shape = (1000, 8, 6)
Xq.shape = (1000, 6)
Y.shape = (1000, 28)
story_maxlen, sentence_maxlen, query_maxlen = 8, 6, 6
max_epochs = 100
Epoch 0
Training loss: 13.544419288664
Training acc: 0.270089285714
Validation acc: 0.197916666667
Testing acc: 0.23689516129
Epoch 1
Training loss: 4.6512665748654
Training acc: 0.284598214286
Validation acc: 0.4375
Epoch 2
20 / 28 : loss = 4.47720956802Training loss: 4.26075267792
Training acc: 0.208705357143
Validation acc: 0.28125
Epoch 3
Training loss: 3.7128562927255
Training acc: 0.247767857143
Validation acc: 0.34375
Epoch 4
20 / 28 : loss = 3.52808880806Training loss: 3.45961833
Training acc: 0.233258928571
Validation acc: 0.427083333333
Epoch 5
Training loss: 3.2149460315755
Training acc: 0.2421875
Validation acc: 0.25
Epoch 6
Training loss: 3.1401636600592
Training acc: 0.225446428571
Validation acc: 0.145833333333
Epoch 7
Training loss: 2.9477570056934
Training acc: 0.241071428571
Validation acc: 0.270833333333
Epoch 8
Training loss: 2.8703150749229
Training acc: 0.262276785714
Validation acc: 0.239583333333
Epoch 9
Training loss: 2.7452769279552
Training acc: 0.260044642857
Validation acc: 0.177083333333
Epoch 10
Training loss: 2.6103498935742
Training acc: 0.283482142857
Validation acc: 0.28125
Epoch 11
20 / 28 : loss = 2.61363673217Training loss: 2.63327479362
Training acc: 0.266741071429
Validation acc: 0.145833333333
Epoch 12
20 / 28 : loss = 2.57693457603Training loss: 2.53746581078
Training acc: 0.235491071429
Validation acc: 0.239583333333
Epoch 13
20 / 28 : loss = 2.49179577827Training loss: 2.46126103401
Training acc: 0.2421875
Validation acc: 0.354166666667
Epoch 14
20 / 28 : loss = 2.42292928696Training loss: 2.4164891243
Training acc: 0.271205357143
Validation acc: 0.25
Epoch 15
Training loss: 2.3435397148161
Training acc: 0.291294642857
Validation acc: 0.25
Epoch 16
20 / 28 : loss = 2.40694832802Training loss: 2.36264562607
Training acc: 0.258928571429
Validation acc: 0.21875
Epoch 17
20 / 28 : loss = 2.31596159935Training loss: 2.28124904633
Training acc: 0.275669642857
Validation acc: 0.354166666667
Epoch 18
20 / 28 : loss = 2.18503165245Training loss: 2.27660751343
Training acc: 0.305803571429
Validation acc: 0.239583333333
Epoch 19
20 / 28 : loss = 2.23268008232Training loss: 2.22719144821
Training acc: 0.215401785714
Validation acc: 0.291666666667
Epoch 20
20 / 28 : loss = 2.19042158127Training loss: 2.16814470291
Training acc: 0.2578125
Validation acc: 0.270833333333
Testing acc: 0.20564516129
Epoch 21
Training loss: 2.1711134910689
Training acc: 0.283482142857
Validation acc: 0.1875
Epoch 22
20 / 28 : loss = 2.14624738693Training loss: 2.13524055481
Training acc: 0.267857142857
Validation acc: 0.229166666667
Epoch 23
20 / 28 : loss = 2.04371094704Training loss: 2.04886746407
Training acc: 0.295758928571
Validation acc: 0.1875
Epoch 24
20 / 28 : loss = 2.11040806772Training loss: 2.08857774734
Training acc: 0.245535714286
Validation acc: 0.427083333333
Epoch 25
20 / 28 : loss = 2.07219910622Training loss: 2.07598280907
Training acc: 0.238839285714
Validation acc: 0.177083333333
Epoch 26
20 / 28 : loss = 2.05737185478Training loss: 2.04003739357
Training acc: 0.2421875
Validation acc: 0.260416666667
Epoch 27
20 / 28 : loss = 2.05552840233Training loss: 2.03674197197
Training acc: 0.247767857143
Validation acc: 0.270833333333
Epoch 28
Training loss: 1.9819301366814
Training acc: 0.295758928571
Validation acc: 0.1875
Epoch 29
Training loss: 1.9481395483459
Training acc: 0.295758928571
Validation acc: 0.34375
Epoch 30
20 / 28 : loss = 1.96624231339Training loss: 1.98697531223
Training acc: 0.243303571429
Validation acc: 0.3125
Epoch 31
Training loss: 1.9412965774598
Training acc: 0.246651785714
Validation acc: 0.145833333333
Epoch 32
20 / 28 : loss = 1.92735528946Training loss: 1.90047752857
Training acc: 0.260044642857
Validation acc: 0.197916666667
Epoch 33
20 / 28 : loss = 1.93744039536Training loss: 1.92721807957
Training acc: 0.237723214286
Validation acc: 0.34375
Epoch 34
Training loss: 1.8939744234187
Training acc: 0.274553571429
Validation acc: 0.260416666667
Epoch 35
20 / 28 : loss = 1.86045360565Training loss: 1.84969365597
Training acc: 0.333705357143
Validation acc: 0.166666666667
Epoch 36
20 / 28 : loss = 1.86836755276Training loss: 1.89089560509
Training acc: 0.256696428571
Validation acc: 0.166666666667
Epoch 37
20 / 28 : loss = 1.82987248898Training loss: 1.84936928749
Training acc: 0.237723214286
Validation acc: 0.322916666667
Epoch 38
20 / 28 : loss = 1.84206283092Training loss: 1.84276676178
Training acc: 0.263392857143
Validation acc: 0.166666666667
Epoch 39
Training loss: 1.8334816694384
Training acc: 0.270089285714
Validation acc: 0.291666666667
Epoch 40
20 / 28 : loss = 1.81181538105Training loss: 1.81088709831
Training acc: 0.248883928571
Validation acc: 0.239583333333
Testing acc: 0.210685483871
Epoch 41
20 / 28 : loss = 1.7933229208Training loss: 1.8053072691
Training acc: 0.28125
Validation acc: 0.21875
Epoch 42
Training loss: 1.8224686384217
Training acc: 0.227678571429
Validation acc: 0.291666666667
Epoch 43
Training loss: 1.8034764528322
Training acc: 0.263392857143
Validation acc: 0.145833333333
Epoch 44
20 / 28 : loss = 1.79740703106Training loss: 1.78471255302
Training acc: 0.291294642857
Validation acc: 0.15625
Epoch 45
Training loss: 1.7762969732362
Training acc: 0.271205357143
Validation acc: 0.270833333333
Epoch 46
Training loss: 1.7615019083565
Training acc: 0.246651785714
Validation acc: 0.3125
Epoch 47
20 / 28 : loss = 1.71725952625Training loss: 1.7240293026
Training acc: 0.301339285714
Validation acc: 0.197916666667
Epoch 48
20 / 28 : loss = 1.73994195461Training loss: 1.72991061211
Training acc: 0.296875
Validation acc: 0.177083333333
Epoch 49
20 / 28 : loss = 1.71297633648Training loss: 1.72214913368
Training acc: 0.2890625
Validation acc: 0.1875
Epoch 50
Training loss: 1.7147184610444
Training acc: 0.290178571429
Validation acc: 0.177083333333
Epoch 51
20 / 28 : loss = 1.72982048988Training loss: 1.74053752422
Training acc: 0.282366071429
Validation acc: 0.3125
Epoch 52
20 / 28 : loss = 1.69008314615Training loss: 1.69223725796
Training acc: 0.277901785714
Validation acc: 0.15625
Epoch 53
20 / 28 : loss = 1.80718266964Training loss: 1.77788233757
Training acc: 0.2578125
Validation acc: 0.302083333333
Epoch 54
20 / 28 : loss = 1.67568385601Training loss: 1.69918477535
Training acc: 0.277901785714
Validation acc: 0.197916666667
Epoch 55
20 / 28 : loss = 1.69930958748Training loss: 1.70697021484
Training acc: 0.287946428571
Validation acc: 0.28125
Epoch 56
Training loss: 1.6951516866731
Training acc: 0.260044642857
Validation acc: 0.260416666667
Epoch 57
20 / 28 : loss = 1.71130728722Training loss: 1.71085333824
Training acc: 0.247767857143
Validation acc: 0.197916666667
Epoch 58
20 / 28 : loss = 1.72748005398Training loss: 1.7104537487
Training acc: 0.263392857143
Validation acc: 0.260416666667
Epoch 59
20 / 28 : loss = 1.69078612328Training loss: 1.69078505039
Training acc: 0.265625
Validation acc: 0.260416666667
Epoch 60
Training loss: 1.6822357177766
Training acc: 0.265625
Validation acc: 0.322916666667
Testing acc: 0.23185483871
Epoch 61
20 / 28 : loss = 1.64961910248Training loss: 1.66458964348
Training acc: 0.279017857143
Validation acc: 0.197916666667
Epoch 62
20 / 28 : loss = 1.68316364288Training loss: 1.69921839237
Training acc: 0.2421875
Validation acc: 0.270833333333
Epoch 63
Training loss: 1.6414569616394
Training acc: 0.292410714286
Validation acc: 0.197916666667
Epoch 64
Training loss: 1.6518487930332
Training acc: 0.28125
Validation acc: 0.3125
Epoch 65
20 / 28 : loss = 1.64702117443Training loss: 1.63969683647
Training acc: 0.3046875
Validation acc: 0.177083333333
Epoch 66
Training loss: 1.6596148014129
Training acc: 0.255580357143
Validation acc: 0.302083333333
Epoch 67
Training loss: 1.6479629278297
Training acc: 0.28125
Validation acc: 0.34375
Epoch 68
Training loss: 1.6537230014826
Training acc: 0.258928571429
Validation acc: 0.3125
Epoch 69
20 / 28 : loss = 1.64558053017Training loss: 1.64338779449
Training acc: 0.260044642857
Validation acc: 0.291666666667
Epoch 70
20 / 28 : loss = 1.62817764282Training loss: 1.6559445858
Training acc: 0.2890625
Validation acc: 0.21875
Epoch 71
Training loss: 1.6525936126743
Training acc: 0.28125
Validation acc: 0.270833333333
Epoch 72
20 / 28 : loss = 1.63301026821Training loss: 1.63890576363
Training acc: 0.268973214286
Validation acc: 0.166666666667
Epoch 73
Training loss: 1.6306316852693
Training acc: 0.293526785714
Validation acc: 0.3125
Epoch 74
20 / 28 : loss = 1.60607016087Training loss: 1.60913479328
Training acc: 0.271205357143
Validation acc: 0.197916666667
Epoch 75
20 / 28 : loss = 1.61452305317Training loss: 1.60967051983
Training acc: 0.292410714286
Validation acc: 0.229166666667
Epoch 76
20 / 28 : loss = 1.60465562344Training loss: 1.60539722443
Training acc: 0.294642857143
Validation acc: 0.3125
Epoch 77
20 / 28 : loss = 1.62346446514Training loss: 1.62665677071
Training acc: 0.275669642857
Validation acc: 0.302083333333
Epoch 78
20 / 28 : loss = 1.6025480032Training loss: 1.60273969173
Training acc: 0.279017857143
Validation acc: 0.291666666667
Epoch 79
20 / 28 : loss = 1.58353137978Training loss: 1.5787101984
Training acc: 0.305803571429
Validation acc: 0.291666666667
Epoch 80
20 / 28 : loss = 1.59664630896Training loss: 1.60927319527
Training acc: 0.271205357143
Validation acc: 0.333333333333
Testing acc: 0.283266129032
Epoch 81
Training loss: 1.5914825201126
Training acc: 0.287946428571
Validation acc: 0.302083333333
Epoch 82
20 / 28 : loss = 1.59007370472Training loss: 1.59814453125
Training acc: 0.272321428571
Validation acc: 0.395833333333
Epoch 83
Training loss: 1.5949815511754
Training acc: 0.294642857143
Validation acc: 0.21875
Epoch 84
Training loss: 1.6011494398195
Training acc: 0.262276785714
Validation acc: 0.458333333333
Epoch 85
Training loss: 1.5736778974529
Training acc: 0.267857142857
Validation acc: 0.21875
Epoch 86
Training loss: 1.5573982000448
Training acc: 0.316964285714
Validation acc: 0.25
Epoch 87
20 / 28 : loss = 1.55010640621Training loss: 1.56344425678
Training acc: 0.340401785714
Validation acc: 0.260416666667
Epoch 88
Training loss: 1.5276129245894
Training acc: 0.34375
Validation acc: 0.302083333333
Epoch 89
Training loss: 1.4628883600242
Training acc: 0.401785714286
Validation acc: 0.197916666667
Epoch 90
20 / 28 : loss = 1.48527526855Training loss: 1.47555088997
Training acc: 0.380580357143
Validation acc: 0.479166666667
Epoch 91
Training loss: 1.4357759952562
Training acc: 0.391741071429
Validation acc: 0.4375
Epoch 92
Training loss: 1.4044429063876
Training acc: 0.4296875
Validation acc: 0.40625
Epoch 93
20 / 28 : loss = 1.41746044159Training loss: 1.45116209984
Training acc: 0.3984375
Validation acc: 0.447916666667
Epoch 94
Training loss: 1.3772937059494
Training acc: 0.450892857143
Validation acc: 0.302083333333
Epoch 95
Training loss: 1.3624155521453
Training acc: 0.428571428571
Validation acc: 0.458333333333
Epoch 96
20 / 28 : loss = 1.33707857132Training loss: 1.35271537304
Training acc: 0.46875
Validation acc: 0.583333333333
Epoch 97
Training loss: 1.3311703205127
Training acc: 0.469866071429
Validation acc: 0.46875
Epoch 98
20 / 28 : loss = 1.31651270397Training loss: 1.31595039368
Training acc: 0.502232142857
Validation acc: 0.364583333333
Epoch 99
20 / 28 : loss = 1.34995245934Training loss: 1.33324897289
Training acc: 0.483258928571
Validation acc: 0.416666666667

**************************************

qa16_basic-induction
vocab = [u'.', u'?', u'Bernhard', u'Brian', u'Greg', u'Julius', u'Lily', u'What', u'a', u'color', u'frog', u'gray', u'green', u'is', u'lion', u'rhino', u'swan', u'white', u'yellow']
word_idx = {u'a': 9, u'gray': 12, u'What': 8, u'Julius': 6, u'is': 14, u'swan': 17, u'lion': 15, u'frog': 11, u'.': 1, u'Brian': 4, u'color': 10, u'Greg': 5, u'Bernhard': 3, u'yellow': 19, u'green': 13, u'white': 18, u'rhino': 16, u'Lily': 7, u'?': 2}
X.shape = (1000, 9, 5)
Xq.shape = (1000, 5)
Y.shape = (1000, 20)
story_maxlen, sentence_maxlen, query_maxlen = 9, 5, 5
max_epochs = 100
Epoch 0
Training loss: 50.838237762558
Training acc: 0.248883928571
Validation acc: 0.197916666667
Testing acc: 0.23689516129
Epoch 1
Training loss: 19.763088226378
Training acc: 0.2421875
Validation acc: 0.25
Epoch 2
Training loss: 15.791578292845
Training acc: 0.244419642857
Validation acc: 0.197916666667
Epoch 3
Training loss: 13.514573097202
Training acc: 0.253348214286
Validation acc: 0.395833333333
Epoch 4
Training loss: 12.773009300209
Training acc: 0.227678571429
Validation acc: 0.322916666667
Epoch 5
20 / 28 : loss = 9.34392356873Training loss: 9.10069942474
Training acc: 0.254464285714
Validation acc: 0.260416666667
Epoch 6
20 / 28 : loss = 8.73867416382Training loss: 9.12199115753
Training acc: 0.264508928571
Validation acc: 0.197916666667
Epoch 7
Training loss: 8.973502159129
Training acc: 0.251116071429
Validation acc: 0.260416666667
Epoch 8
Training loss: 8.1502704620496
Training acc: 0.255580357143
Validation acc: 0.239583333333
Epoch 9
Training loss: 8.0502805709812
Training acc: 0.238839285714
Validation acc: 0.25
Epoch 10
20 / 28 : loss = 7.28333616257Training loss: 7.17547941208
Training acc: 0.266741071429
Validation acc: 0.197916666667
Epoch 11
20 / 28 : loss = 7.20769166946Training loss: 7.18729543686
Training acc: 0.255580357143
Validation acc: 0.270833333333
Epoch 12
20 / 28 : loss = 6.96875953674Training loss: 6.70368289948
Training acc: 0.232142857143
Validation acc: 0.239583333333
Epoch 13
Training loss: 6.6600594520683
Training acc: 0.232142857143
Validation acc: 0.28125
Epoch 14
20 / 28 : loss = 6.15539455414Training loss: 6.02360677719
Training acc: 0.255580357143
Validation acc: 0.291666666667
Epoch 15
Training loss: 5.5865998268143
Training acc: 0.239955357143
Validation acc: 0.3125
Epoch 16
20 / 28 : loss = 5.94859743118Training loss: 6.08603048325
Training acc: 0.262276785714
Validation acc: 0.166666666667
Epoch 17
20 / 28 : loss = 5.28830862045Training loss: 4.9801363945
Training acc: 0.254464285714
Validation acc: 0.166666666667
Epoch 18
20 / 28 : loss = 5.05936098099Training loss: 5.00586748123
Training acc: 0.241071428571
Validation acc: 0.239583333333
Epoch 19
Training loss: 4.7640929222155
Training acc: 0.271205357143
Validation acc: 0.25
Epoch 20
Training loss: 4.9365296363826
Training acc: 0.245535714286
Validation acc: 0.25
Testing acc: 0.25
Epoch 21
Training loss: 4.3967962265346
Training acc: 0.235491071429
Validation acc: 0.291666666667
Epoch 22
Training loss: 4.3209242820734
Training acc: 0.252232142857
Validation acc: 0.270833333333
Epoch 23
Training loss: 4.7937622070326
Training acc: 0.263392857143
Validation acc: 0.270833333333
Epoch 24
20 / 28 : loss = 4.54653787613Training loss: 4.44981622696
Training acc: 0.233258928571
Validation acc: 0.291666666667
Epoch 25
20 / 28 : loss = 3.64753246307Training loss: 3.79827475548
Training acc: 0.2734375
Validation acc: 0.28125
Epoch 26
Training loss: 3.7542293071751
Training acc: 0.241071428571
Validation acc: 0.270833333333
Epoch 27
Training loss: 4.0718431472849
Training acc: 0.25
Validation acc: 0.260416666667
Epoch 28
20 / 28 : loss = 3.74011850357Training loss: 3.78364348412
Training acc: 0.2421875
Validation acc: 0.302083333333
Epoch 29
20 / 28 : loss = 4.26149511337Training loss: 4.10284090042
Training acc: 0.253348214286
Validation acc: 0.302083333333
Epoch 30
Training loss: 3.9051697254254
Training acc: 0.238839285714
Validation acc: 0.21875
Epoch 31
20 / 28 : loss = 3.59621071815Training loss: 3.39222669601
Training acc: 0.276785714286
Validation acc: 0.270833333333
Epoch 32
Training loss: 3.3711688518599
Training acc: 0.261160714286
Validation acc: 0.260416666667
Epoch 33
20 / 28 : loss = 3.11777138718Training loss: 3.15347933769
Training acc: 0.287946428571
Validation acc: 0.229166666667
Epoch 34
Training loss: 3.5282166004207
Training acc: 0.239955357143
Validation acc: 0.291666666667
Epoch 35
20 / 28 : loss = 3.59559011459Training loss: 3.51936864853
Training acc: 0.239955357143
Validation acc: 0.229166666667
Epoch 36
Training loss: 3.3801074028261
Training acc: 0.245535714286
Validation acc: 0.322916666667
Epoch 37
Training loss: 3.3550522327448
Training acc: 0.261160714286
Validation acc: 0.28125
Epoch 38
20 / 28 : loss = 2.97422099113Training loss: 3.0230755806
Training acc: 0.265625
Validation acc: 0.291666666667
Epoch 39
Training loss: 3.2781925201426
Training acc: 0.2734375
Validation acc: 0.229166666667
Epoch 40
20 / 28 : loss = 3.43921732903Training loss: 3.28515005112
Training acc: 0.243303571429
Validation acc: 0.21875
Testing acc: 0.257056451613
Epoch 41
Training loss: 3.1860520839754
Training acc: 0.256696428571
Validation acc: 0.291666666667
Epoch 42
Training loss: 3.0726344585444
Training acc: 0.2734375
Validation acc: 0.15625
Epoch 43
Training loss: 2.5375611782118
Training acc: 0.293526785714
Validation acc: 0.34375
Epoch 44
20 / 28 : loss = 3.28153419495Training loss: 3.14058661461
Training acc: 0.252232142857
Validation acc: 0.197916666667
Epoch 45
20 / 28 : loss = 2.88845992088Training loss: 2.84390521049
Training acc: 0.265625
Validation acc: 0.208333333333
Epoch 46
20 / 28 : loss = 2.96274757385Training loss: 2.89371109009
Training acc: 0.280133928571
Validation acc: 0.239583333333
Epoch 47
20 / 28 : loss = 2.46273040771Training loss: 2.56719708443
Training acc: 0.300223214286
Validation acc: 0.260416666667
Epoch 48
20 / 28 : loss = 2.76447463036Training loss: 2.66298079491
Training acc: 0.277901785714
Validation acc: 0.229166666667
Epoch 49
Training loss: 2.9175298214835
Training acc: 0.246651785714
Validation acc: 0.427083333333
Epoch 50
Training loss: 2.816097974781
Training acc: 0.274553571429
Validation acc: 0.15625
Epoch 51
Training loss: 2.9616961479211
Training acc: 0.241071428571
Validation acc: 0.260416666667
Epoch 52
Training loss: 2.7744791507737
Training acc: 0.246651785714
Validation acc: 0.229166666667
Epoch 53
Training loss: 2.4909443855369
Training acc: 0.282366071429
Validation acc: 0.291666666667
Epoch 54
Training loss: 2.5957584381132
Training acc: 0.302455357143
Validation acc: 0.302083333333
Epoch 55
20 / 28 : loss = 2.51357269287Training loss: 2.54488182068
Training acc: 0.280133928571
Validation acc: 0.270833333333
Epoch 56
Training loss: 2.5660195350639
Training acc: 0.270089285714
Validation acc: 0.25
Epoch 57
20 / 28 : loss = 2.45009207726Training loss: 2.37247514725
Training acc: 0.284598214286
Validation acc: 0.15625
Epoch 58
Training loss: 2.6328773498557
Training acc: 0.265625
Validation acc: 0.229166666667
Epoch 59
20 / 28 : loss = 2.43510055542Training loss: 2.57882881165
Training acc: 0.252232142857
Validation acc: 0.28125
Epoch 60
20 / 28 : loss = 2.58669638634Training loss: 2.47447514534
Training acc: 0.264508928571
Validation acc: 0.28125
Testing acc: 0.309475806452
Epoch 61
Training loss: 2.6637198925508
Training acc: 0.267857142857
Validation acc: 0.239583333333
Epoch 62
Training loss: 2.4623730182622
Training acc: 0.270089285714
Validation acc: 0.416666666667
Epoch 63
Training loss: 2.3058707714166
Training acc: 0.292410714286
Validation acc: 0.270833333333
Epoch 64
Training loss: 2.3344452381147
Training acc: 0.260044642857
Validation acc: 0.25
Epoch 65
20 / 28 : loss = 2.28913307198Training loss: 2.28481245041
Training acc: 0.286830357143
Validation acc: 0.260416666667
Epoch 66
Training loss: 2.2692875862133
Training acc: 0.256696428571
Validation acc: 0.333333333333
Epoch 67
20 / 28 : loss = 2.33806848526Training loss: 2.41295933723
Training acc: 0.274553571429
Validation acc: 0.260416666667
Epoch 68
Training loss: 2.2910625934683
Training acc: 0.272321428571
Validation acc: 0.260416666667
Epoch 69
Training loss: 2.1452507972743
Training acc: 0.285714285714
Validation acc: 0.395833333333
Epoch 70
20 / 28 : loss = 2.07701182365Training loss: 2.06045675278
Training acc: 0.306919642857
Validation acc: 0.3125
Epoch 71
20 / 28 : loss = 2.10763430595Training loss: 2.1413667202
Training acc: 0.287946428571
Validation acc: 0.3125
Epoch 72
20 / 28 : loss = 2.37201762199Training loss: 2.29858970642
Training acc: 0.255580357143
Validation acc: 0.3125
Epoch 73
Training loss: 2.2213714122829
Training acc: 0.2890625
Validation acc: 0.3125
Epoch 74
20 / 28 : loss = 2.20500254631Training loss: 2.16192317009
Training acc: 0.296875
Validation acc: 0.260416666667
Epoch 75
Training loss: 2.1258215904281
Training acc: 0.279017857143
Validation acc: 0.333333333333
Epoch 76
Training loss: 2.1676952838911
Training acc: 0.261160714286
Validation acc: 0.260416666667
Epoch 77
20 / 28 : loss = 2.12507915497Training loss: 2.1068046093
Training acc: 0.305803571429
Validation acc: 0.375
Epoch 78
Training loss: 2.0879037380228
Training acc: 0.315848214286
Validation acc: 0.416666666667
Epoch 79
20 / 28 : loss = 2.18911933899Training loss: 2.21249318123
Training acc: 0.280133928571
Validation acc: 0.260416666667
Epoch 80
20 / 28 : loss = 2.02401518822Training loss: 1.98177969456
Training acc: 0.3359375
Validation acc: 0.40625
Testing acc: 0.379032258065
Epoch 81
Training loss: 2.1182332038949
Training acc: 0.310267857143
Validation acc: 0.28125
Epoch 82
Training loss: 2.0058577060771
Training acc: 0.310267857143
Validation acc: 0.270833333333
Epoch 83
20 / 28 : loss = 1.94392848015Training loss: 1.92849671841
Training acc: 0.341517857143
Validation acc: 0.40625
Epoch 84
20 / 28 : loss = 1.81849670419Training loss: 1.89589393139
Training acc: 0.3515625
Validation acc: 0.28125
Epoch 85
20 / 28 : loss = 2.02198982239Training loss: 2.00594854355
Training acc: 0.313616071429
Validation acc: 0.489583333333
Epoch 86
Training loss: 1.9988762140345
Training acc: 0.330357142857
Validation acc: 0.364583333333
Epoch 87
Training loss: 1.8664754629129
Training acc: 0.361607142857
Validation acc: 0.375
Epoch 88
Training loss: 1.8338111639076
Training acc: 0.357142857143
Validation acc: 0.291666666667
Epoch 89
Training loss: 2.0811679363371
Training acc: 0.328125
Validation acc: 0.34375
Epoch 90
Training loss: 1.9400380849821
Training acc: 0.353794642857
Validation acc: 0.385416666667
Epoch 91
20 / 28 : loss = 1.80301427841Training loss: 1.83336091042
Training acc: 0.371651785714
Validation acc: 0.333333333333
Epoch 92
20 / 28 : loss = 1.81057333946Training loss: 1.86819541454
Training acc: 0.348214285714
Validation acc: 0.322916666667
Epoch 93
20 / 28 : loss = 1.87863790989Training loss: 1.89077353477
Training acc: 0.34375
Validation acc: 0.416666666667
Epoch 94
20 / 28 : loss = 1.72037255764Training loss: 1.73952758312
Training acc: 0.395089285714
Validation acc: 0.427083333333
Epoch 95
20 / 28 : loss = 1.94483280182Training loss: 1.9627686739
Training acc: 0.328125
Validation acc: 0.458333333333
Epoch 96
Training loss: 1.8650466203791
Training acc: 0.348214285714
Validation acc: 0.375
Epoch 97
Training loss: 1.8253928422961
Training acc: 0.379464285714
Validation acc: 0.270833333333
Epoch 98
20 / 28 : loss = 1.74206686029Training loss: 1.79489326477
Training acc: 0.377232142857
Validation acc: 0.333333333333
Epoch 99
20 / 28 : loss = 1.87335443497Training loss: 1.81672871113
Training acc: 0.376116071429
Validation acc: 0.25

**************************************

qa17_positional-reasoning
vocab = [u'.', u'?', u'Is', u'The', u'above', u'below', u'blue', u'is', u'left', u'no', u'of', u'pink', u'rectangle', u'red', u'right', u'sphere', u'square', u'the', u'to', u'triangle', u'yellow', u'yes']
word_idx = {u'right': 15, u'is': 8, u'yellow': 21, u'sphere': 16, u'square': 17, u'yes': 22, u'blue': 7, u'no': 10, u'.': 1, u'to': 19, u'above': 5, u'red': 14, u'?': 2, u'pink': 12, u'triangle': 20, u'The': 4, u'of': 11, u'Is': 3, u'below': 6, u'rectangle': 13, u'the': 18, u'left': 9}
X.shape = (1000, 2, 12)
Xq.shape = (1000, 12)
Y.shape = (1000, 23)
story_maxlen, sentence_maxlen, query_maxlen = 2, 12, 12
max_epochs = 100
Epoch 0
20 / 28 : loss = 4.84361791611Training loss: 4.13654327393
Training acc: 0.473214285714
Validation acc: 0.458333333333
Testing acc: 0.519153225806
Epoch 1
Training loss: 1.5068720579102
Training acc: 0.496651785714
Validation acc: 0.4375
Epoch 2
Training loss: 1.2179652452573
Training acc: 0.486607142857
Validation acc: 0.520833333333
Epoch 3
Training loss: 1.0891629457597
Training acc: 0.517857142857
Validation acc: 0.385416666667
Epoch 4
Training loss: 1.0625090599159
Training acc: 0.46875
Validation acc: 0.40625
Epoch 5
Training loss: 0.96360075473829
Training acc: 0.533482142857
Validation acc: 0.5
Epoch 6
Training loss: 0.96428012847902
Training acc: 0.478794642857
Validation acc: 0.510416666667
Epoch 7
Training loss: 0.91195535659895
Training acc: 0.495535714286
Validation acc: 0.510416666667
Epoch 8
Training loss: 0.89048111438812
Training acc: 0.511160714286
Validation acc: 0.479166666667
Epoch 9
Training loss: 0.87767612934149
Training acc: 0.495535714286
Validation acc: 0.4375
Epoch 10
Training loss: 0.86100846529309
Training acc: 0.493303571429
Validation acc: 0.46875
Epoch 11
20 / 28 : loss = 0.850388228893Training loss: 0.849627792835
Training acc: 0.5
Validation acc: 0.5
Epoch 12
20 / 28 : loss = 0.839022159576Training loss: 0.834991872311
Training acc: 0.503348214286
Validation acc: 0.489583333333
Epoch 13
20 / 28 : loss = 0.817234396935Training loss: 0.8221809268
Training acc: 0.491071428571
Validation acc: 0.427083333333
Epoch 14
20 / 28 : loss = 0.810040235519Training loss: 0.809743285179
Training acc: 0.481026785714
Validation acc: 0.447916666667
Epoch 15
Training loss: 0.79287087917337
Training acc: 0.496651785714
Validation acc: 0.5
Epoch 16
20 / 28 : loss = 0.785886943346Training loss: 0.799963533878
Training acc: 0.484375
Validation acc: 0.510416666667
Epoch 17
Training loss: 0.78892803192189
Training acc: 0.484375
Validation acc: 0.46875
Epoch 18
20 / 28 : loss = 0.796819150448Training loss: 0.790571212769
Training acc: 0.472098214286
Validation acc: 0.489583333333
Epoch 19
Training loss: 0.76454651355758
Training acc: 0.527901785714
Validation acc: 0.458333333333
Epoch 20
20 / 28 : loss = 0.766773343086Training loss: 0.771383345127
Training acc: 0.530133928571
Validation acc: 0.46875
Testing acc: 0.519153225806
Epoch 21
Training loss: 0.77512395381976
Training acc: 0.467633928571
Validation acc: 0.46875
Epoch 22
Training loss: 0.76007980108318
Training acc: 0.5234375
Validation acc: 0.520833333333
Epoch 23
20 / 28 : loss = 0.762778043747Training loss: 0.760854721069
Training acc: 0.493303571429
Validation acc: 0.4375
Epoch 24
20 / 28 : loss = 0.750313639641Training loss: 0.749247670174
Training acc: 0.511160714286
Validation acc: 0.53125
Epoch 25
20 / 28 : loss = 0.763298511505Training loss: 0.761896729469
Training acc: 0.478794642857
Validation acc: 0.510416666667
Epoch 26
20 / 28 : loss = 0.741205751896Training loss: 0.741337656975
Training acc: 0.521205357143
Validation acc: 0.520833333333
Epoch 27
Training loss: 0.74788033962267
Training acc: 0.5
Validation acc: 0.510416666667
Epoch 28
Training loss: 0.75176542997444
Training acc: 0.496651785714
Validation acc: 0.4375
Epoch 29
Training loss: 0.7446762323386
Training acc: 0.4921875
Validation acc: 0.572916666667
Epoch 30
Training loss: 0.74010211229329
Training acc: 0.517857142857
Validation acc: 0.572916666667
Epoch 31
20 / 28 : loss = 0.737504243851Training loss: 0.741686999798
Training acc: 0.487723214286
Validation acc: 0.53125
Epoch 32
Training loss: 0.73090994358122
Training acc: 0.535714285714
Validation acc: 0.416666666667
Epoch 33
Training loss: 0.73054033517825
Training acc: 0.518973214286
Validation acc: 0.5
Epoch 34
20 / 28 : loss = 0.743003547192Training loss: 0.741892337799
Training acc: 0.477678571429
Validation acc: 0.40625
Epoch 35
Training loss: 0.72987860441225
Training acc: 0.503348214286
Validation acc: 0.583333333333
Epoch 36
20 / 28 : loss = 0.733581185341Training loss: 0.730344176292
Training acc: 0.498883928571
Validation acc: 0.5
Epoch 37
Training loss: 0.72600394487402
Training acc: 0.511160714286
Validation acc: 0.416666666667
Epoch 38
Training loss: 0.72432982921602
Training acc: 0.516741071429
Validation acc: 0.46875
Epoch 39
Training loss: 0.73033189773626
Training acc: 0.488839285714
Validation acc: 0.46875
Epoch 40
20 / 28 : loss = 0.726718246937Training loss: 0.728484749794
Training acc: 0.486607142857
Validation acc: 0.489583333333
Testing acc: 0.480846774194
Epoch 41
Training loss: 0.72864180803317
Training acc: 0.491071428571
Validation acc: 0.5
Epoch 42
Training loss: 0.72239935398189
Training acc: 0.505580357143
Validation acc: 0.53125
Epoch 43
20 / 28 : loss = 0.720750153065Training loss: 0.719336211681
Training acc: 0.5
Validation acc: 0.427083333333
Epoch 44
20 / 28 : loss = 0.713201642036Training loss: 0.713084518909
Training acc: 0.53125
Validation acc: 0.583333333333
Epoch 45
20 / 28 : loss = 0.718276202679Training loss: 0.717483580112
Training acc: 0.518973214286
Validation acc: 0.46875
Epoch 46
20 / 28 : loss = 0.717550337315Training loss: 0.718456447124
Training acc: 0.505580357143
Validation acc: 0.479166666667
Epoch 47
20 / 28 : loss = 0.719944477081Training loss: 0.720127046108
Training acc: 0.483258928571
Validation acc: 0.489583333333
Epoch 48
20 / 28 : loss = 0.717057228088Training loss: 0.713528931141
Training acc: 0.493303571429
Validation acc: 0.479166666667
Epoch 49
Training loss: 0.71881198883111
Training acc: 0.502232142857
Validation acc: 0.510416666667
Epoch 50
Training loss: 0.70996230840753
Training acc: 0.506696428571
Validation acc: 0.447916666667
Epoch 51
20 / 28 : loss = 0.710113406181Training loss: 0.7113276124
Training acc: 0.510044642857
Validation acc: 0.510416666667
Epoch 52
20 / 28 : loss = 0.711015999317Training loss: 0.710327923298
Training acc: 0.527901785714
Validation acc: 0.458333333333
Epoch 53
Training loss: 0.71184873580954
Training acc: 0.511160714286
Validation acc: 0.510416666667
Epoch 54
20 / 28 : loss = 0.714992165565Training loss: 0.713389933109
Training acc: 0.489955357143
Validation acc: 0.552083333333
Epoch 55
Training loss: 0.71596133709574
Training acc: 0.505580357143
Validation acc: 0.46875
Epoch 56
Training loss: 0.70862573385252
Training acc: 0.506696428571
Validation acc: 0.479166666667
Epoch 57
20 / 28 : loss = 0.712534427643Training loss: 0.713253080845
Training acc: 0.501116071429
Validation acc: 0.510416666667
Epoch 58
Training loss: 0.71596097946264
Training acc: 0.494419642857
Validation acc: 0.583333333333
Epoch 59
20 / 28 : loss = 0.715176582336Training loss: 0.716340959072
Training acc: 0.483258928571
Validation acc: 0.46875
Epoch 60
20 / 28 : loss = 0.713084340096Training loss: 0.711844325066
Training acc: 0.512276785714
Validation acc: 0.479166666667
Testing acc: 0.519153225806
Epoch 61
Training loss: 0.71212822198941
Training acc: 0.491071428571
Validation acc: 0.479166666667
Epoch 62
Training loss: 0.71317225694708
Training acc: 0.5
Validation acc: 0.520833333333
Epoch 63
Training loss: 0.71246725320819
Training acc: 0.483258928571
Validation acc: 0.416666666667
Epoch 64
20 / 28 : loss = 0.712690412998Training loss: 0.713580310345
Training acc: 0.488839285714
Validation acc: 0.4375
Epoch 65
Training loss: 0.70521056652182
Training acc: 0.520089285714
Validation acc: 0.395833333333
Epoch 66
Training loss: 0.71228253841404
Training acc: 0.489955357143
Validation acc: 0.46875
Epoch 67
Training loss: 0.70882952213323
Training acc: 0.501116071429
Validation acc: 0.572916666667
Epoch 68
20 / 28 : loss = 0.710322618484Training loss: 0.711079061031
Training acc: 0.522321428571
Validation acc: 0.5
Epoch 69
Training loss: 0.71123611927503
Training acc: 0.501116071429
Validation acc: 0.510416666667
Epoch 70
Training loss: 0.71182185411556
Training acc: 0.494419642857
Validation acc: 0.447916666667
Epoch 71
20 / 28 : loss = 0.713036656383Training loss: 0.712380826473
Training acc: 0.464285714286
Validation acc: 0.5
Epoch 72
20 / 28 : loss = 0.711757004261Training loss: 0.71038210392
Training acc: 0.5078125
Validation acc: 0.59375
Epoch 73
20 / 28 : loss = 0.711824715137Training loss: 0.710518479347
Training acc: 0.504464285714
Validation acc: 0.510416666667
Epoch 74
Training loss: 0.70880270004357
Training acc: 0.5
Validation acc: 0.541666666667
Epoch 75
20 / 28 : loss = 0.703369379044Training loss: 0.707716286182
Training acc: 0.513392857143
Validation acc: 0.479166666667
Epoch 76
Training loss: 0.71248465776481
Training acc: 0.496651785714
Validation acc: 0.5
Epoch 77
20 / 28 : loss = 0.712313771248Training loss: 0.711330711842
Training acc: 0.508928571429
Validation acc: 0.46875
Epoch 78
20 / 28 : loss = 0.712137222292Training loss: 0.710876882076
Training acc: 0.493303571429
Validation acc: 0.458333333333
Epoch 79
Training loss: 0.71175944805153
Training acc: 0.5
Validation acc: 0.479166666667
Epoch 80
Training loss: 0.70778840780374
Training acc: 0.491071428571
Validation acc: 0.572916666667
Testing acc: 0.480846774194
Epoch 81
Training loss: 0.71101653575989
Training acc: 0.510044642857
Validation acc: 0.510416666667
Epoch 82
Training loss: 0.71151351928711
Training acc: 0.493303571429
Validation acc: 0.46875
Epoch 83
Training loss: 0.70838946104173
Training acc: 0.498883928571
Validation acc: 0.5
Epoch 84
20 / 28 : loss = 0.707960605621Training loss: 0.708043396473
Training acc: 0.483258928571
Validation acc: 0.4375
Epoch 85
20 / 28 : loss = 0.709755778313Training loss: 0.709943294525
Training acc: 0.520089285714
Validation acc: 0.510416666667
Epoch 86
Training loss: 0.70965331792816
Training acc: 0.486607142857
Validation acc: 0.552083333333
Epoch 87
20 / 28 : loss = 0.706891715527Training loss: 0.706013321877
Training acc: 0.495535714286
Validation acc: 0.40625
Epoch 88
Training loss: 0.70950633287437
Training acc: 0.486607142857
Validation acc: 0.53125
Epoch 89
20 / 28 : loss = 0.705257475376Training loss: 0.705564200878
Training acc: 0.498883928571
Validation acc: 0.46875
Epoch 90
Training loss: 0.70701462030421
Training acc: 0.496651785714
Validation acc: 0.5625
Epoch 91
20 / 28 : loss = 0.708527386189Training loss: 0.709978222847
Training acc: 0.488839285714
Validation acc: 0.479166666667
Epoch 92
Training loss: 0.70945125818373
Training acc: 0.478794642857
Validation acc: 0.541666666667
Epoch 93
20 / 28 : loss = 0.706160545349Training loss: 0.706498086452
Training acc: 0.495535714286
Validation acc: 0.40625
Epoch 94
20 / 28 : loss = 0.711087048054Training loss: 0.710853517056
Training acc: 0.469866071429
Validation acc: 0.458333333333
Epoch 95
Training loss: 0.70711022615413
Training acc: 0.517857142857
Validation acc: 0.489583333333
Epoch 96
Training loss: 0.70778471231578
Training acc: 0.4765625
Validation acc: 0.5625
Epoch 97
Training loss: 0.70678484439865
Training acc: 0.501116071429
Validation acc: 0.489583333333
Epoch 98
Training loss: 0.70832902193147
Training acc: 0.504464285714
Validation acc: 0.510416666667
Epoch 99
20 / 28 : loss = 0.707811117172Training loss: 0.708275735378
Training acc: 0.515625
Validation acc: 0.541666666667

**************************************

qa18_size-reasoning
vocab = [u'.', u'?', u'Does', u'Is', u'The', u'bigger', u'box', u'chest', u'chocolate', u'chocolates', u'container', u'fit', u'fits', u'in', u'inside', u'is', u'no', u'of', u'suitcase', u'than', u'the', u'yes']
word_idx = {u'is': 16, u'Does': 3, u'in': 14, u'yes': 22, u'container': 11, u'fit': 12, u'no': 17, u'chocolates': 10, u'.': 1, u'chest': 8, u'?': 2, u'chocolate': 9, u'fits': 13, u'The': 5, u'than': 20, u'bigger': 6, u'box': 7, u'of': 18, u'Is': 4, u'suitcase': 19, u'the': 21, u'inside': 15}
X.shape = (1000, 15, 10)
Xq.shape = (1000, 10)
Y.shape = (1000, 23)
story_maxlen, sentence_maxlen, query_maxlen = 15, 10, 10
max_epochs = 100
Epoch 0
20 / 28 : loss = 10.1340312958Training loss: 8.54543209076
Training acc: 0.486607142857
Validation acc: 0.541666666667
Testing acc: 0.53125
Epoch 1
20 / 28 : loss = 2.79063677788Training loss: 2.75999474525
Training acc: 0.494419642857
Validation acc: 0.427083333333
Epoch 2
20 / 28 : loss = 2.49903154373Training loss: 2.41203093529
Training acc: 0.475446428571
Validation acc: 0.427083333333
Epoch 3
20 / 28 : loss = 2.05164432526Training loss: 2.09286952019
Training acc: 0.491071428571
Validation acc: 0.583333333333
Epoch 4
20 / 28 : loss = 1.92121338844Training loss: 1.88062179089
Training acc: 0.4921875
Validation acc: 0.5625
Epoch 5
20 / 28 : loss = 1.89859712124Training loss: 1.84613919258
Training acc: 0.485491071429
Validation acc: 0.458333333333
Epoch 6
20 / 28 : loss = 1.70754599571Training loss: 1.76899933815
Training acc: 0.465401785714
Validation acc: 0.583333333333
Epoch 7
Training loss: 1.5707572698664
Training acc: 0.518973214286
Validation acc: 0.520833333333
Epoch 8
20 / 28 : loss = 1.53056955338Training loss: 1.51800405979
Training acc: 0.5
Validation acc: 0.447916666667
Epoch 9
20 / 28 : loss = 1.60388469696Training loss: 1.57253193855
Training acc: 0.472098214286
Validation acc: 0.46875
Epoch 10
Training loss: 1.4664438962911
Training acc: 0.496651785714
Validation acc: 0.4375
Epoch 11
20 / 28 : loss = 1.35504174232Training loss: 1.38222694397
Training acc: 0.497767857143
Validation acc: 0.395833333333
Epoch 12
Training loss: 1.2795382738106
Training acc: 0.525669642857
Validation acc: 0.5
Epoch 13
20 / 28 : loss = 1.27313339718Training loss: 1.27736473083
Training acc: 0.520089285714
Validation acc: 0.59375
Epoch 14
20 / 28 : loss = 1.30093300343Training loss: 1.27621567249
Training acc: 0.483258928571
Validation acc: 0.583333333333
Epoch 15
20 / 28 : loss = 1.23224842548Training loss: 1.24087584019
Training acc: 0.489955357143
Validation acc: 0.5
Epoch 16
20 / 28 : loss = 1.22560572624Training loss: 1.2027400732
Training acc: 0.494419642857
Validation acc: 0.458333333333
Epoch 17
20 / 28 : loss = 1.14087939262Training loss: 1.1984859705
Training acc: 0.511160714286
Validation acc: 0.53125
Epoch 18
20 / 28 : loss = 1.15338587761Training loss: 1.14206123352
Training acc: 0.458705357143
Validation acc: 0.458333333333
Epoch 19
20 / 28 : loss = 1.22519171238Training loss: 1.19522213936
Training acc: 0.464285714286
Validation acc: 0.458333333333
Epoch 20
20 / 28 : loss = 1.13618981838Training loss: 1.10964167118
Training acc: 0.496651785714
Validation acc: 0.489583333333
Testing acc: 0.53125
Epoch 21
20 / 28 : loss = 1.11862432957Training loss: 1.09105610847
Training acc: 0.504464285714
Validation acc: 0.541666666667
Epoch 22
20 / 28 : loss = 1.12514758116Training loss: 1.10713994503
Training acc: 0.46875
Validation acc: 0.541666666667
Epoch 23
20 / 28 : loss = 1.07463049889Training loss: 1.0526099205
Training acc: 0.5078125
Validation acc: 0.614583333333
Epoch 24
20 / 28 : loss = 1.03207302094Training loss: 1.02631187439
Training acc: 0.489955357143
Validation acc: 0.479166666667
Epoch 25
20 / 28 : loss = 0.987817108631Training loss: 0.98625844717
Training acc: 0.525669642857
Validation acc: 0.46875
Epoch 26
Training loss: 0.98426395654789
Training acc: 0.497767857143
Validation acc: 0.541666666667
Epoch 27
20 / 28 : loss = 0.998720347881Training loss: 1.0123347044
Training acc: 0.465401785714
Validation acc: 0.46875
Epoch 28
20 / 28 : loss = 0.984455466271Training loss: 0.979767024517
Training acc: 0.455357142857
Validation acc: 0.5
Epoch 29
20 / 28 : loss = 0.975319623947Training loss: 0.964618086815
Training acc: 0.5234375
Validation acc: 0.5
Epoch 30
20 / 28 : loss = 0.939795374875Training loss: 0.951580405235
Training acc: 0.496651785714
Validation acc: 0.364583333333
Epoch 31
20 / 28 : loss = 0.943750202656Training loss: 0.938681900501
Training acc: 0.508928571429
Validation acc: 0.510416666667
Epoch 32
20 / 28 : loss = 0.934486746788Training loss: 0.93409383297
Training acc: 0.4765625
Validation acc: 0.458333333333
Epoch 33
20 / 28 : loss = 0.927676260471Training loss: 0.907909929752
Training acc: 0.515625
Validation acc: 0.427083333333
Epoch 34
20 / 28 : loss = 0.912145972252Training loss: 0.947014391422
Training acc: 0.493303571429
Validation acc: 0.541666666667
Epoch 35
20 / 28 : loss = 0.886548995972Training loss: 0.891139388084
Training acc: 0.496651785714
Validation acc: 0.59375
Epoch 36
20 / 28 : loss = 0.898134768009Training loss: 0.888131916523
Training acc: 0.522321428571
Validation acc: 0.552083333333
Epoch 37
20 / 28 : loss = 0.854808509356Training loss: 0.860232770443
Training acc: 0.546875
Validation acc: 0.46875
Epoch 38
20 / 28 : loss = 0.869203269482Training loss: 0.882781028748
Training acc: 0.511160714286
Validation acc: 0.583333333333
Epoch 39
Training loss: 0.90571916103452
Training acc: 0.467633928571
Validation acc: 0.447916666667
Epoch 40
20 / 28 : loss = 0.852611899376Training loss: 0.875251173973
Training acc: 0.521205357143
Validation acc: 0.510416666667
Testing acc: 0.53125
Epoch 41
20 / 28 : loss = 0.901843190193Training loss: 0.898785114288
Training acc: 0.475446428571
Validation acc: 0.302083333333
Epoch 42
20 / 28 : loss = 0.859054207802Training loss: 0.865071833134
Training acc: 0.5234375
Validation acc: 0.5
Epoch 43
20 / 28 : loss = 0.880837917328Training loss: 0.889249801636
Training acc: 0.482142857143
Validation acc: 0.354166666667
Epoch 44
Training loss: 0.87810432910958
Training acc: 0.505580357143
Validation acc: 0.65625
Epoch 45
20 / 28 : loss = 0.831193447113Training loss: 0.871517181396
Training acc: 0.5
Validation acc: 0.46875
Epoch 46
20 / 28 : loss = 0.851152062416Training loss: 0.844741046429
Training acc: 0.534598214286
Validation acc: 0.53125
Epoch 47
20 / 28 : loss = 0.851759076118Training loss: 0.849397242069
Training acc: 0.497767857143
Validation acc: 0.53125
Epoch 48
20 / 28 : loss = 0.863907873631Training loss: 0.860651671886
Training acc: 0.483258928571
Validation acc: 0.479166666667
Epoch 49
Training loss: 0.83396726846751
Training acc: 0.506696428571
Validation acc: 0.5625
Epoch 50
20 / 28 : loss = 0.834392011166Training loss: 0.84835678339
Training acc: 0.512276785714
Validation acc: 0.510416666667
Epoch 51
20 / 28 : loss = 0.839559257037Training loss: 0.851681828499
Training acc: 0.508928571429
Validation acc: 0.4375
Epoch 52
20 / 28 : loss = 0.829302728176Training loss: 0.830850303173
Training acc: 0.485491071429
Validation acc: 0.416666666667
Epoch 53
20 / 28 : loss = 0.838289618492Training loss: 0.830492317677
Training acc: 0.508928571429
Validation acc: 0.489583333333
Epoch 54
Training loss: 0.81747496128151
Training acc: 0.518973214286
Validation acc: 0.479166666667
Epoch 55
20 / 28 : loss = 0.877240777016Training loss: 0.859400868416
Training acc: 0.491071428571
Validation acc: 0.489583333333
Epoch 56
20 / 28 : loss = 0.820149123669Training loss: 0.823827445507
Training acc: 0.485491071429
Validation acc: 0.5
Epoch 57
20 / 28 : loss = 0.793808341026Training loss: 0.789579391479
Training acc: 0.5546875
Validation acc: 0.489583333333
Epoch 58
20 / 28 : loss = 0.816714406013Training loss: 0.811410903931
Training acc: 0.496651785714
Validation acc: 0.447916666667
Epoch 59
20 / 28 : loss = 0.804911851883Training loss: 0.807368755341
Training acc: 0.505580357143
Validation acc: 0.53125
Epoch 60
20 / 28 : loss = 0.820546925068Training loss: 0.818905770779
Training acc: 0.502232142857
Validation acc: 0.427083333333
Testing acc: 0.53125
Epoch 61
20 / 28 : loss = 0.789007306099Training loss: 0.793304502964
Training acc: 0.543526785714
Validation acc: 0.5625
Epoch 62
20 / 28 : loss = 0.800351798534Training loss: 0.794633924961
Training acc: 0.530133928571
Validation acc: 0.541666666667
Epoch 63
20 / 28 : loss = 0.802903115749Training loss: 0.803166925907
Training acc: 0.504464285714
Validation acc: 0.46875
Epoch 64
20 / 28 : loss = 0.797379255295Training loss: 0.798274576664
Training acc: 0.520089285714
Validation acc: 0.5
Epoch 65
20 / 28 : loss = 0.781889081001Training loss: 0.784640014172
Training acc: 0.53125
Validation acc: 0.427083333333
Epoch 66
20 / 28 : loss = 0.806182980537Training loss: 0.801345229149
Training acc: 0.504464285714
Validation acc: 0.583333333333
Epoch 67
20 / 28 : loss = 0.802764892578Training loss: 0.805084824562
Training acc: 0.5078125
Validation acc: 0.708333333333
Epoch 68
Training loss: 0.78941202163781
Training acc: 0.4921875
Validation acc: 0.53125
Epoch 69
20 / 28 : loss = 0.785666048527Training loss: 0.798090398312
Training acc: 0.521205357143
Validation acc: 0.625
Epoch 70
20 / 28 : loss = 0.790391027927Training loss: 0.791046440601
Training acc: 0.526785714286
Validation acc: 0.489583333333
Epoch 71
Training loss: 0.78764218092036
Training acc: 0.508928571429
Validation acc: 0.5
Epoch 72
20 / 28 : loss = 0.781237840652Training loss: 0.787070691586
Training acc: 0.457589285714
Validation acc: 0.40625
Epoch 73
20 / 28 : loss = 0.765129089355Training loss: 0.780478179455
Training acc: 0.518973214286
Validation acc: 0.5
Epoch 74
Training loss: 0.77464216947625
Training acc: 0.516741071429
Validation acc: 0.552083333333
Epoch 75
Training loss: 0.77603399753626
Training acc: 0.516741071429
Validation acc: 0.46875
Epoch 76
20 / 28 : loss = 0.779357790947Training loss: 0.778448283672
Training acc: 0.497767857143
Validation acc: 0.5
Epoch 77
20 / 28 : loss = 0.772642135624Training loss: 0.777882874012
Training acc: 0.520089285714
Validation acc: 0.59375
Epoch 78
20 / 28 : loss = 0.771243035793Training loss: 0.777165412903
Training acc: 0.506696428571
Validation acc: 0.427083333333
Epoch 79
20 / 28 : loss = 0.760389089584Training loss: 0.765785992146
Training acc: 0.5390625
Validation acc: 0.489583333333
Epoch 80
20 / 28 : loss = 0.762929737568Training loss: 0.769277393818
Training acc: 0.520089285714
Validation acc: 0.5
Testing acc: 0.46875
Epoch 81
20 / 28 : loss = 0.767179608345Training loss: 0.76599162817
Training acc: 0.498883928571
Validation acc: 0.46875
Epoch 82
20 / 28 : loss = 0.771728873253Training loss: 0.772716879845
Training acc: 0.491071428571
Validation acc: 0.5625
Epoch 83
20 / 28 : loss = 0.771622717381Training loss: 0.761045634747
Training acc: 0.5390625
Validation acc: 0.447916666667
Epoch 84
20 / 28 : loss = 0.778344213963Training loss: 0.777696669102
Training acc: 0.464285714286
Validation acc: 0.572916666667
Epoch 85
Training loss: 0.76930153369993
Training acc: 0.5078125
Validation acc: 0.510416666667
Epoch 86
20 / 28 : loss = 0.755119442941Training loss: 0.761256873608
Training acc: 0.517857142857
Validation acc: 0.416666666667
Epoch 87
20 / 28 : loss = 0.756416082382Training loss: 0.764079928398
Training acc: 0.530133928571
Validation acc: 0.4375
Epoch 88
Training loss: 0.76823371648846
Training acc: 0.515625
Validation acc: 0.5
Epoch 89
20 / 28 : loss = 0.760077357292Training loss: 0.761929035187
Training acc: 0.527901785714
Validation acc: 0.572916666667
Epoch 90
Training loss: 0.75978797674206
Training acc: 0.501116071429
Validation acc: 0.635416666667
Epoch 91
Training loss: 0.75462102898886
Training acc: 0.542410714286
Validation acc: 0.583333333333
Epoch 92
Training loss: 0.76291751861682
Training acc: 0.511160714286
Validation acc: 0.489583333333
Epoch 93
20 / 28 : loss = 0.766530871391Training loss: 0.769470572472
Training acc: 0.502232142857
Validation acc: 0.552083333333
Epoch 94
Training loss: 0.76270848512673
Training acc: 0.520089285714
Validation acc: 0.583333333333
Epoch 95
20 / 28 : loss = 0.755658030515Training loss: 0.755768597126
Training acc: 0.511160714286
Validation acc: 0.552083333333
Epoch 96
20 / 28 : loss = 0.750647366047Training loss: 0.747526586056
Training acc: 0.533482142857
Validation acc: 0.552083333333
Epoch 97
20 / 28 : loss = 0.748862087727Training loss: 0.753170669079
Training acc: 0.522321428571
Validation acc: 0.447916666667
Epoch 98
20 / 28 : loss = 0.761088252068Training loss: 0.757480621338
Training acc: 0.502232142857
Validation acc: 0.583333333333
Epoch 99
20 / 28 : loss = 0.752952992916Training loss: 0.749846816063
Training acc: 0.542410714286
Validation acc: 0.541666666667

**************************************

qa19_path-finding
vocab = [u'.', u'?', u'How', u'The', u'bathroom', u'bedroom', u'do', u'e,e', u'e,n', u'e,s', u'east', u'from', u'garden', u'go', u'hallway', u'is', u'kitchen', u'n,e', u'n,n', u'n,w', u'north', u'of', u'office', u's,e', u's,s', u's,w', u'south', u'the', u'to', u'w,n', u'w,s', u'w,w', u'west', u'you']
word_idx = {u'w,s': 31, u'office': 23, u'hallway': 15, u'is': 16, u'How': 3, u'w,w': 32, u'bedroom': 6, u'go': 14, u's,s': 25, u'bathroom': 5, u'from': 12, u'west': 33, u's,w': 26, u'.': 1, u'to': 29, u'w,n': 30, u's,e': 24, u'you': 34, u'east': 11, u'?': 2, u'do': 7, u'north': 21, u'garden': 13, u'n,w': 20, u'kitchen': 17, u'n,e': 18, u'The': 4, u'n,n': 19, u'e,n': 9, u'of': 22, u'e,e': 8, u'e,s': 10, u'the': 28, u'south': 27}
X.shape = (1000, 5, 8)
Xq.shape = (1000, 11)
Y.shape = (1000, 35)
story_maxlen, sentence_maxlen, query_maxlen = 5, 8, 11
max_epochs = 100
Epoch 0
20 / 28 : loss = 6.28092813492Training loss: 5.6285033226
Training acc: 0.0892857142857
Validation acc: 0.0729166666667
Testing acc: 0.0917338709677
Epoch 1
Training loss: 3.6319539547483
Training acc: 0.0714285714286
Validation acc: 0.0729166666667
Epoch 2
Training loss: 3.5211703777372
Training acc: 0.0915178571429
Validation acc: 0.0416666666667
Epoch 3
20 / 28 : loss = 3.42653656006Training loss: 3.42110824585
Training acc: 0.0904017857143
Validation acc: 0.0416666666667
Epoch 4
Training loss: 3.3644497394655
Training acc: 0.0647321428571
Validation acc: 0.0729166666667
Epoch 5
Training loss: 3.2710251808213
Training acc: 0.0837053571429
Validation acc: 0.0833333333333
Epoch 6
20 / 28 : loss = 3.21949481964Training loss: 3.21091198921
Training acc: 0.0814732142857
Validation acc: 0.0833333333333
Epoch 7
Training loss: 3.1463253498122
Training acc: 0.0982142857143
Validation acc: 0.09375
Epoch 8
Training loss: 3.1036236286229
Training acc: 0.0814732142857
Validation acc: 0.0208333333333
Epoch 9
20 / 28 : loss = 3.04788064957Training loss: 3.0472946167
Training acc: 0.0904017857143
Validation acc: 0.0833333333333
Epoch 10
Training loss: 3.0082080364277
Training acc: 0.0970982142857
Validation acc: 0.0833333333333
Epoch 11
Training loss: 2.9798476696213
Training acc: 0.078125
Validation acc: 0.0729166666667
Epoch 12
Training loss: 2.9457983970615
Training acc: 0.0691964285714
Validation acc: 0.135416666667
Epoch 13
20 / 28 : loss = 2.91775608063Training loss: 2.91227650642
Training acc: 0.0725446428571
Validation acc: 0.0833333333333
Epoch 14
20 / 28 : loss = 2.87941026688Training loss: 2.87726354599
Training acc: 0.0770089285714
Validation acc: 0.104166666667
Epoch 15
20 / 28 : loss = 2.86128091812Training loss: 2.85476994514
Training acc: 0.0848214285714
Validation acc: 0.145833333333
Epoch 16
20 / 28 : loss = 2.82259345055Training loss: 2.82774186134
Training acc: 0.09375
Validation acc: 0.0416666666667
Epoch 17
20 / 28 : loss = 2.81619524956Training loss: 2.81190824509
Training acc: 0.0747767857143
Validation acc: 0.114583333333
Epoch 18
Training loss: 2.7851405143786
Training acc: 0.102678571429
Validation acc: 0.0520833333333
Epoch 19
20 / 28 : loss = 2.77111077309Training loss: 2.7718398571
Training acc: 0.0736607142857
Validation acc: 0.0520833333333
Epoch 20
20 / 28 : loss = 2.75859212875Training loss: 2.75774765015
Training acc: 0.0714285714286
Validation acc: 0.114583333333
Testing acc: 0.0887096774194
Epoch 21
Training loss: 2.7431426048358
Training acc: 0.0948660714286
Validation acc: 0.0520833333333
Epoch 22
Training loss: 2.7310862541243
Training acc: 0.0680803571429
Validation acc: 0.0520833333333
Epoch 23
20 / 28 : loss = 2.70690870285Training loss: 2.70993995667
Training acc: 0.09375
Validation acc: 0.0729166666667
Epoch 24
20 / 28 : loss = 2.71128010757Training loss: 2.70865893364
Training acc: 0.0770089285714
Validation acc: 0.03125
Epoch 25
Training loss: 2.6973946094501
Training acc: 0.0613839285714
Validation acc: 0.0520833333333
Epoch 26
20 / 28 : loss = 2.68228793144Training loss: 2.68113303185
Training acc: 0.0892857142857
Validation acc: 0.0520833333333
Epoch 27
Training loss: 2.6701552867978
Training acc: 0.0758928571429
Validation acc: 0.114583333333
Epoch 28
Training loss: 2.6667487621399
Training acc: 0.0803571428571
Validation acc: 0.0416666666667
Epoch 29
20 / 28 : loss = 2.66290020943Training loss: 2.65992379189
Training acc: 0.0803571428571
Validation acc: 0.114583333333
Epoch 30
20 / 28 : loss = 2.65582704544Training loss: 2.65554618835
Training acc: 0.0770089285714
Validation acc: 0.0729166666667
Epoch 31
20 / 28 : loss = 2.64275622368Training loss: 2.64258122444
Training acc: 0.0680803571429
Validation acc: 0.104166666667
Epoch 32
20 / 28 : loss = 2.63153314599Training loss: 2.6334631443
Training acc: 0.09375
Validation acc: 0.114583333333
Epoch 33
Training loss: 2.6323471069304
Training acc: 0.0837053571429
Validation acc: 0.0416666666667
Epoch 34
20 / 28 : loss = 2.62058377266Training loss: 2.62539935112
Training acc: 0.0747767857143
Validation acc: 0.0833333333333
Epoch 35
20 / 28 : loss = 2.61827349663Training loss: 2.6204419136
Training acc: 0.0870535714286
Validation acc: 0.0625
Epoch 36
Training loss: 2.6146686077122
Training acc: 0.0904017857143
Validation acc: 0.0625
Epoch 37
20 / 28 : loss = 2.61915326118Training loss: 2.61585283279
Training acc: 0.0714285714286
Validation acc: 0.0625
Epoch 38
20 / 28 : loss = 2.60416531563Training loss: 2.60675001144
Training acc: 0.0770089285714
Validation acc: 0.03125
Epoch 39
Training loss: 2.6077494621337
Training acc: 0.0747767857143
Validation acc: 0.0520833333333
Epoch 40
20 / 28 : loss = 2.59397888184Training loss: 2.59097719193
Training acc: 0.0859375
Validation acc: 0.114583333333
Testing acc: 0.0836693548387
Epoch 41
Training loss: 2.5951886177178
Training acc: 0.0881696428571
Validation acc: 0.114583333333
Epoch 42
Training loss: 2.5864660739935
Training acc: 0.0881696428571
Validation acc: 0.09375
Epoch 43
Training loss: 2.5943038463652
Training acc: 0.0658482142857
Validation acc: 0.0729166666667
Epoch 44
Training loss: 2.5914757251724
Training acc: 0.0658482142857
Validation acc: 0.0729166666667
Epoch 45
20 / 28 : loss = 2.58781170845Training loss: 2.58763885498
Training acc: 0.0691964285714
Validation acc: 0.0833333333333
Epoch 46
Training loss: 2.5794234275851
Training acc: 0.0803571428571
Validation acc: 0.03125
Epoch 47
20 / 28 : loss = 2.58129000664Training loss: 2.58211517334
Training acc: 0.0859375
Validation acc: 0.0625
Epoch 48
Training loss: 2.5746302604798
Training acc: 0.0747767857143
Validation acc: 0.0520833333333
Epoch 49
Training loss: 2.5713732242666
Training acc: 0.0959821428571
Validation acc: 0.0520833333333
Epoch 50
20 / 28 : loss = 2.56994581223Training loss: 2.57127428055
Training acc: 0.078125
Validation acc: 0.0729166666667
Epoch 51
Training loss: 2.5707638263743
Training acc: 0.0792410714286
Validation acc: 0.166666666667
Epoch 52
20 / 28 : loss = 2.56253814697Training loss: 2.56480336189
Training acc: 0.100446428571
Validation acc: 0.0729166666667
Epoch 53
20 / 28 : loss = 2.55317687988Training loss: 2.55663609505
Training acc: 0.0825892857143
Validation acc: 0.104166666667
Epoch 54
20 / 28 : loss = 2.56101107597Training loss: 2.55827879906
Training acc: 0.0948660714286
Validation acc: 0.09375
Epoch 55
Training loss: 2.5575537681681
Training acc: 0.0825892857143
Validation acc: 0.104166666667
Epoch 56
20 / 28 : loss = 2.54960536957Training loss: 2.55162835121
Training acc: 0.106026785714
Validation acc: 0.15625
Epoch 57
Training loss: 2.5535292625419
Training acc: 0.109375
Validation acc: 0.0833333333333
Epoch 58
Training loss: 2.5528187751886
Training acc: 0.0892857142857
Validation acc: 0.0729166666667
Epoch 59
20 / 28 : loss = 2.54881739616Training loss: 2.54631376266
Training acc: 0.100446428571
Validation acc: 0.0833333333333
Epoch 60
Training loss: 2.5545687675558
Training acc: 0.0859375
Validation acc: 0.114583333333
Testing acc: 0.100806451613
Epoch 61
Training loss: 2.5367820262939
Training acc: 0.0848214285714
Validation acc: 0.09375
Epoch 62
20 / 28 : loss = 2.54968142509Training loss: 2.54758787155
Training acc: 0.0948660714286
Validation acc: 0.104166666667
Epoch 63
20 / 28 : loss = 2.54896092415Training loss: 2.55015587807
Training acc: 0.110491071429
Validation acc: 0.104166666667
Epoch 64
20 / 28 : loss = 2.53529977798Training loss: 2.53791022301
Training acc: 0.103794642857
Validation acc: 0.0729166666667
Epoch 65
20 / 28 : loss = 2.54094195366Training loss: 2.53592300415
Training acc: 0.0982142857143
Validation acc: 0.0625
Epoch 66
Training loss: 2.5445530414686
Training acc: 0.0926339285714
Validation acc: 0.145833333333
Epoch 67
20 / 28 : loss = 2.53564524651Training loss: 2.53606200218
Training acc: 0.103794642857
Validation acc: 0.0625
Epoch 68
Training loss: 2.5394265651737
Training acc: 0.0904017857143
Validation acc: 0.104166666667
Epoch 69
Training loss: 2.5341274738365
Training acc: 0.107142857143
Validation acc: 0.09375
Epoch 70
20 / 28 : loss = 2.54249691963Training loss: 2.53548669815
Training acc: 0.0926339285714
Validation acc: 0.0520833333333
Epoch 71
Training loss: 2.5373213291222
Training acc: 0.106026785714
Validation acc: 0.104166666667
Epoch 72
20 / 28 : loss = 2.51888704339Training loss: 2.5284268856
Training acc: 0.100446428571
Validation acc: 0.0833333333333
Epoch 73
Training loss: 2.5294680595429
Training acc: 0.107142857143
Validation acc: 0.09375
Epoch 74
20 / 28 : loss = 2.52071189883Training loss: 2.52125239372
Training acc: 0.111607142857
Validation acc: 0.114583333333
Epoch 75
20 / 28 : loss = 2.52847480774Training loss: 2.53092193604
Training acc: 0.108258928571
Validation acc: 0.0416666666667
Epoch 76
20 / 28 : loss = 2.51217007637Training loss: 2.52521085739
Training acc: 0.104910714286
Validation acc: 0.104166666667
Epoch 77
Training loss: 2.5249016284955
Training acc: 0.0948660714286
Validation acc: 0.145833333333
Epoch 78
20 / 28 : loss = 2.51834297184Training loss: 2.52110433578
Training acc: 0.114955357143
Validation acc: 0.09375
Epoch 79
Training loss: 2.5163531303447
Training acc: 0.110491071429
Validation acc: 0.0729166666667
Epoch 80
Training loss: 2.5237653255502
Training acc: 0.0970982142857
Validation acc: 0.0833333333333
Testing acc: 0.109879032258
Epoch 81
Training loss: 2.5219478607242
Training acc: 0.107142857143
Validation acc: 0.15625
Epoch 82
20 / 28 : loss = 2.51326370239Training loss: 2.50945520401
Training acc: 0.123883928571
Validation acc: 0.0625
Epoch 83
Training loss: 2.5222742557577
Training acc: 0.122767857143
Validation acc: 0.104166666667
Epoch 84
20 / 28 : loss = 2.51353335381Training loss: 2.51568174362
Training acc: 0.112723214286
Validation acc: 0.104166666667
Epoch 85
Training loss: 2.5259177684847
Training acc: 0.100446428571
Validation acc: 0.135416666667
Epoch 86
20 / 28 : loss = 2.50528931618Training loss: 2.5094192028
Training acc: 0.107142857143
Validation acc: 0.114583333333
Epoch 87
Training loss: 2.5091366767918
Training acc: 0.118303571429
Validation acc: 0.104166666667
Epoch 88
Training loss: 2.5043699741441
Training acc: 0.109375
Validation acc: 0.104166666667
Epoch 89
20 / 28 : loss = 2.52059149742Training loss: 2.51112055779
Training acc: 0.122767857143
Validation acc: 0.0625
Epoch 90
Training loss: 2.5076174736912
Training acc: 0.1171875
Validation acc: 0.104166666667
Epoch 91
Training loss: 2.5077049732282
Training acc: 0.103794642857
Validation acc: 0.145833333333
Epoch 92
Training loss: 2.5132732391489
Training acc: 0.121651785714
Validation acc: 0.15625
Epoch 93
20 / 28 : loss = 2.51044511795Training loss: 2.5118637085
Training acc: 0.104910714286
Validation acc: 0.1875
Epoch 94
Training loss: 2.5035321712503
Training acc: 0.113839285714
Validation acc: 0.125
Epoch 95
20 / 28 : loss = 2.50422477722Training loss: 2.50762963295
Training acc: 0.108258928571
Validation acc: 0.0833333333333
Epoch 96
20 / 28 : loss = 2.50658226013Training loss: 2.5044836998
Training acc: 0.128348214286
Validation acc: 0.125
Epoch 97
20 / 28 : loss = 2.50412321091Training loss: 2.50509142876
Training acc: 0.103794642857
Validation acc: 0.125
Epoch 98
Training loss: 2.4961984157665
Training acc: 0.116071428571
Validation acc: 0.0625
Epoch 99
Training loss: 2.5131685733859
Training acc: 0.108258928571
Validation acc: 0.125

**************************************

qa20_agents-motivations
vocab = [u'.', u'?', u'Antoine', u'Jason', u'Sumit', u'Where', u'Why', u'Yann', u'antoine', u'apple', u'back', u'bedroom', u'bored', u'did', u'football', u'garden', u'get', u'go', u'got', u'grabbed', u'hungry', u'is', u'jason', u'journeyed', u'kitchen', u'milk', u'moved', u'pajamas', u'picked', u'sumit', u'the', u'there', u'thirsty', u'tired', u'to', u'took', u'travelled', u'up', u'went', u'will', u'yann']
word_idx = {u'jason': 23, u'apple': 10, u'thirsty': 33, u'sumit': 30, u'is': 22, u'moved': 27, u'back': 11, u'Antoine': 3, u'picked': 29, u'bedroom': 12, u'go': 18, u'.': 1, u'pajamas': 28, u'milk': 26, u'grabbed': 20, u'there': 32, u'tired': 34, u'antoine': 9, u'to': 35, u'got': 19, u'travelled': 37, u'bored': 13, u'Why': 7, u'?': 2, u'garden': 16, u'get': 17, u'football': 15, u'took': 36, u'Yann': 8, u'Where': 6, u'went': 39, u'kitchen': 25, u'Jason': 4, u'journeyed': 24, u'Sumit': 5, u'did': 14, u'up': 38, u'hungry': 21, u'will': 40, u'yann': 41, u'the': 31}
X.shape = (1000, 12, 7)
Xq.shape = (1000, 8)
Y.shape = (1000, 42)
story_maxlen, sentence_maxlen, query_maxlen = 12, 7, 8
max_epochs = 100
Epoch 0
Training loss: 5.0983467102155
Training acc: 0.219866071429
Validation acc: 0.354166666667
Testing acc: 0.3125
Epoch 1
20 / 28 : loss = 2.44291281749Training loss: 2.36109495163
Training acc: 0.400669642857
Validation acc: 0.447916666667
Epoch 2
20 / 28 : loss = 1.95947408676Training loss: 1.93515741825
Training acc: 0.522321428571
Validation acc: 0.604166666667
Epoch 3
20 / 28 : loss = 1.53171980381Training loss: 1.49337589741
Training acc: 0.6640625
Validation acc: 0.822916666667
Epoch 4
20 / 28 : loss = 1.25085461144Training loss: 1.22206759453
Training acc: 0.763392857143
Validation acc: 0.760416666667
Epoch 5
20 / 28 : loss = 1.05630207062Training loss: 1.03512871265
Training acc: 0.821428571429
Validation acc: 0.791666666667
Epoch 6
Training loss: 0.90671145916746
Training acc: 0.868303571429
Validation acc: 0.875
Epoch 7
Training loss: 0.78724938631126
Training acc: 0.895089285714
Validation acc: 0.947916666667
Epoch 8
20 / 28 : loss = 0.714245855808Training loss: 0.70808249712
Training acc: 0.9140625
Validation acc: 0.854166666667
Epoch 9
Training loss: 0.67370033264249
Training acc: 0.902901785714
Validation acc: 0.90625
Epoch 10
20 / 28 : loss = 0.641435742378Training loss: 0.637029349804
Training acc: 0.90625
Validation acc: 0.947916666667
Epoch 11
Training loss: 0.60149055719428
Training acc: 0.904017857143
Validation acc: 0.90625
Epoch 12
Training loss: 0.56637519598104
Training acc: 0.8984375
Validation acc: 0.916666666667
Epoch 13
Training loss: 0.54087668657328
Training acc: 0.908482142857
Validation acc: 0.864583333333
Epoch 14
Training loss: 0.50991100072902
Training acc: 0.912946428571
Validation acc: 0.927083333333
Epoch 15
Training loss: 0.49434468150139
Training acc: 0.905133928571
Validation acc: 0.895833333333
Epoch 16
Training loss: 0.48125389218319
Training acc: 0.907366071429
Validation acc: 0.958333333333
Epoch 17
20 / 28 : loss = 0.454693943262Training loss: 0.453520834446
Training acc: 0.9140625
Validation acc: 0.885416666667
Epoch 18
Training loss: 1.38426113129877
Training acc: 0.765625
Validation acc: 0.572916666667
Epoch 19
Training loss: 0.75845807790878
Training acc: 0.834821428571
Validation acc: 0.916666666667
Epoch 20
20 / 28 : loss = 0.523869216442Training loss: 0.519329726696
Training acc: 0.910714285714
Validation acc: 0.885416666667
Testing acc: 0.909274193548
Epoch 21
20 / 28 : loss = 0.476094514132Training loss: 0.47922334075
Training acc: 0.924107142857
Validation acc: 0.895833333333
Epoch 22
20 / 28 : loss = 0.458720266819Training loss: 0.452984631062
Training acc: 0.928571428571
Validation acc: 0.96875
Epoch 23
Training loss: 0.42479529976857
Training acc: 0.949776785714
Validation acc: 0.947916666667
Epoch 24
Training loss: 0.39435181021717
Training acc: 0.955357142857
Validation acc: 0.958333333333
Epoch 25
20 / 28 : loss = 0.394926488499Training loss: 0.389221936464
Training acc: 0.9453125
Validation acc: 0.96875
Epoch 26
Training loss: 0.34886071085911
Training acc: 0.967633928571
Validation acc: 0.947916666667
Epoch 27
Training loss: 0.34167319536222
Training acc: 0.966517857143
Validation acc: 0.958333333333
Epoch 28
20 / 28 : loss = 0.325109153986Training loss: 0.317906677723
Training acc: 0.96875
Validation acc: 0.958333333333
Epoch 29
20 / 28 : loss = 0.362296044827Training loss: 0.346742242575
Training acc: 0.957589285714
Validation acc: 0.989583333333
Epoch 30
Training loss: 0.30458524823219
Training acc: 0.96875
Validation acc: 0.989583333333
Epoch 31
20 / 28 : loss = 0.294679433107Training loss: 0.289510905743
Training acc: 0.96875
Validation acc: 0.96875
Epoch 32
Training loss: 0.28579658269983
Training acc: 0.967633928571
Validation acc: 0.989583333333
Epoch 33
Training loss: 0.28709658980426
Training acc: 0.966517857143
Validation acc: 0.979166666667
Epoch 34
Training loss: 0.96248710155553
Training acc: 0.842633928571
Validation acc: 0.979166666667
Epoch 35
Training loss: 0.36562541127253
Training acc: 0.969866071429
Validation acc: 0.96875
Epoch 36
Training loss: 0.33007830381498
Training acc: 0.967633928571
Validation acc: 1.0
Epoch 37
Training loss: 0.31539192795854
Training acc: 0.967633928571
Validation acc: 0.979166666667
Epoch 38
Training loss: 0.29225468635653
Training acc: 0.96875
Validation acc: 0.958333333333
Epoch 39
Training loss: 0.28061875701475
Training acc: 0.977678571429
Validation acc: 0.96875
Epoch 40
Training loss: 0.28141388297184
Training acc: 0.965401785714
Validation acc: 1.0
Testing acc: 0.979838709677
Epoch 41
Training loss: 0.26733127236486
Training acc: 0.969866071429
Validation acc: 0.979166666667
Epoch 42
Training loss: 0.26160770654758
Training acc: 0.970982142857
Validation acc: 0.96875
Epoch 43
Training loss: 0.24403730034848
Training acc: 0.973214285714
Validation acc: 0.947916666667
Epoch 44
Training loss: 0.23431232571633
Training acc: 0.974330357143
Validation acc: 0.979166666667
Epoch 45
Training loss: 0.26765239238793
Training acc: 0.964285714286
Validation acc: 0.989583333333
Epoch 46
Training loss: 0.23150359094162
Training acc: 0.970982142857
Validation acc: 1.0
Epoch 47
Training loss: 0.22033229470357
Training acc: 0.975446428571
Validation acc: 0.96875
Epoch 48
Training loss: 0.21362602710746
Training acc: 0.979910714286
Validation acc: 0.96875
Epoch 49
Training loss: 0.2273800075052
Training acc: 0.96875
Validation acc: 0.979166666667
Epoch 50
Training loss: 0.21532985568108
Training acc: 0.974330357143
Validation acc: 0.979166666667
Epoch 51
Training loss: 0.79162293672604
Training acc: 0.839285714286
Validation acc: 0.645833333333
Epoch 52
20 / 28 : loss = 0.501257598423Training loss: 0.468544751406
Training acc: 0.896205357143
Validation acc: 0.979166666667
Epoch 53
20 / 28 : loss = 0.334660112858Training loss: 0.328129380941
Training acc: 0.949776785714
Validation acc: 0.989583333333
Epoch 54
20 / 28 : loss = 0.292855411768Training loss: 0.288025081158
Training acc: 0.96875
Validation acc: 0.96875
Epoch 55
20 / 28 : loss = 0.255200862885Training loss: 0.252549231052
Training acc: 0.977678571429
Validation acc: 0.958333333333
Epoch 56
Training loss: 0.25566953420612
Training acc: 0.96875
Validation acc: 0.96875
Epoch 57
20 / 28 : loss = 0.246705874801Training loss: 0.241704806685
Training acc: 0.973214285714
Validation acc: 0.958333333333
Epoch 58
20 / 28 : loss = 0.254046976566Training loss: 0.241870328784
Training acc: 0.974330357143
Validation acc: 0.96875
Epoch 59
20 / 28 : loss = 0.217635676265Training loss: 0.219327017665
Training acc: 0.977678571429
Validation acc: 0.989583333333
Epoch 60
Training loss: 0.22625364363298
Training acc: 0.973214285714
Validation acc: 0.979166666667
Testing acc: 0.982862903226
Epoch 61
Training loss: 0.21678055822871
Training acc: 0.972098214286
Validation acc: 1.0
Epoch 62
Training loss: 0.20831425488011
Training acc: 0.979910714286
Validation acc: 0.979166666667
Epoch 63
Training loss: 0.20944809913619
Training acc: 0.975446428571
Validation acc: 0.989583333333
Epoch 64
Training loss: 0.19717155396914
Training acc: 0.978794642857
Validation acc: 0.979166666667
Epoch 65
Training loss: 0.19433020055363
Training acc: 0.974330357143
Validation acc: 0.979166666667
Epoch 66
Training loss: 0.19419607520155
Training acc: 0.977678571429
Validation acc: 0.989583333333
Epoch 67
Training loss: 0.19197177887357
Training acc: 0.975446428571
Validation acc: 0.989583333333
Epoch 68
Training loss: 0.19760651886576
Training acc: 0.969866071429
Validation acc: 0.979166666667
Epoch 69
Training loss: 0.18906649947229
Training acc: 0.974330357143
Validation acc: 0.958333333333
Epoch 70
Training loss: 0.19719889766945
Training acc: 0.972098214286
Validation acc: 1.0
Epoch 71
20 / 28 : loss = 0.183285966516Training loss: 0.185718625784
Training acc: 0.975446428571
Validation acc: 0.989583333333
Epoch 72
20 / 28 : loss = 0.191174894571Training loss: 0.189625397325
Training acc: 0.981026785714
Validation acc: 0.989583333333
Epoch 73
Training loss: 0.18362650275274
Training acc: 0.979910714286
Validation acc: 1.0
Epoch 74
Training loss: 0.17752720415661
Training acc: 0.978794642857
Validation acc: 1.0
Epoch 75
Training loss: 0.16761706769526
Training acc: 0.984375
Validation acc: 0.96875
Epoch 76
Training loss: 0.17450383305543
Training acc: 0.977678571429
Validation acc: 0.96875
Epoch 77
Training loss: 0.17264275252898
Training acc: 0.977678571429
Validation acc: 0.989583333333
Epoch 78
Training loss: 0.17216812074292
Training acc: 0.981026785714
Validation acc: 0.989583333333
Epoch 79
20 / 28 : loss = 0.191421896219Training loss: 0.19369764626
Training acc: 0.970982142857
Validation acc: 0.989583333333
Epoch 80
20 / 28 : loss = 0.182622298598Training loss: 0.199965626001
Training acc: 0.977678571429
Validation acc: 0.96875
Testing acc: 0.975806451613
Epoch 81
20 / 28 : loss = 0.175941258669Training loss: 0.176023736596
Training acc: 0.982142857143
Validation acc: 1.0
Epoch 82
Training loss: 0.19433279335599
Training acc: 0.96875
Validation acc: 0.989583333333
Epoch 83
20 / 28 : loss = 0.174517810345Training loss: 0.171737670898
Training acc: 0.979910714286
Validation acc: 0.979166666667
Epoch 84
Training loss: 0.16636662185286
Training acc: 0.982142857143
Validation acc: 0.96875
Epoch 85
20 / 28 : loss = 0.164132654667Training loss: 0.165912970901
Training acc: 0.984375
Validation acc: 0.989583333333
Epoch 86
20 / 28 : loss = 0.162714600563Training loss: 0.181720361114
Training acc: 0.973214285714
Validation acc: 0.958333333333
Epoch 87
20 / 28 : loss = 0.162655860186Training loss: 0.163394227624
Training acc: 0.982142857143
Validation acc: 0.989583333333
Epoch 88
Training loss: 0.15611429512502
Training acc: 0.984375
Validation acc: 0.989583333333
Epoch 89
20 / 28 : loss = 0.157966300845Training loss: 0.161904230714
Training acc: 0.979910714286
Validation acc: 0.989583333333
Epoch 90
Training loss: 0.16010044515183
Training acc: 0.986607142857
Validation acc: 0.979166666667
Epoch 91
Training loss: 0.15284332633494
Training acc: 0.984375
Validation acc: 0.96875
Epoch 92
Training loss: 0.19086691737226
Training acc: 0.96875
Validation acc: 0.96875
Epoch 93
Training loss: 0.15818305313685
Training acc: 0.983258928571
Validation acc: 0.979166666667
Epoch 94
Training loss: 0.16238474845938
Training acc: 0.979910714286
Validation acc: 0.979166666667
Epoch 95
Training loss: 0.18773134052869
Training acc: 0.96875
Validation acc: 1.0
Epoch 96
Training loss: 0.15831007063425
Training acc: 0.982142857143
Validation acc: 1.0
Epoch 97
Training loss: 0.14407803118202
Training acc: 0.986607142857
Validation acc: 0.927083333333
Epoch 98
Training loss: 0.17180517315959
Training acc: 0.9765625
Validation acc: 0.989583333333
Epoch 99
Training loss: 0.15445478260505
Training acc: 0.979910714286
Validation acc: 0.989583333333
